(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["leaflet.map"],{"1f54":function(e,t,a){"use strict";var n=a("5f68"),r=a("e11e"),i={iconUrl:Object(n["a"])('<path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/><path d="M0 0h24v24H0z" fill="none"/>'),iconSize:[20,32],iconAnchor:[10,24],shadowUrl:Object(n["a"])("")};r["Icon"].Default.prototype.options=i,r["Marker"].prototype.options.icon=new r["Icon"](i)},"4ec9":function(e,t,a){"use strict";var n=a("6d61"),r=a("6566");e.exports=n("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},"5d41":function(e,t,a){var n=a("23e7"),r=a("861d"),i=a("825a"),o=a("c60d"),s=a("06cf"),u=a("e163");function c(e,t){var a,n,l=arguments.length<3?e:arguments[2];return i(e)===l?e[t]:(a=s.f(e,t),a?o(a)?a.value:void 0===a.get?void 0:a.get.call(l):r(n=u(e))?c(n,t,l):void 0)}n({target:"Reflect",stat:!0},{get:c})},6566:function(e,t,a){"use strict";var n=a("9bf2").f,r=a("7c73"),i=a("e2cc"),o=a("0366"),s=a("19aa"),u=a("2266"),c=a("7dd0"),l=a("2626"),d=a("83ab"),f=a("f183").fastKey,h=a("69f3"),p=h.set,v=h.getterFor;e.exports={getConstructor:function(e,t,a,c){var l=e((function(e,n){s(e,l,t),p(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),d||(e.size=0),void 0!=n&&u(n,e[c],{that:e,AS_ENTRIES:a})})),h=v(t),g=function(e,t,a){var n,r,i=h(e),o=y(e,t);return o?o.value=a:(i.last=o={index:r=f(t,!0),key:t,value:a,previous:n=i.last,next:void 0,removed:!1},i.first||(i.first=o),n&&(n.next=o),d?i.size++:e.size++,"F"!==r&&(i.index[r]=o)),e},y=function(e,t){var a,n=h(e),r=f(t);if("F"!==r)return n.index[r];for(a=n.first;a;a=a.next)if(a.key==t)return a};return i(l.prototype,{clear:function(){var e=this,t=h(e),a=t.index,n=t.first;while(n)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete a[n.index],n=n.next;t.first=t.last=void 0,d?t.size=0:e.size=0},delete:function(e){var t=this,a=h(t),n=y(t,e);if(n){var r=n.next,i=n.previous;delete a.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),a.first==n&&(a.first=r),a.last==n&&(a.last=i),d?a.size--:t.size--}return!!n},forEach:function(e){var t,a=h(this),n=o(e,arguments.length>1?arguments[1]:void 0,3);while(t=t?t.next:a.first){n(t.value,t.key,this);while(t&&t.removed)t=t.previous}},has:function(e){return!!y(this,e)}}),i(l.prototype,a?{get:function(e){var t=y(this,e);return t&&t.value},set:function(e,t){return g(this,0===e?0:e,t)}}:{add:function(e){return g(this,e=0===e?0:e,e)}}),d&&n(l.prototype,"size",{get:function(){return h(this).size}}),l},setStrong:function(e,t,a){var n=t+" Iterator",r=v(t),i=v(n);c(e,t,(function(e,t){p(this,{type:n,target:e,state:r(e),kind:t,last:void 0})}),(function(){var e=i(this),t=e.kind,a=e.last;while(a&&a.removed)a=a.previous;return e.target&&(e.last=a=a?a.next:e.state.first)?"keys"==t?{value:a.key,done:!1}:"values"==t?{value:a.value,done:!1}:{value:[a.key,a.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),a?"entries":"values",!a,!0),l(t)}}},"6d61":function(e,t,a){"use strict";var n=a("23e7"),r=a("da84"),i=a("94ca"),o=a("6eeb"),s=a("f183"),u=a("2266"),c=a("19aa"),l=a("861d"),d=a("d039"),f=a("1c7e"),h=a("d44e"),p=a("7156");e.exports=function(e,t,a){var v=-1!==e.indexOf("Map"),g=-1!==e.indexOf("Weak"),y=v?"set":"add",m=r[e],_=m&&m.prototype,k=m,b={},w=function(e){var t=_[e];o(_,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!l(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:function(e,a){return t.call(this,0===e?0:e,a),this})},x=i(e,"function"!=typeof m||!(g||_.forEach&&!d((function(){(new m).entries().next()}))));if(x)k=a.getConstructor(t,e,v,y),s.enable();else if(i(e,!0)){var T=new k,L=T[y](g?{}:-0,1)!=T,z=d((function(){T.has(1)})),S=f((function(e){new m(e)})),M=!g&&d((function(){var e=new m,t=5;while(t--)e[y](t,t);return!e.has(-0)}));S||(k=t((function(t,a){c(t,k,e);var n=p(new m,t,k);return void 0!=a&&u(a,n[y],{that:n,AS_ENTRIES:v}),n})),k.prototype=_,_.constructor=k),(z||M)&&(w("delete"),w("has"),v&&w("get")),(M||L)&&w(y),g&&_.clear&&delete _.clear}return b[e]=k,n({global:!0,forced:k!=m},b),h(k,e),g||a.setStrong(k,e,v),k}},"6f6b":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"map"},[a("v-btn",{staticClass:"map-button",staticStyle:{position:"fixed"},attrs:{title:"My location","aria-label":"My location",fab:"",small:""},on:{click:function(t){return e.toggleTracking()}}},[e.tracking?a("v-icon",[e._v("gps_off")]):a("v-icon",[e._v("gps_fixed")])],1),a("div",{staticClass:"map",attrs:{id:"leaflet-map"}}),a("v-overlay",{attrs:{absolute:!0,opacity:.5,"z-index":199,value:e.loading}},[a("v-progress-circular",{attrs:{indeterminate:"",size:64}})],1)],1)},r=[],i=(a("d81d"),a("d3b7"),a("1f54"),a("e11e")),o=(a("4160"),a("b0c0"),a("0613")),s=a("d4ec"),u=a("bee2"),c=a("7e84");a("e439"),a("5d41");function l(e,t){while(!Object.prototype.hasOwnProperty.call(e,t))if(e=Object(c["a"])(e),null===e)break;return e}function d(e,t,a){return d="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,a){var n=l(e,t);if(n){var r=Object.getOwnPropertyDescriptor(n,t);return r.get?r.get.call(a):r.value}},d(e,t,a||e)}var f=a("2caf"),h=a("262e"),p=a("5033"),v=function(e){Object(h["a"])(a,e);var t=Object(f["a"])(a);function a(){return Object(s["a"])(this,a),t.apply(this,arguments)}return Object(u["a"])(a,[{key:"createTile",value:function(e,t){var n=d(Object(c["a"])(a.prototype),"createTile",this).call(this,e,t);return p["a"].fetchImage("tile-"+e.x+"-"+e.y+"-"+e.z,n.src,"png").then((function(e){n.src=e})),n.src="",n}}]),a}(i["TileLayer"]),g={name:"Cartodb",url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/rastertiles/voyager/{z}/{x}/{y}.png"},y=[{name:"OpenCycleMap",url:"https://tile.thunderforest.com/cycle/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Transport",url:"https://tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Landscape",url:"https://tile.thunderforest.com/landscape/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Outdoors",url:"https://tile.thunderforest.com/outdoors/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Transport Dark",url:"https://tile.thunderforest.com/transport-dark/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Spinal Map",url:"https://tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Pioneer",url:"https://tile.thunderforest.com/pioneer/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Mobile Atlas",url:"https://tile.thunderforest.com/mobile-atlas/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"},{name:"Neighbourhood",url:"https://tile.thunderforest.com/neighbourhood/{z}/{x}/{y}.png?apikey=f570d731fdd34004a64587d87a02c81d"}],m=function(e){var t=i["control"].layers().addTo(e),a=new v(g.url,{crossOrigin:!0});e.addLayer(a),t.addBaseLayer(a,g.name),o["a"].state.online&&y.forEach((function(e){t.addBaseLayer(new i["TileLayer"](e.url),e.name)}))},_=a("b922"),k=a("b005"),b={map:null,computed:{loading:function(){return this.$store.state.area.loading},tracking:{get:function(){return this.$store.state.tracking},set:function(e){this.$store.commit("tracking",e)}}},mounted:function(){var e=this,t=new i["LatLngBounds"](new i["LatLng"](89,-179),new i["LatLng"](-89,179));this.$options.map=new i["Map"]("leaflet-map",{noWrap:!0,maxZoom:18,minZoom:2,zoom:2,maxBounds:t,maxBoundsViscosity:1,center:[0,0],zoomControl:!1,renderer:new i["Canvas"]({tolerance:5})}),m(this.$options.map),_["a"].map=this.$options.map,this.tracking&&a.e("myLocation.service").then(a.bind(null,"e9c3")).then((function(t){t.default.startTracking(e.$options.map)})),i["control"].zoom({position:"bottomright"}).addTo(this.$options.map),i["control"].scale().addTo(this.$options.map),this.$options.map.on("moveend",(function(){k["a"].state.left||(_["a"].lastMapBounds=e.$options.map.getBounds())}))},methods:{toggleTracking:function(){var e=this;a.e("myLocation.service").then(a.bind(null,"e9c3")).then((function(t){e.tracking?(t.default.stopTracking(),e.tracking=!1):(t.default.startTracking(e.$options.map),e.tracking=!0)}))}},destroyed:function(){_["a"].map=null,a.e("myLocation.service").then(a.bind(null,"e9c3")).then((function(e){e.default.removeMap()}))}},w=b,x=a("2877"),T=a("6544"),L=a.n(T),z=a("8336"),S=a("132d"),M=a("a797"),O=a("490a"),B=Object(x["a"])(w,n,r,!1,null,null,null);t["default"]=B.exports;L()(B,{VBtn:z["a"],VIcon:S["a"],VOverlay:M["a"],VProgressCircular:O["a"]})},b922:function(e,t,a){"use strict";a("4160"),a("caad"),a("fb6a"),a("4ec9"),a("d3b7"),a("ac1f"),a("2532"),a("3ca3"),a("1276"),a("159b"),a("ddb0");var n=a("b85c"),r=a("d4ec"),i=a("bee2"),o=a("e11e"),s=a("0613"),u=a("a005"),c=a("a96b");function l(e){return e?e+"m":""}var d={set:function(e,t){e.bindTooltip(t,{permanent:!0,sticky:!0,className:"tooltip",interactive:!0})},route:function(e){var t=e.layer,a=e.item;this.set(t,c["a"].forge(a.grades)+", "+l(a.length))},pitch:function(e){var t=e.layer,a=e.item;this.set(t,c["a"].forge(a.grades)+", "+l(a.length))}},f=d,h=a("5d57"),p=a("f41f"),v=function(){function e(){Object(r["a"])(this,e),this._layerGroup=new o["FeatureGroup"],this._features=new Map,this._anchors=new Map,this._selected=[],this._tooltipsClosed=!1,this._lastLayerBounds=void 0,this._lastLayerSurfaceSize=1e3,this.registerHighlightWatch()}return Object(i["a"])(e,[{key:"registerHighlightWatch",value:function(){var e=this;s["a"].watch((function(){return p["a"].key}),(function(t){e.refreshStyle(t)}))}},{key:"registerTagsWatch",value:function(){var e=this;this._unwatchTags=s["a"].watch((function(e,t){return t.tags}),(function(t){s["a"].getters.loading||(e.setSelectedKeys(),e.addTagsToView(t))}),{immediate:!0})}},{key:"setSelectedKeys",value:function(){var e;this._selected=[];var t=null===(e=s["a"].state.url)||void 0===e?void 0:e.params;for(var a in t){var r=a.slice(0,-2),i=t[a],o=r+i;if(this._selected.push(o),r===h["b"].Route){var u=s["a"].getters[h["b"].Route+"/find"](i);if(u&&u.pitches){var c,l=Object(n["a"])(u.pitches);try{for(l.s();!(c=l.n()).done;){var d=c.value;this._selected.push(h["b"].Pitch+d)}}catch(f){l.e(f)}finally{l.f()}}}}}},{key:"isSelectedFeature",value:function(e){return this._selected.includes(e)}},{key:"refreshStyle",value:function(e){var t=this;this._features.forEach((function(a,n){e===n?t.setStyle("highlight",a):t.setDefaultStyle(n,a)}))}},{key:"removeLayers",value:function(){var e=this;this._features.forEach((function(t){e._layerGroup.removeLayer(t.layer)})),this._features.clear(),this._anchors.forEach((function(t){e._layerGroup.removeLayer(t)})),this._anchors.clear()}},{key:"hideTag",value:function(e){var t=this._features.get(e);t&&this._layerGroup.removeLayer(t.layer);var a=this._anchors.get(e);a&&this._layerGroup.removeLayer(a)}},{key:"showTag",value:function(e){var t=this._features.get(e.tagged_type+e.tagged_id);t&&this._layerGroup.addLayer(t.layer)}},{key:"hasTag",value:function(e){return this._features.has(e)}},{key:"getTag",value:function(e){var t;return null===(t=this._features.get(e))||void 0===t?void 0:t.tag}},{key:"addTagsToView",value:function(e){var t=this;this.removeLayers(),this._tooltipsClosed=!1,e.forEach((function(e){var a=e.tagged_type&&s["a"].getters[e.tagged_type+"/find"](e.tagged_id);if(a){var n=t.createLayer(e),r={layer:n,item:a,tag:e},i=e.tagged_type+e.tagged_id;t._features.set(i,r),t.registerListeners(i,r),"image"===t._mapType&&f[e.tagged_type]&&f[e.tagged_type](r),t._layerGroup.addLayer(n)}})),this.refreshStyle(),s["a"].getters.imageOpen?this.addAnchors():this.setMapViewpoint()}},{key:"addAnchors",value:function(){var e=this;this._features.forEach((function(t,a){if(t.tag.tagged_type===h["b"].Route||t.tag.tagged_type===h["b"].Pitch){var n=e.createAnchor(t.tag.geometry.coordinates);e._anchors.set(a,n),e._layerGroup.addLayer(n)}}))}},{key:"setMapViewpoint",value:function(){var e;if(0!==this._layerGroup.getLayers().length){var t=this._layerGroup.getBounds(),a=this.calculateSurface(t),n=18;1===this._features.size&&this._features.forEach((function(e){var t=e.item.path,a=10;n=t?a+2*t.split(".").length:a}));var r=Math.abs(this._lastLayerSurfaceSize-a)<1e-4,i=this._lastLayerBounds&&(this._lastLayerBounds.overlaps(t)||(null===(e=this._lastLayerBounds)||void 0===e?void 0:e.equals(t)));r&&i&&this.lastMapBounds?this._map.fitBounds(this.lastMapBounds):(this._lastLayerBounds=t,this._lastLayerSurfaceSize=a,this.lastMapBounds=void 0,this._map.fitBounds(this._lastLayerBounds,{padding:[100,100],maxZoom:n}))}}},{key:"calculateSurface",value:function(e){var t=e.getWest()-e.getEast(),a=e.getNorth()-e.getSouth();return Math.abs(t*a)}},{key:"setDefaultStyle",value:function(e,t){this.isSelectedFeature(e)?this.setStyle("selected",t):this.setStyle("default",t)}},{key:"setStyle",value:function(e,t){var a=t.tag.tagged_type;u["a"][this._mapType][a]&&u["a"][this._mapType][a][e]({layer:t.layer,item:t.item})}},{key:"createLayer",value:function(e){var t;switch(e.geometry.type){case"Point":t=this.createMarker(e.geometry.coordinates);break;case"LineString":t=this.createPolyline(e.geometry.coordinates);break}return t}},{key:"createAnchor",value:function(e){var t=e[0],a=e[e.length-1],n=a[1]>t[1]?a:t;return new o["CircleMarker"]([n[1],n[0]],{radius:5,stroke:!1,fillOpacity:1,fillColor:"white"})}},{key:"createMarker",value:function(e){return new o["Marker"]([e[1],e[0]])}},{key:"toggleAllTooltips",value:function(){var e;this._tooltipsClosed?(e="openTooltip",this._tooltipsClosed=!1):(e="closeTooltip",this._tooltipsClosed=!0),this._features.forEach((function(t){t.layer[e]()}))}},{key:"createPolyline",value:function(e){var t=[];return e.forEach((function(e){t.push([e[1],e[0]])})),new o["Polyline"](t)}},{key:"registerListeners",value:function(e,t){t.layer.on("mouseover",(function(t){p["a"].key=e,t.target.getTooltip()&&t.target.closeTooltip()})).on("mouseout",(function(e){p["a"].key=null,e.target.getTooltip()&&e.target.openTooltip()})).on("click",(function(e){void 0===e.target.getPopup()&&a.e("popup.service").then(a.bind(null,"3b97")).then((function(a){var n=a.default;n.createPopup(t,e.latlng)}))}))}},{key:"map",set:function(e){this.removeLayers(),this._map=e,null===this._map?this._unwatchTags&&this._unwatchTags():(s["a"].getters.imageOpen?(this._mapType="image",this.lastMapBounds=void 0):this._mapType="map",this._layerGroup.addTo(e),this.registerTagsWatch())},get:function(){return this._map}}]),e}(),g=new v;t["a"]=g},c60d:function(e,t,a){var n=a("5135");e.exports=function(e){return void 0!==e&&(n(e,"value")||n(e,"writable"))}}}]);