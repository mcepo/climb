(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["drawing.service"],{"4ec9":function(t,e,r){"use strict";var i=r("6d61"),n=r("6566");t.exports=i("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),n)},6566:function(t,e,r){"use strict";var i=r("9bf2").f,n=r("7c73"),a=r("e2cc"),o=r("0366"),s=r("19aa"),l=r("2266"),h=r("7dd0"),u=r("2626"),c=r("83ab"),p=r("f183").fastKey,f=r("69f3"),d=f.set,g=f.getterFor;t.exports={getConstructor:function(t,e,r,h){var u=t((function(t,i){s(t,u,e),d(t,{type:e,index:n(null),first:void 0,last:void 0,size:0}),c||(t.size=0),void 0!=i&&l(i,t[h],{that:t,AS_ENTRIES:r})})),f=g(e),m=function(t,e,r){var i,n,a=f(t),o=_(t,e);return o?o.value=r:(a.last=o={index:n=p(e,!0),key:e,value:r,previous:i=a.last,next:void 0,removed:!1},a.first||(a.first=o),i&&(i.next=o),c?a.size++:t.size++,"F"!==n&&(a.index[n]=o)),t},_=function(t,e){var r,i=f(t),n=p(e);if("F"!==n)return i.index[n];for(r=i.first;r;r=r.next)if(r.key==e)return r};return a(u.prototype,{clear:function(){var t=this,e=f(t),r=e.index,i=e.first;while(i)i.removed=!0,i.previous&&(i.previous=i.previous.next=void 0),delete r[i.index],i=i.next;e.first=e.last=void 0,c?e.size=0:t.size=0},delete:function(t){var e=this,r=f(e),i=_(e,t);if(i){var n=i.next,a=i.previous;delete r.index[i.index],i.removed=!0,a&&(a.next=n),n&&(n.previous=a),r.first==i&&(r.first=n),r.last==i&&(r.last=a),c?r.size--:e.size--}return!!i},forEach:function(t){var e,r=f(this),i=o(t,arguments.length>1?arguments[1]:void 0,3);while(e=e?e.next:r.first){i(e.value,e.key,this);while(e&&e.removed)e=e.previous}},has:function(t){return!!_(this,t)}}),a(u.prototype,r?{get:function(t){var e=_(this,t);return e&&e.value},set:function(t,e){return m(this,0===t?0:t,e)}}:{add:function(t){return m(this,t=0===t?0:t,t)}}),c&&i(u.prototype,"size",{get:function(){return f(this).size}}),u},setStrong:function(t,e,r){var i=e+" Iterator",n=g(e),a=g(i);h(t,e,(function(t,e){d(this,{type:i,target:t,state:n(t),kind:e,last:void 0})}),(function(){var t=a(this),e=t.kind,r=t.last;while(r&&r.removed)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),u(e)}}},"6d61":function(t,e,r){"use strict";var i=r("23e7"),n=r("da84"),a=r("94ca"),o=r("6eeb"),s=r("f183"),l=r("2266"),h=r("19aa"),u=r("861d"),c=r("d039"),p=r("1c7e"),f=r("d44e"),d=r("7156");t.exports=function(t,e,r){var g=-1!==t.indexOf("Map"),m=-1!==t.indexOf("Weak"),_=g?"set":"add",y=n[t],v=y&&y.prototype,b=y,L={},k=function(t){var e=v[t];o(v,t,"add"==t?function(t){return e.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:"get"==t?function(t){return m&&!u(t)?void 0:e.call(this,0===t?0:t)}:"has"==t?function(t){return!(m&&!u(t))&&e.call(this,0===t?0:t)}:function(t,r){return e.call(this,0===t?0:t,r),this})},M=a(t,"function"!=typeof y||!(m||v.forEach&&!c((function(){(new y).entries().next()}))));if(M)b=r.getConstructor(e,t,g,_),s.enable();else if(a(t,!0)){var w=new b,x=w[_](m?{}:-0,1)!=w,P=c((function(){w.has(1)})),C=p((function(t){new y(t)})),E=!m&&c((function(){var t=new y,e=5;while(e--)t[_](e,e);return!t.has(-0)}));C||(b=e((function(e,r){h(e,b,t);var i=d(new y,e,b);return void 0!=r&&l(r,i[_],{that:i,AS_ENTRIES:g}),i})),b.prototype=v,v.constructor=b),(P||E)&&(k("delete"),k("has"),g&&k("get")),(E||x)&&k(_),m&&v.clear&&delete v.clear}return L[t]=b,i({global:!0,forced:b!=y},L),f(b,t),m||r.setStrong(b,t,g),b}},"7a36":function(t,e,r){"use strict";r("4160"),r("4ec9"),r("d3b7"),r("3ca3"),r("159b"),r("ddb0");var i=r("d4ec"),n=r("bee2"),a=function(){function t(){Object(i["a"])(this,t),this.positionOptions={enableHighAccuracy:!0,maximumAge:1e4,timeout:1e3}}return Object(n["a"])(t,[{key:"startWatch",value:function(t){this._watchId||(this._watchId=navigator.geolocation.watchPosition((function(e){e&&t(e.coords,null)}),(function(e){t(null,e)}),this.positionOptions))}},{key:"stopWatch",value:function(){this._watchId&&(navigator.geolocation.clearWatch(this._watchId),this._watchId=void 0)}}]),t}(),o=new a,s=o,l=r("1547"),h=Object(l["c"])("BackgroundGeolocation"),u=function(){function t(){Object(i["a"])(this,t)}return Object(n["a"])(t,[{key:"startWatch",value:function(t){var e=this;this._watcherId||h.addWatcher({backgroundMessage:"Displaying your trail in app",backgroundTitle:"Using GPS",requestPermissions:!0,stale:!1,distanceFilter:0},(function(e,r){r&&"NOT_AUTHORIZED"===r.code&&("Permission denied."===r.message&&window.confirm(r.message+"\n\nOpen settings now?")?h.openSettings():window.alert(r.message)),t(e,r)})).then((function(t){e._watcherId=t}))}},{key:"stopWatch",value:function(){this._watcherId&&(h.removeWatcher({id:this._watcherId}),this._watcherId=void 0)}}]),t}(),c=new u,p=c,f=function(){function t(e){Object(i["a"])(this,t),this._callbacks=new Map,this._callbackCounter=0,this._lastPosition=null,this._provider=e}return Object(n["a"])(t,[{key:"registerCallback",value:function(t){var e=this;return 0===this._callbacks.size&&this._provider.startWatch((function(t,r){e._lastPosition=t,e._processPosition(t,r)})),this._callbackCounter++,this._callbacks.set(this._callbackCounter,t),this._lastPosition&&this._processPosition(this._lastPosition,null),this._callbackCounter}},{key:"_processPosition",value:function(t,e){!e&&t&&this._callbacks.forEach((function(e){e(t)}))}},{key:"unregisterCallback",value:function(t){this._callbacks.delete(t),0===this._callbacks.size&&(this._provider.stopWatch(),this._lastPosition=null)}}]),t}(),d=l["a"].isNativePlatform()?p:s,g=new f(d);e["a"]=g},"845a":function(t,e){!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=68)}([function(t,e,r){var i=r(136);t.exports=function(t,e,r){var n=null==t?void 0:i(t,e);return void 0===n?r:n}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=r(7),a=r(10),o=i(r(146)),s=r(16),l=i(r(147));function h(t,e){var r=a.getCoords(t),i=a.getCoords(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var o=r[0][0],s=r[0][1],l=r[1][0],h=r[1][1],u=i[0][0],c=i[0][1],p=i[1][0],f=i[1][1],d=(f-c)*(l-o)-(p-u)*(h-s),g=(p-u)*(s-c)-(f-c)*(o-u),m=(l-o)*(s-c)-(h-s)*(o-u);if(0===d)return null;var _=g/d,y=m/d;if(_>=0&&_<=1&&y>=0&&y<=1){var v=o+_*(l-o),b=s+_*(h-s);return n.point([v,b])}return null}e["default"]=function(t,e){var r={},i=[];if("LineString"===t.type&&(t=n.feature(t)),"LineString"===e.type&&(e=n.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var u=h(t,e);return u&&i.push(u),n.featureCollection(i)}var c=l["default"]();return c.load(o["default"](e)),s.featureEach(o["default"](t),(function(t){s.featureEach(c.search(t),(function(e){var n=h(t,e);if(n){var o=a.getCoords(n).join(",");r[o]||(r[o]=!0,i.push(n))}}))})),n.featureCollection(i)}},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e,r){var i=r(70),n=r(127)((function(t,e,r){i(t,e,r)}));t.exports=n},function(t,e,r){var i=r(29),n="object"==typeof self&&self&&self.Object===Object&&self,a=i||n||Function("return this")();t.exports=a},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){var r=Array.isArray;t.exports=r},function(t,e,r){"use strict";function i(t,e,r){void 0===r&&(r={});var i={type:"Feature"};return(0===r.id||r.id)&&(i.id=r.id),r.bbox&&(i.bbox=r.bbox),i.properties=e||{},i.geometry=t,i}function n(t,e,r){return void 0===r&&(r={}),i({type:"Point",coordinates:t},e,r)}function a(t,e,r){void 0===r&&(r={});for(var n=0,a=t;n<a.length;n++){var o=a[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<o[o.length-1].length;s++)if(o[o.length-1][s]!==o[0][s])throw new Error("First and last Position are not equivalent.")}return i({type:"Polygon",coordinates:t},e,r)}function o(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return i({type:"LineString",coordinates:t},e,r)}function s(t,e){void 0===e&&(e={});var r={type:"FeatureCollection"};return e.id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function l(t,e,r){return void 0===r&&(r={}),i({type:"MultiLineString",coordinates:t},e,r)}function h(t,e,r){return void 0===r&&(r={}),i({type:"MultiPoint",coordinates:t},e,r)}function u(t,e,r){return void 0===r&&(r={}),i({type:"MultiPolygon",coordinates:t},e,r)}function c(t,r){void 0===r&&(r="kilometers");var i=e.factors[r];if(!i)throw new Error(r+" units is invalid");return t*i}function p(t,r){void 0===r&&(r="kilometers");var i=e.factors[r];if(!i)throw new Error(r+" units is invalid");return t/i}function f(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=6371008.8,e.factors={centimeters:100*e.earthRadius,centimetres:100*e.earthRadius,degrees:e.earthRadius/111325,feet:3.28084*e.earthRadius,inches:39.37*e.earthRadius,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:1e3*e.earthRadius,millimetres:1e3*e.earthRadius,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius/1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1/1.0936},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},e.feature=i,e.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return n(e).geometry;case"LineString":return o(e).geometry;case"Polygon":return a(e).geometry;case"MultiPoint":return h(e).geometry;case"MultiLineString":return l(e).geometry;case"MultiPolygon":return u(e).geometry;default:throw new Error(t+" is invalid")}},e.point=n,e.points=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return n(t,e)})),r)},e.polygon=a,e.polygons=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return a(t,e)})),r)},e.lineString=o,e.lineStrings=function(t,e,r){return void 0===r&&(r={}),s(t.map((function(t){return o(t,e)})),r)},e.featureCollection=s,e.multiLineString=l,e.multiPoint=h,e.multiPolygon=u,e.geometryCollection=function(t,e,r){return void 0===r&&(r={}),i({type:"GeometryCollection",geometries:t},e,r)},e.round=function(t,e){if(void 0===e&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var r=Math.pow(10,e||0);return Math.round(t*r)/r},e.radiansToLength=c,e.lengthToRadians=p,e.lengthToDegrees=function(t,e){return f(p(t,e))},e.bearingToAzimuth=function(t){var e=t%360;return e<0&&(e+=360),e},e.radiansToDegrees=f,e.degreesToRadians=function(t){return t%360*Math.PI/180},e.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),!(t>=0))throw new Error("length must be a positive number");return c(p(t,e),r)},e.convertArea=function(t,r,i){if(void 0===r&&(r="meters"),void 0===i&&(i="kilometers"),!(t>=0))throw new Error("area must be a positive number");var n=e.areaFactors[r];if(!n)throw new Error("invalid original units");var a=e.areaFactors[i];if(!a)throw new Error("invalid final units");return t/n*a},e.isNumber=d,e.isObject=function(t){return!!t&&t.constructor===Object},e.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!d(t))throw new Error("bbox must only contain numbers")}))},e.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")},e.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},e.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},e.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},e.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},e.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},e.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},e.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(7);function n(t,e,r,i,n,a,o,s){var l,h,u,c,p={x:null,y:null,onLine1:!1,onLine2:!1};return 0===(l=(s-a)*(r-t)-(o-n)*(i-e))?null!==p.x&&null!==p.y&&p:(c=(r-t)*(h=e-a)-(i-e)*(u=t-n),h=((o-n)*h-(s-a)*u)/l,u=c/l,p.x=t+h*(r-t),p.y=e+h*(i-e),h>=0&&h<=1&&(p.onLine1=!0),u>=0&&u<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y])}e["default"]=function(t){var e,r,a={type:"FeatureCollection",features:[]};if("LineString"===(r="Feature"===t.type?t.geometry:t).type)e=[r.coordinates];else if("MultiLineString"===r.type)e=r.coordinates;else if("MultiPolygon"===r.type)e=[].concat.apply([],r.coordinates);else{if("Polygon"!==r.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=r.coordinates}return e.forEach((function(t){e.forEach((function(e){for(var r=0;r<t.length-1;r++)for(var o=r;o<e.length-1;o++){if(t===e){if(1===Math.abs(r-o))continue;if(0===r&&o===t.length-2&&t[r][0]===t[t.length-1][0]&&t[r][1]===t[t.length-1][1])continue}var s=n(t[r][0],t[r][1],t[r+1][0],t[r+1][1],e[o][0],e[o][1],e[o+1][0],e[o+1][1]);s&&a.features.push(i.point([s[0],s[1]]))}}))})),a}},function(t,e,r){var i=r(19),n=r(84),a=r(85),o=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?n(t):a(t)}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(7);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(e.length>1&&i.isNumber(e[0])&&i.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.type)},e.featureOf=function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+t.geometry.type)},e.collectionOf=function(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to "+r+", FeatureCollection required");for(var i=0,n=t.features;i<n.length;i++){var a=n[i];if(!a||"Feature"!==a.type||!a.geometry)throw new Error("Invalid input to "+r+", Feature with geometry required");if(!a.geometry||a.geometry.type!==e)throw new Error("Invalid input to "+r+": must be a "+e+", given "+a.geometry.type)}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":"Feature"===t.type&&null!==t.geometry?t.geometry.type:t.type}},function(t,e,r){var i=r(72),n=r(73),a=r(74),o=r(75),s=r(76);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype["delete"]=n,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,r){var i=r(13);t.exports=function(t,e){for(var r=t.length;r--;)if(i(t[r][0],e))return r;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,r){var i=r(17)(Object,"create");t.exports=i},function(t,e,r){var i=r(98);t.exports=function(t,e){var r=t.__data__;return i(e)?r["string"==typeof e?"string":"hash"]:r.map}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(7);function n(t,e,r){if(null!==t)for(var i,a,o,s,l,h,u,c,p=0,f=0,d=t.type,g="FeatureCollection"===d,m="Feature"===d,_=g?t.features.length:1,y=0;y<_;y++){l=(c=!!(u=g?t.features[y].geometry:m?t.geometry:t)&&"GeometryCollection"===u.type)?u.geometries.length:1;for(var v=0;v<l;v++){var b=0,L=0;if(null!==(s=c?u.geometries[v]:u)){h=s.coordinates;var k=s.type;switch(p=!r||"Polygon"!==k&&"MultiPolygon"!==k?0:1,k){case null:break;case"Point":if(!1===e(h,f,y,b,L))return!1;f++,b++;break;case"LineString":case"MultiPoint":for(i=0;i<h.length;i++){if(!1===e(h[i],f,y,b,L))return!1;f++,"MultiPoint"===k&&b++}"LineString"===k&&b++;break;case"Polygon":case"MultiLineString":for(i=0;i<h.length;i++){for(a=0;a<h[i].length-p;a++){if(!1===e(h[i][a],f,y,b,L))return!1;f++}"MultiLineString"===k&&b++,"Polygon"===k&&L++}"Polygon"===k&&b++;break;case"MultiPolygon":for(i=0;i<h.length;i++){for(L=0,a=0;a<h[i].length;a++){for(o=0;o<h[i][a].length-p;o++){if(!1===e(h[i][a][o],f,y,b,L))return!1;f++}L++}b++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===n(s.geometries[i],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function a(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function o(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function s(t,e){var r,i,n,a,o,s,l,h,u,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(r=0;r<g;r++){for(s=f?t.features[r].geometry:d?t.geometry:t,h=f?t.features[r].properties:d?t.properties:{},u=f?t.features[r].bbox:d?t.bbox:void 0,c=f?t.features[r].id:d?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(a=l?s.geometries[n]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,p,h,u,c))return!1;break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===e(a.geometries[i],p,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,h,u,c))return!1;p++}}function l(t,e){s(t,(function(t,r,n,a,o){var s,l=null===t?null:t.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return!1!==e(i.feature(t,n,{bbox:a,id:o}),r,0)&&void 0}switch(l){case"MultiPoint":s="Point";break;case"MultiLineString":s="LineString";break;case"MultiPolygon":s="Polygon"}for(var h=0;h<t.coordinates.length;h++){var u={type:s,coordinates:t.coordinates[h]};if(!1===e(i.feature(u,n),r,h))return!1}}))}function h(t,e){l(t,(function(t,r,a){var o=0;if(t.geometry){var s=t.geometry.type;if("Point"!==s&&"MultiPoint"!==s){var l,h=0,u=0,c=0;return!1!==n(t,(function(n,s,p,f,d){if(void 0===l||r>h||f>u||d>c)return l=n,h=r,u=f,c=d,void(o=0);var g=i.lineString([l,n],t.properties);if(!1===e(g,r,a,d,o))return!1;o++,l=n}))&&void 0}}}))}function u(t,e){if(!t)throw new Error("geojson is required");l(t,(function(t,r,n){if(null!==t.geometry){var a=t.geometry.type,o=t.geometry.coordinates;switch(a){case"LineString":if(!1===e(t,r,n,0,0))return!1;break;case"Polygon":for(var s=0;s<o.length;s++)if(!1===e(i.lineString(o[s],t.properties),r,n,s))return!1}}}))}e.coordEach=n,e.coordReduce=function(t,e,r,i){var a=r;return n(t,(function(t,i,n,o,s){a=0===i&&void 0===r?t:e(a,t,i,n,o,s)}),i),a},e.propEach=a,e.propReduce=function(t,e,r){var i=r;return a(t,(function(t,n){i=0===n&&void 0===r?t:e(i,t,n)})),i},e.featureEach=o,e.featureReduce=function(t,e,r){var i=r;return o(t,(function(t,n){i=0===n&&void 0===r?t:e(i,t,n)})),i},e.coordAll=function(t){var e=[];return n(t,(function(t){e.push(t)})),e},e.geomEach=s,e.geomReduce=function(t,e,r){var i=r;return s(t,(function(t,n,a,o,s){i=0===n&&void 0===r?t:e(i,t,n,a,o,s)})),i},e.flattenEach=l,e.flattenReduce=function(t,e,r){var i=r;return l(t,(function(t,n,a){i=0===n&&0===a&&void 0===r?t:e(i,t,n,a)})),i},e.segmentEach=h,e.segmentReduce=function(t,e,r){var i=r,n=!1;return h(t,(function(t,a,o,s,l){i=!1===n&&void 0===r?t:e(i,t,a,o,s,l),n=!0})),i},e.lineEach=u,e.lineReduce=function(t,e,r){var i=r;return u(t,(function(t,n,a,o){i=0===n&&void 0===r?t:e(i,t,n,a,o)})),i},e.findSegment=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var r,n=e.featureIndex||0,a=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.segmentIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),l=l||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":l=l||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var h=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return s<0&&(s=h.length+s-1),i.lineString([h[s],h[s+1]],l,e);case"Polygon":return o<0&&(o=h.length+o),s<0&&(s=h[o].length+s-1),i.lineString([h[o][s],h[o][s+1]],l,e);case"MultiLineString":return a<0&&(a=h.length+a),s<0&&(s=h[a].length+s-1),i.lineString([h[a][s],h[a][s+1]],l,e);case"MultiPolygon":return a<0&&(a=h.length+a),o<0&&(o=h[a].length+o),s<0&&(s=h[a][o].length-s-1),i.lineString([h[a][o][s],h[a][o][s+1]],l,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(e=e||{},!i.isObject(e))throw new Error("options is invalid");var r,n=e.featureIndex||0,a=e.multiFeatureIndex||0,o=e.geometryIndex||0,s=e.coordIndex||0,l=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),l=l||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":l=l||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var h=r.coordinates;switch(r.type){case"Point":return i.point(h,l,e);case"MultiPoint":return a<0&&(a=h.length+a),i.point(h[a],l,e);case"LineString":return s<0&&(s=h.length+s),i.point(h[s],l,e);case"Polygon":return o<0&&(o=h.length+o),s<0&&(s=h[o].length+s),i.point(h[o][s],l,e);case"MultiLineString":return a<0&&(a=h.length+a),s<0&&(s=h[a].length+s),i.point(h[a][s],l,e);case"MultiPolygon":return a<0&&(a=h.length+a),o<0&&(o=h[a].length+o),s<0&&(s=h[a][o].length-s),i.point(h[a][o][s],l,e)}throw new Error("geojson is invalid")}},function(t,e,r){var i=r(82),n=r(89);t.exports=function(t,e){var r=n(t,e);return i(r)?r:void 0}},function(t,e,r){var i=r(9),n=r(2);t.exports=function(t){if(!n(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,r){var i=r(4).Symbol;t.exports=i},function(t,e,r){var i=r(32);t.exports=function(t,e,r){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){var i=r(113),n=r(5),a=Object.prototype,o=a.hasOwnProperty,s=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(t){return n(t)&&o.call(t,"callee")&&!s.call(t,"callee")};t.exports=l},function(t,e,r){var i=r(18),n=r(24);t.exports=function(t){return null!=t&&n(t.length)&&!i(t)}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e){var r=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var i=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==i||"symbol"!=i&&r.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,r){var i=r(9),n=r(5);t.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==i(t)}},function(t,e,r){(function(e){t.exports=function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}
/**
   * splaytree v3.0.1
   * Fast Splay tree for Node and browser
   *
   * @author Alexander Milevski <info@w8r.name>
   * @license MIT
   * @preserve
   */var n=function e(r,i){t(this,e),this.next=null,this.key=r,this.data=i,this.left=null,this.right=null};function a(t,e){return t>e?1:t<e?-1:0}function o(t,e,r){for(var i=new n(null,null),a=i,o=i;;){var s=r(t,e.key);if(s<0){if(null===e.left)break;if(r(t,e.left.key)<0){var l=e.left;if(e.left=l.right,l.right=e,null===(e=l).left)break}o.left=e,o=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(r(t,e.right.key)>0){var h=e.right;if(e.right=h.left,h.left=e,null===(e=h).right)break}a.right=e,a=e,e=e.right}}return a.right=e.left,o.left=e.right,e.left=i.right,e.right=i.left,e}function s(t,e,r,i){var a=new n(t,e);if(null===r)return a.left=a.right=null,a;var s=i(t,(r=o(t,r,i)).key);return s<0?(a.left=r.left,a.right=r,r.left=null):s>=0&&(a.right=r.right,a.left=r,r.right=null),a}function l(t,e,r){var i=null,n=null;if(e){var a=r((e=o(t,e,r)).key,t);0===a?(i=e.left,n=e.right):a<0?(n=e.right,e.right=null,i=e):(i=e.left,e.left=null,n=e)}return{left:i,right:n}}function h(t,e,r,i,n){if(t){i("".concat(e).concat(r?"└── ":"├── ").concat(n(t),"\n"));var a=e+(r?"    ":"│   ");t.left&&h(t.left,a,!1,i,n),t.right&&h(t.right,a,!0,i,n)}}var u=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;t(this,e),this._root=null,this._size=0,this._comparator=r}return i(e,[{key:"insert",value:function(t,e){return this._size++,this._root=s(t,e,this._root,this._comparator)}},{key:"add",value:function(t,e){var r=new n(t,e);null===this._root&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,a=o(t,this._root,i),s=i(t,a.key);return 0===s?this._root=a:(s<0?(r.left=a.left,r.right=a,a.left=null):s>0&&(r.right=a.right,r.left=a,a.right=null),this._size++,this._root=r),this._root}},{key:"remove",value:function(t){this._root=this._remove(t,this._root,this._comparator)}},{key:"_remove",value:function(t,e,r){var i;return null===e?null:0===r(t,(e=o(t,e,r)).key)?(null===e.left?i=e.right:(i=o(t,e.left,r)).right=e.right,this._size--,i):e}},{key:"pop",value:function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=o(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null}},{key:"findStatic",value:function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null}},{key:"find",value:function(t){return this._root&&(this._root=o(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root}},{key:"contains",value:function(t){for(var e=this._root,r=this._comparator;e;){var i=r(t,e.key);if(0===i)return!0;e=i<0?e.left:e.right}return!1}},{key:"forEach",value:function(t,e){for(var r=this._root,i=[],n=!1;!n;)null!==r?(i.push(r),r=r.left):0!==i.length?(r=i.pop(),t.call(e,r),r=r.right):n=!0;return this}},{key:"range",value:function(t,e,r,i){for(var n=[],a=this._comparator,o=this._root;0!==n.length||o;)if(o)n.push(o),o=o.left;else{if(a((o=n.pop()).key,e)>0)break;if(a(o.key,t)>=0&&r.call(i,o))return this;o=o.right}return this}},{key:"keys",value:function(){var t=[];return this.forEach((function(e){var r=e.key;return t.push(r)})),t}},{key:"values",value:function(){var t=[];return this.forEach((function(e){var r=e.data;return t.push(r)})),t}},{key:"min",value:function(){return this._root?this.minNode(this._root).key:null}},{key:"max",value:function(){return this._root?this.maxNode(this._root).key:null}},{key:"minNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.left;)t=t.left;return t}},{key:"maxNode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.right;)t=t.right;return t}},{key:"at",value:function(t){for(var e=this._root,r=!1,i=0,n=[];!r;)if(e)n.push(e),e=e.left;else if(n.length>0){if(e=n.pop(),i===t)return e;i++,e=e.right}else r=!0;return null}},{key:"next",value:function(t){var e=this._root,r=null;if(t.right){for(r=t.right;r.left;)r=r.left;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;n<0?(r=e,e=e.left):e=e.right}return r}},{key:"prev",value:function(t){var e=this._root,r=null;if(null!==t.left){for(r=t.left;r.right;)r=r.right;return r}for(var i=this._comparator;e;){var n=i(t.key,e.key);if(0===n)break;n<0?e=e.left:(r=e,e=e.right)}return r}},{key:"clear",value:function(){return this._root=null,this._size=0,this}},{key:"toList",value:function(){return function(t){for(var e=t,r=[],i=!1,a=new n(null,null),o=a;!i;)e?(r.push(e),e=e.left):r.length>0?e=(e=o=o.next=r.pop()).right:i=!0;return o.next=null,a.next}(this._root)}},{key:"load",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t.length,n=this._comparator;if(r&&g(t,e,0,i-1,n),null===this._root)this._root=c(t,e,0,i),this._size=i;else{var a=d(this.toList(),p(t,e),n);i=this._size+i,this._root=f({head:a},0,i)}return this}},{key:"isEmpty",value:function(){return null===this._root}},{key:"toString",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(t){return String(t.key)},e=[];return h(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")}},{key:"update",value:function(t,e,r){var i=this._comparator,n=l(t,this._root,i),a=n.left,h=n.right;i(t,e)<0?h=s(e,r,h,i):a=s(e,r,a,i),this._root=function(t,e,r){return null===e?t:(null===t||((e=o(t.key,e,r)).left=t),e)}(a,h,i)}},{key:"split",value:function(t){return l(t,this._root,this._comparator)}},{key:"size",get:function(){return this._size}},{key:"root",get:function(){return this._root}}]),e}();function c(t,e,r,i){var a=i-r;if(a>0){var o=r+Math.floor(a/2),s=t[o],l=e[o],h=new n(s,l);return h.left=c(t,e,r,o),h.right=c(t,e,o+1,i),h}return null}function p(t,e){for(var r=new n(null,null),i=r,a=0;a<t.length;a++)i=i.next=new n(t[a],e[a]);return i.next=null,r.next}function f(t,e,r){var i=r-e;if(i>0){var n=e+Math.floor(i/2),a=f(t,e,n),o=t.head;return o.left=a,t.head=t.head.next,o.right=f(t,n+1,r),o}return null}function d(t,e,r){for(var i=new n(null,null),a=i,o=t,s=e;null!==o&&null!==s;)r(o.key,s.key)<0?(a.next=o,o=o.next):(a.next=s,s=s.next),a=a.next;return null!==o?a.next=o:null!==s&&(a.next=s),i.next}function g(t,e,r,i,n){if(!(r>=i)){for(var a=t[r+i>>1],o=r-1,s=i+1;;){do{o++}while(n(t[o],a)<0);do{s--}while(n(t[s],a)>0);if(o>=s)break;var l=t[o];t[o]=t[s],t[s]=l,l=e[o],e[o]=e[s],e[s]=l}g(t,e,r,s,n),g(t,e,s+1,i,n)}}var m=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},_=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var r=t.ll.x<e.ll.x?e.ll.x:t.ll.x,i=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:r,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:i,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},y=Number.EPSILON;void 0===y&&(y=Math.pow(2,-52));var v=y*y,b=function(t,e){if(-y<t&&t<y&&-y<e&&e<y)return 0;var r=t-e;return r*r<v*t*e?0:t<e?-1:1},L=function(){function e(){t(this,e),this.reset()}return i(e,[{key:"reset",value:function(){this.xRounder=new k,this.yRounder=new k}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),e}(),k=function(){function e(){t(this,e),this.tree=new u,this.round(0)}return i(e,[{key:"round",value:function(t){var e=this.tree.add(t),r=this.tree.prev(e);if(null!==r&&0===b(e.key,r.key))return this.tree.remove(t),r.key;var i=this.tree.next(e);return null!==i&&0===b(e.key,i.key)?(this.tree.remove(t),i.key):t}}]),e}(),M=new L,w=function(t,e){return t.x*e.y-t.y*e.x},x=function(t,e){return t.x*e.x+t.y*e.y},P=function(t,e,r){var i={x:e.x-t.x,y:e.y-t.y},n={x:r.x-t.x,y:r.y-t.y},a=w(i,n);return b(a,0)},C=function(t){return Math.sqrt(x(t,t))},E=function(t,e,r){var i={x:e.x-t.x,y:e.y-t.y},n={x:r.x-t.x,y:r.y-t.y};return x(n,i)/C(n)/C(i)},S=function(t,e,r){return 0===e.y?null:{x:t.x+e.x/e.y*(r-t.y),y:r}},O=function(t,e,r){return 0===e.x?null:{x:r,y:t.y+e.y/e.x*(r-t.x)}},B=function(){function e(r,i){t(this,e),void 0===r.events?r.events=[this]:r.events.push(this),this.point=r,this.isLeft=i}return i(e,null,[{key:"compare",value:function(t,r){var i=e.comparePoints(t.point,r.point);return 0!==i?i:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:D.compare(t.segment,r.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),i(e,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,r=0,i=e.length;r<i;r++){var n=e[r];this.point.events.push(n),n.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var r=this.point.events[e];if(void 0===r.segment.consumedBy)for(var i=e+1;i<t;i++){var n=this.point.events[i];void 0===n.consumedBy&&r.otherSE.point.events===n.otherSE.point.events&&r.segment.consume(n.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,r=this.point.events.length;e<r;e++){var i=this.point.events[e];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,r=new Map,i=function(i){var n,a,o,s,l,h=i.otherSE;r.set(i,{sine:(n=e.point,a=t.point,o=h.point,s={x:a.x-n.x,y:a.y-n.y},l={x:o.x-n.x,y:o.y-n.y},w(l,s)/C(l)/C(s)),cosine:E(e.point,t.point,h.point)})};return function(t,e){r.has(t)||i(t),r.has(e)||i(e);var n=r.get(t),a=n.sine,o=n.cosine,s=r.get(e),l=s.sine,h=s.cosine;return a>=0&&l>=0?o<h?1:o>h?-1:0:a<0&&l<0?o<h?-1:o>h?1:0:l<a?-1:l>a?1:0}}}]),e}(),R=0,D=function(){function e(r,i,n,a){t(this,e),this.id=++R,this.leftSE=r,r.segment=this,r.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=r,this.rings=n,this.windings=a}return i(e,null,[{key:"compare",value:function(t,e){var r=t.leftSE.point.x,i=e.leftSE.point.x,n=t.rightSE.point.x,a=e.rightSE.point.x;if(a<r)return 1;if(n<i)return-1;var o=t.leftSE.point.y,s=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(r<i){if(s<o&&s<l)return 1;if(s>o&&s>l)return-1;var u=t.comparePoint(e.leftSE.point);if(u<0)return 1;if(u>0)return-1;var c=e.comparePoint(t.rightSE.point);return 0!==c?c:-1}if(r>i){if(o<s&&o<h)return-1;if(o>s&&o>h)return 1;var p=e.comparePoint(t.leftSE.point);if(0!==p)return p;var f=t.comparePoint(e.rightSE.point);return f<0?1:f>0?-1:1}if(o<s)return-1;if(o>s)return 1;if(n<a){var d=e.comparePoint(t.rightSE.point);if(0!==d)return d}if(n>a){var g=t.comparePoint(e.rightSE.point);if(g<0)return 1;if(g>0)return-1}if(n!==a){var m=l-o,_=n-r,y=h-s,v=a-i;if(m>_&&y<v)return 1;if(m<_&&y>v)return-1}return n>a?1:n<a||l<h?-1:l>h?1:t.id<e.id?-1:t.id>e.id?1:0}}]),i(e,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,r=this.rightSE.point,i=this.vector();if(e.x===r.x)return t.x===e.x?0:t.x<e.x?1:-1;var n=(t.y-e.y)/i.y,a=e.x+n*i.x;if(t.x===a)return 0;var o=(t.x-e.x)/i.x,s=e.y+o*i.y;return t.y===s?0:t.y<s?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),r=t.bbox(),i=_(e,r);if(null===i)return null;var n=this.leftSE.point,a=this.rightSE.point,o=t.leftSE.point,s=t.rightSE.point,l=m(e,o)&&0===this.comparePoint(o),h=m(r,n)&&0===t.comparePoint(n),u=m(e,s)&&0===this.comparePoint(s),c=m(r,a)&&0===t.comparePoint(a);if(h&&l)return c&&!u?a:!c&&u?s:null;if(h)return u&&n.x===s.x&&n.y===s.y?null:n;if(l)return c&&a.x===o.x&&a.y===o.y?null:o;if(c&&u)return null;if(c)return a;if(u)return s;var p=function(t,e,r,i){if(0===e.x)return O(r,i,t.x);if(0===i.x)return O(t,e,r.x);if(0===e.y)return S(r,i,t.y);if(0===i.y)return S(t,e,r.y);var n=w(e,i);if(0==n)return null;var a={x:r.x-t.x,y:r.y-t.y},o=w(a,e)/n,s=w(a,i)/n;return{x:(t.x+s*e.x+(r.x+o*i.x))/2,y:(t.y+s*e.y+(r.y+o*i.y))/2}}(n,this.vector(),o,t.vector());return null===p?null:m(i,p)?M.round(p.x,p.y):null}},{key:"split",value:function(t){var r=[],i=void 0!==t.events,n=new B(t,!0),a=new B(t,!1),o=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(n);var s=new e(n,o,this.rings.slice(),this.windings.slice());return B.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),B.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(n.checkForConsuming(),a.checkForConsuming()),r}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var r=this,i=t;r.consumedBy;)r=r.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var n=e.compare(r,i);if(0!==n){if(n>0){var a=r;r=i,i=a}if(r.prev===i){var o=r;r=i,i=o}for(var s=0,l=i.rings.length;s<l;s++){var h=i.rings[s],u=i.windings[s],c=r.rings.indexOf(h);-1===c?(r.rings.push(h),r.windings.push(u)):r.windings[c]+=u}i.rings=null,i.windings=null,i.consumedBy=r,i.leftSE.consumedBy=r.leftSE,i.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,r=this._afterState.windings,i=this._afterState.multiPolys,n=0,a=this.rings.length;n<a;n++){var o=this.rings[n],s=this.windings[n],l=e.indexOf(o);-1===l?(e.push(o),r.push(s)):r[l]+=s}for(var h=[],u=[],c=0,p=e.length;c<p;c++)if(0!==r[c]){var f=e[c],d=f.poly;if(-1===u.indexOf(d))if(f.isExterior)h.push(d);else{-1===u.indexOf(d)&&u.push(d);var g=h.indexOf(f.poly);-1!==g&&h.splice(g,1)}}for(var m=0,_=h.length;m<_;m++){var y=h[m].multiPoly;-1===i.indexOf(y)&&i.push(y)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(U.type){case"union":var r=0===t.length,i=0===e.length;this._isInResult=r!==i;break;case"intersection":var n,a;t.length<e.length?(n=t.length,a=e.length):(n=e.length,a=t.length),this._isInResult=a===U.numMultiPolys&&n<a;break;case"xor":var o=Math.abs(t.length-e.length);this._isInResult=o%2==1;break;case"difference":var s=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=s(t)!==s(e);break;default:throw new Error("Unrecognized operation type found ".concat(U.type))}return this._isInResult}}],[{key:"fromRing",value:function(t,r,i){var n,a,o,s=B.comparePoints(t,r);if(s<0)n=t,a=r,o=1;else{if(!(s>0))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));n=r,a=t,o=-1}return new e(new B(n,!0),new B(a,!1),[i],[o])}}]),e}(),T=function(){function e(r,i,n){if(t(this,e),!Array.isArray(r)||0===r.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof r[0][0]||"number"!=typeof r[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var a=M.round(r[0][0],r[0][1]);this.bbox={ll:{x:a.x,y:a.y},ur:{x:a.x,y:a.y}};for(var o=a,s=1,l=r.length;s<l;s++){if("number"!=typeof r[s][0]||"number"!=typeof r[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var h=M.round(r[s][0],r[s][1]);h.x===o.x&&h.y===o.y||(this.segments.push(D.fromRing(o,h,this)),h.x<this.bbox.ll.x&&(this.bbox.ll.x=h.x),h.y<this.bbox.ll.y&&(this.bbox.ll.y=h.y),h.x>this.bbox.ur.x&&(this.bbox.ur.x=h.x),h.y>this.bbox.ur.y&&(this.bbox.ur.y=h.y),o=h)}a.x===o.x&&a.y===o.y||this.segments.push(D.fromRing(o,a,this))}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.segments.length;e<r;e++){var i=this.segments[e];t.push(i.leftSE),t.push(i.rightSE)}return t}}]),e}(),j=function(){function e(r,i){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new T(r[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,a=r.length;n<a;n++){var o=new T(r[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=i}return i(e,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,r=this.interiorRings.length;e<r;e++)for(var i=this.interiorRings[e].getSweepEvents(),n=0,a=i.length;n<a;n++)t.push(i[n]);return t}}]),e}(),I=function(){function e(r,i){if(t(this,e),!Array.isArray(r))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof r[0][0][0]&&(r=[r])}catch(s){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,a=r.length;n<a;n++){var o=new j(r[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=i}return i(e,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++)for(var i=this.polys[e].getSweepEvents(),n=0,a=i.length;n<a;n++)t.push(i[n]);return t}}]),e}(),G=function(){function e(r){t(this,e),this.events=r;for(var i=0,n=r.length;i<n;i++)r[i].segment.ringOut=this;this.poly=null}return i(e,null,[{key:"factory",value:function(t){for(var r=[],i=0,n=t.length;i<n;i++){var a=t[i];if(a.isInResult()&&!a.ringOut){for(var o=null,s=a.leftSE,l=a.rightSE,h=[s],u=s.point,c=[];o=s,s=l,h.push(s),s.point!==u;)for(;;){var p=s.getAvailableLinkedEvents();if(0===p.length){var f=h[0].point,d=h[h.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(d.x,", ").concat(d.y,"]."))}if(1===p.length){l=p[0].otherSE;break}for(var g=null,m=0,_=c.length;m<_;m++)if(c[m].point===s.point){g=m;break}if(null===g){c.push({index:h.length,point:s.point});var y=s.getLeftmostComparator(o);l=p.sort(y)[0].otherSE;break}var v=c.splice(g)[0],b=h.splice(v.index);b.unshift(b[0].otherSE),r.push(new e(b.reverse()))}r.push(new e(h))}}return r}}]),i(e,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],r=1,i=this.events.length-1;r<i;r++){var n=this.events[r].point,a=this.events[r+1].point;0!==P(n,t,a)&&(e.push(n),t=n)}if(1===e.length)return null;var o=e[0],s=e[1];0===P(o,t,s)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,h=this.isExteriorRing()?0:e.length-1,u=this.isExteriorRing()?e.length:-1,c=[],p=h;p!=u;p+=l)c.push([e[p].x,e[p].y]);return c}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,r=this.events.length;e<r;e++){var i=this.events[e];B.compare(t,i)>0&&(t=i)}for(var n=t.segment.prevInResult(),a=n?n.prevInResult():null;;){if(!n)return null;if(!a)return n.ringOut;if(a.ringOut!==n.ringOut)return a.ringOut.enclosingRing()!==n.ringOut?n.ringOut:n.ringOut.enclosingRing();n=a.prevInResult(),a=n?n.prevInResult():null}}}]),e}(),A=function(){function e(r){t(this,e),this.exteriorRing=r,r.poly=this,this.interiorRings=[]}return i(e,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,r=this.interiorRings.length;e<r;e++){var i=this.interiorRings[e].getGeom();null!==i&&t.push(i)}return t}}]),e}(),N=function(){function e(r){t(this,e),this.rings=r,this.polys=this._composePolys(r)}return i(e,[{key:"getGeom",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++){var i=this.polys[e].getGeom();null!==i&&t.push(i)}return t}},{key:"_composePolys",value:function(t){for(var e=[],r=0,i=t.length;r<i;r++){var n=t[r];if(!n.poly)if(n.isExteriorRing())e.push(new A(n));else{var a=n.enclosingRing();a.poly||e.push(new A(a)),a.poly.addInterior(n)}}return e}}]),e}(),z=function(){function e(r){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:D.compare;t(this,e),this.queue=r,this.tree=new u(i),this.segments=[]}return i(e,[{key:"process",value:function(t){var e=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),r;var i=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!i)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var n=i,a=i,o=void 0,s=void 0;void 0===o;)null===(n=this.tree.prev(n))?o=null:void 0===n.key.consumedBy&&(o=n.key);for(;void 0===s;)null===(a=this.tree.next(a))?s=null:void 0===a.key.consumedBy&&(s=a.key);if(t.isLeft){var l=null;if(o){var h=o.getIntersection(e);if(null!==h&&(e.isAnEndpoint(h)||(l=h),!o.isAnEndpoint(h)))for(var u=this._splitSafely(o,h),c=0,p=u.length;c<p;c++)r.push(u[c])}var f=null;if(s){var d=s.getIntersection(e);if(null!==d&&(e.isAnEndpoint(d)||(f=d),!s.isAnEndpoint(d)))for(var g=this._splitSafely(s,d),m=0,_=g.length;m<_;m++)r.push(g[m])}if(null!==l||null!==f){var y=null;y=null===l?f:null===f||B.comparePoints(l,f)<=0?l:f,this.queue.remove(e.rightSE),r.push(e.rightSE);for(var v=e.split(y),b=0,L=v.length;b<L;b++)r.push(v[b])}r.length>0?(this.tree.remove(e),r.push(t)):(this.segments.push(e),e.prev=o)}else{if(o&&s){var k=o.getIntersection(s);if(null!==k){if(!o.isAnEndpoint(k))for(var M=this._splitSafely(o,k),w=0,x=M.length;w<x;w++)r.push(M[w]);if(!s.isAnEndpoint(k))for(var P=this._splitSafely(s,k),C=0,E=P.length;C<E;C++)r.push(P[C])}}this.tree.remove(e)}return r}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var r=t.rightSE;this.queue.remove(r);var i=t.split(e);return i.push(r),void 0===t.consumedBy&&this.tree.insert(t),i}}]),e}(),F=void 0!==e&&e.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,V=void 0!==e&&e.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,U=new(function(){function e(){t(this,e)}return i(e,[{key:"run",value:function(t,e,r){U.type=t,M.reset();for(var i=[new I(e,!0)],n=0,a=r.length;n<a;n++)i.push(new I(r[n],!1));if(U.numMultiPolys=i.length,"difference"===U.type)for(var o=i[0],s=1;s<i.length;)null!==_(i[s].bbox,o.bbox)?s++:i.splice(s,1);if("intersection"===U.type)for(var l=0,h=i.length;l<h;l++)for(var c=i[l],p=l+1,f=i.length;p<f;p++)if(null===_(c.bbox,i[p].bbox))return[];for(var d=new u(B.compare),g=0,m=i.length;g<m;g++)for(var y=i[g].getSweepEvents(),v=0,b=y.length;v<b;v++)if(d.insert(y[v]),d.size>F)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var L=new z(d),k=d.size,w=d.pop();w;){var x=w.key;if(d.size===k){var P=x.segment;throw new Error("Unable to pop() ".concat(x.isLeft?"left":"right"," SweepEvent ")+"[".concat(x.point.x,", ").concat(x.point.y,"] from segment #").concat(P.id," ")+"[".concat(P.leftSE.point.x,", ").concat(P.leftSE.point.y,"] -> ")+"[".concat(P.rightSE.point.x,", ").concat(P.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(d.size>F)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(L.segments.length>V)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var C=L.process(x),E=0,S=C.length;E<S;E++){var O=C[E];void 0===O.consumedBy&&d.insert(O)}k=d.size,w=d.pop()}M.reset();var R=G.factory(L.segments);return new N(R).getGeom()}}]),e}());return{union:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return U.run("union",t,r)},intersection:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return U.run("intersection",t,r)},xor:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return U.run("xor",t,r)},difference:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];return U.run("difference",t,r)}}}()}).call(this,r(152))},function(t,e,r){var i=r(17)(r(4),"Map");t.exports=i},function(t,e,r){(function(e){var r="object"==typeof e&&e&&e.Object===Object&&e;t.exports=r}).call(this,r(83))},function(t,e,r){var i=r(90),n=r(97),a=r(99),o=r(100),s=r(101);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype["delete"]=n,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,r){var i=r(20),n=r(13);t.exports=function(t,e,r){(void 0!==r&&!n(t[e],r)||void 0===r&&!(e in t))&&i(t,e,r)}},function(t,e,r){var i=r(17),n=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();t.exports=n},function(t,e,r){var i=r(112)(Object.getPrototypeOf,Object);t.exports=i},function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,e,r){(function(t){var i=r(4),n=r(115),a=e&&!e.nodeType&&e,o=a&&"object"==typeof t&&t&&!t.nodeType&&t,s=o&&o.exports===a?i.Buffer:void 0,l=(s?s.isBuffer:void 0)||n;t.exports=l}).call(this,r(21)(t))},function(t,e,r){var i=r(117),n=r(118),a=r(119),o=a&&a.isTypedArray,s=o?n(o):i;t.exports=s},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,r){var i=r(123),n=r(125),a=r(23);t.exports=function(t){return a(t)?i(t,!0):n(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,r){var i=r(6),n=r(137),a=r(138),o=r(141);t.exports=function(t,e){return i(t)?t:n(t,e)?[t]:a(o(t))}},function(t,e,r){var i=r(26);t.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(16);e["default"]=function(t){var e=[1/0,1/0,-1/0,-1/0];return i.coordEach(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}},function(t){t.exports=JSON.parse('{"name":"@geoman-io/leaflet-geoman-free","version":"2.11.2","description":"A Leaflet Plugin For Editing Geometry Layers in Leaflet 1.0","keywords":["leaflet","geoman","polygon management","geometry editing","map data","map overlay","polygon","geojson","leaflet-draw","data-field-geojson","ui-leaflet-draw"],"files":["dist"],"main":"dist/leaflet-geoman.min.js","types":"dist/leaflet-geoman.d.ts","dependencies":{"@turf/boolean-contains":"6.3.0","@turf/kinks":"6.3.0","@turf/line-intersect":"6.3.0","@turf/line-split":"6.3.0","lodash":"4.17.21","polygon-clipping":"0.15.3"},"devDependencies":{"@babel/core":"7.14.0","@babel/preset-env":"7.14.1","@types/leaflet":"^1.7.0","babel-loader":"8.2.2","copy-webpack-plugin":"8.1.1","css-loader":"5.2.4","cypress":"6.9.1","cypress-wait-until":"1.7.1","eslint":"7.26.0","eslint-config-airbnb-base":"14.2.1","eslint-config-prettier":"8.3.0","eslint-plugin-cypress":"2.11.3","eslint-plugin-import":"2.22.1","file-loader":"6.2.0","leaflet":"1.7.1","mini-css-extract-plugin":"1.6.0","prettier":"2.2.1","prosthetic-hand":"1.3.1","terser-webpack-plugin":"^5.1.2","url-loader":"4.1.1","webpack":"5.36.2","webpack-cli":"4.7.0"},"peerDependencies":{"leaflet":"^1.2.0"},"scripts":{"start":"npm run dev","dev":"./node_modules/.bin/webpack --config=webpack.dev.js","test":"./node_modules/.bin/cypress run","cypress":"./node_modules/.bin/cypress open","build":"./node_modules/.bin/webpack --config=webpack.build.js","prepare":"npm run build","eslint-check":"eslint --print-config . | eslint-config-prettier-check","eslint":"eslint src/ --fix","prettier":"prettier --write \'{src,cypress}/**/*.{js,css}\'","lint":"npm run eslint && npm run prettier"},"repository":{"type":"git","url":"git://github.com/geoman-io/leaflet-geoman.git"},"author":{"name":"Sumit Kumar","email":"sumit@geoman.io","url":"http://geoman.io/leaflet-geoman"},"license":"MIT","bugs":{"url":"https://github.com/geoman-io/leaflet-geoman/issues"},"homepage":"https://geoman.io/leaflet-geoman","prettier":{"trailingComma":"es5","tabWidth":2,"semi":true,"singleQuote":true}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Click to place marker","firstVertex":"Click to place first vertex","continueLine":"Click to continue drawing","finishLine":"Click any existing marker to finish","finishPoly":"Click first marker to finish","finishRect":"Click to finish","startCircle":"Click to place circle center","finishCircle":"Click to finish circle","placeCircleMarker":"Click to place circle marker"},"actions":{"finish":"Finish","cancel":"Cancel","removeLastVertex":"Remove Last Vertex"},"buttonTitles":{"drawMarkerButton":"Draw Marker","drawPolyButton":"Draw Polygons","drawLineButton":"Draw Polyline","drawCircleButton":"Draw Circle","drawRectButton":"Draw Rectangle","editButton":"Edit Layers","dragButton":"Drag Layers","cutButton":"Cut Layers","deleteButton":"Remove Layers","drawCircleMarkerButton":"Draw Circle Marker","snappingButton":"Snap dragged marker to other layers and vertices","pinningButton":"Pin shared vertices together","rotateButton":"Rotate Layers"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Platziere den Marker mit Klick","firstVertex":"Platziere den ersten Marker mit Klick","continueLine":"Klicke, um weiter zu zeichnen","finishLine":"Beende mit Klick auf existierenden Marker","finishPoly":"Beende mit Klick auf ersten Marker","finishRect":"Beende mit Klick","startCircle":"Platziere das Kreiszentrum mit Klick","finishCircle":"Beende den Kreis mit Klick","placeCircleMarker":"Platziere den Kreismarker mit Klick"},"actions":{"finish":"Beenden","cancel":"Abbrechen","removeLastVertex":"Letzten Vertex löschen"},"buttonTitles":{"drawMarkerButton":"Marker zeichnen","drawPolyButton":"Polygon zeichnen","drawLineButton":"Polyline zeichnen","drawCircleButton":"Kreis zeichnen","drawRectButton":"Rechteck zeichnen","editButton":"Layer editieren","dragButton":"Layer bewegen","cutButton":"Layer schneiden","deleteButton":"Layer löschen","drawCircleMarkerButton":"Kreismarker zeichnen","snappingButton":"Bewegter Layer an andere Layer oder Vertexe einhacken","pinningButton":"Vertexe an der gleichen Position verknüpfen","rotateButton":"Layer drehen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clicca per posizionare un Marker","firstVertex":"Clicca per posizionare il primo vertice","continueLine":"Clicca per continuare a disegnare","finishLine":"Clicca qualsiasi marker esistente per terminare","finishPoly":"Clicca il primo marker per terminare","finishRect":"Clicca per terminare","startCircle":"Clicca per posizionare il punto centrale del cerchio","finishCircle":"Clicca per terminare il cerchio","placeCircleMarker":"Clicca per posizionare un Marker del cherchio"},"actions":{"finish":"Termina","cancel":"Annulla","removeLastVertex":"Rimuovi l\'ultimo vertice"},"buttonTitles":{"drawMarkerButton":"Disegna Marker","drawPolyButton":"Disegna Poligoni","drawLineButton":"Disegna Polilinea","drawCircleButton":"Disegna Cerchio","drawRectButton":"Disegna Rettangolo","editButton":"Modifica Livelli","dragButton":"Sposta Livelli","cutButton":"Ritaglia Livelli","deleteButton":"Elimina Livelli","drawCircleMarkerButton":"Disegna Marker del Cerchio","snappingButton":"Snap ha trascinato il pennarello su altri strati e vertici","pinningButton":"Pin condiviso vertici insieme"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik untuk menempatkan marker","firstVertex":"Klik untuk menempatkan vertex pertama","continueLine":"Klik untuk meneruskan digitasi","finishLine":"Klik pada sembarang marker yang ada untuk mengakhiri","finishPoly":"Klik marker pertama untuk mengakhiri","finishRect":"Klik untuk mengakhiri","startCircle":"Klik untuk menempatkan titik pusat lingkaran","finishCircle":"Klik untuk mengakhiri lingkaran","placeCircleMarker":"Klik untuk menempatkan penanda lingkarann"},"actions":{"finish":"Selesai","cancel":"Batal","removeLastVertex":"Hilangkan Vertex Terakhir"},"buttonTitles":{"drawMarkerButton":"Digitasi Marker","drawPolyButton":"Digitasi Polygon","drawLineButton":"Digitasi Polyline","drawCircleButton":"Digitasi Lingkaran","drawRectButton":"Digitasi Segi Empat","editButton":"Edit Layer","dragButton":"Geser Layer","cutButton":"Potong Layer","deleteButton":"Hilangkan Layer","drawCircleMarkerButton":"Digitasi Penanda Lingkaran","snappingButton":"Jepretkan penanda yang ditarik ke lapisan dan simpul lain","pinningButton":"Sematkan simpul bersama bersama"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Adaugă un punct","firstVertex":"Apasă aici pentru a adăuga primul Vertex","continueLine":"Apasă aici pentru a continua desenul","finishLine":"Apasă pe orice obiect pentru a finisa desenul","finishPoly":"Apasă pe primul obiect pentru a finisa","finishRect":"Apasă pentru a finisa","startCircle":"Apasă pentru a desena un cerc","finishCircle":"Apasă pentru a finisa un cerc","placeCircleMarker":"Adaugă un punct"},"actions":{"finish":"Termină","cancel":"Anulează","removeLastVertex":"Șterge ultimul Vertex"},"buttonTitles":{"drawMarkerButton":"Adaugă o bulină","drawPolyButton":"Desenează un poligon","drawLineButton":"Desenează o linie","drawCircleButton":"Desenează un cerc","drawRectButton":"Desenează un dreptunghi","editButton":"Editează straturile","dragButton":"Mută straturile","cutButton":"Taie straturile","deleteButton":"Șterge straturile","drawCircleMarkerButton":"Desenează marcatorul cercului","snappingButton":"Fixați marcatorul glisat pe alte straturi și vârfuri","pinningButton":"Fixați vârfurile partajate împreună"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Нажмите, чтобы нанести маркер","firstVertex":"Нажмите, чтобы нанести первый объект","continueLine":"Нажмите, чтобы продолжить рисование","finishLine":"Нажмите любой существующий маркер для завершения","finishPoly":"Выберите первую точку, чтобы закончить","finishRect":"Нажмите, чтобы закончить","startCircle":"Нажмите, чтобы добавить центр круга","finishCircle":"Нажмите, чтобы задать радиус","placeCircleMarker":"Нажмите, чтобы нанести круговой маркер"},"actions":{"finish":"Завершить","cancel":"Отменить","removeLastVertex":"Отменить последнее действие"},"buttonTitles":{"drawMarkerButton":"Добавить маркер","drawPolyButton":"Рисовать полигон","drawLineButton":"Рисовать кривую","drawCircleButton":"Рисовать круг","drawRectButton":"Рисовать прямоугольник","editButton":"Редактировать слой","dragButton":"Перенести слой","cutButton":"Вырезать слой","deleteButton":"Удалить слой","drawCircleMarkerButton":"Добавить круговой маркер","snappingButton":"Привязать перетаскиваемый маркер к другим слоям и вершинам","pinningButton":"Связать общие точки вместе"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Presiona para colocar un marcador","firstVertex":"Presiona para colocar el primer vértice","continueLine":"Presiona para continuar dibujando","finishLine":"Presiona cualquier marcador existente para finalizar","finishPoly":"Presiona el primer marcador para finalizar","finishRect":"Presiona para finalizar","startCircle":"Presiona para colocar el centro del circulo","finishCircle":"Presiona para finalizar el circulo","placeCircleMarker":"Presiona para colocar un marcador de circulo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover ultimo vértice"},"buttonTitles":{"drawMarkerButton":"Dibujar Marcador","drawPolyButton":"Dibujar Polígono","drawLineButton":"Dibujar Línea","drawCircleButton":"Dibujar Circulo","drawRectButton":"Dibujar Rectángulo","editButton":"Editar Capas","dragButton":"Arrastrar Capas","cutButton":"Cortar Capas","deleteButton":"Remover Capas","drawCircleMarkerButton":"Dibujar Marcador de Circulo","snappingButton":"El marcador de Snap arrastrado a otras capas y vértices","pinningButton":"Fijar juntos los vértices compartidos"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik om een marker te plaatsen","firstVertex":"Klik om het eerste punt te plaatsen","continueLine":"Klik om te blijven tekenen","finishLine":"Klik op een bestaand punt om te beëindigen","finishPoly":"Klik op het eerst punt om te beëindigen","finishRect":"Klik om te beëindigen","startCircle":"Klik om het middelpunt te plaatsen","finishCircle":"Klik om de cirkel te beëindigen","placeCircleMarker":"Klik om een marker te plaatsen"},"actions":{"finish":"Bewaar","cancel":"Annuleer","removeLastVertex":"Verwijder laatste punt"},"buttonTitles":{"drawMarkerButton":"Plaats Marker","drawPolyButton":"Teken een vlak","drawLineButton":"Teken een lijn","drawCircleButton":"Teken een cirkel","drawRectButton":"Teken een vierkant","editButton":"Bewerk","dragButton":"Verplaats","cutButton":"Knip","deleteButton":"Verwijder","drawCircleMarkerButton":"Plaats Marker","snappingButton":"Snap gesleepte marker naar andere lagen en hoekpunten","pinningButton":"Speld gedeelde hoekpunten samen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Cliquez pour placer un marqueur","firstVertex":"Cliquez pour placer le premier sommet","continueLine":"Cliquez pour continuer à dessiner","finishLine":"Cliquez sur n\'importe quel marqueur pour terminer","finishPoly":"Cliquez sur le premier marqueur pour terminer","finishRect":"Cliquez pour terminer","startCircle":"Cliquez pour placer le centre du cercle","finishCircle":"Cliquez pour finir le cercle","placeCircleMarker":"Cliquez pour placer le marqueur circulaire"},"actions":{"finish":"Terminer","cancel":"Annuler","removeLastVertex":"Retirer le dernier sommet"},"buttonTitles":{"drawMarkerButton":"Placer des marqueurs","drawPolyButton":"Dessiner des polygones","drawLineButton":"Dessiner des polylignes","drawCircleButton":"Dessiner un cercle","drawRectButton":"Dessiner un rectangle","editButton":"Éditer des calques","dragButton":"Déplacer des calques","cutButton":"Couper des calques","deleteButton":"Supprimer des calques","drawCircleMarkerButton":"Dessiner un marqueur circulaire","snappingButton":"Glisser le marqueur vers d\'autres couches et sommets","pinningButton":"Épingler ensemble les sommets partagés"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"单击放置标记","firstVertex":"单击放置首个顶点","continueLine":"单击继续绘制","finishLine":"单击任何存在的标记以完成","finishPoly":"单击第一个标记以完成","finishRect":"单击完成","startCircle":"单击放置圆心","finishCircle":"单击完成圆形","placeCircleMarker":"点击放置圆形标记"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最后的顶点"},"buttonTitles":{"drawMarkerButton":"绘制标记","drawPolyButton":"绘制多边形","drawLineButton":"绘制线段","drawCircleButton":"绘制圆形","drawRectButton":"绘制长方形","editButton":"编辑图层","dragButton":"拖拽图层","cutButton":"剪切图层","deleteButton":"删除图层","drawCircleMarkerButton":"画圆圈标记","snappingButton":"将拖动的标记捕捉到其他图层和顶点","pinningButton":"将共享顶点固定在一起"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"單擊放置標記","firstVertex":"單擊放置第一個頂點","continueLine":"單擊繼續繪製","finishLine":"單擊任何存在的標記以完成","finishPoly":"單擊第一個標記以完成","finishRect":"單擊完成","startCircle":"單擊放置圓心","finishCircle":"單擊完成圓形","placeCircleMarker":"點擊放置圓形標記"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最後一個頂點"},"buttonTitles":{"drawMarkerButton":"放置標記","drawPolyButton":"繪製多邊形","drawLineButton":"繪製線段","drawCircleButton":"繪製圓形","drawRectButton":"繪製方形","editButton":"編輯圖形","dragButton":"移動圖形","cutButton":"裁切圖形","deleteButton":"刪除圖形","drawCircleMarkerButton":"畫圓圈標記","snappingButton":"將拖動的標記對齊到其他圖層和頂點","pinningButton":"將共享頂點固定在一起"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clique para posicionar o marcador","firstVertex":"Clique para posicionar o primeiro vértice","continueLine":"Clique para continuar desenhando","finishLine":"Clique em qualquer marcador existente para finalizar","finishPoly":"Clique no primeiro ponto para fechar o polígono","finishRect":"Clique para finalizar","startCircle":"Clique para posicionar o centro do círculo","finishCircle":"Clique para fechar o círculo","placeCircleMarker":"Clique para posicionar o marcador circular"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover último vértice"},"buttonTitles":{"drawMarkerButton":"Desenhar um marcador","drawPolyButton":"Desenhar um polígono","drawLineButton":"Desenhar uma polilinha","drawCircleButton":"Desenhar um círculo","drawRectButton":"Desenhar um retângulo","editButton":"Editar camada(s)","dragButton":"Mover camada(s)","cutButton":"Recortar camada(s)","deleteButton":"Remover camada(s)","drawCircleMarkerButton":"Marcador de círculos de desenho","snappingButton":"Marcador arrastado para outras camadas e vértices","pinningButton":"Vértices compartilhados de pinos juntos"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknij, aby ustawić znacznik","firstVertex":"Kliknij, aby ustawić pierwszy punkt","continueLine":"Kliknij, aby kontynuować rysowanie","finishLine":"Kliknij dowolny punkt, aby zakończyć","finishPoly":"Kliknij pierwszy punkt, aby zakończyć","finishRect":"Kliknij, aby zakończyć","startCircle":"Kliknij, aby ustawić środek koła","finishCircle":"Kliknij, aby zakończyć rysowanie koła","placeCircleMarker":"Kliknij, aby ustawić okrągły znacznik"},"actions":{"finish":"Zakończ","cancel":"Anuluj","removeLastVertex":"Usuń ostatni punkt"},"buttonTitles":{"drawMarkerButton":"Narysuj znacznik","drawPolyButton":"Narysuj wielokąt","drawLineButton":"Narysuj ścieżkę","drawCircleButton":"Narysuj koło","drawRectButton":"Narysuj prostokąt","editButton":"Edytuj","dragButton":"Przesuń","cutButton":"Wytnij","deleteButton":"Usuń","drawCircleMarkerButton":"Narysuj okrągły znacznik","snappingButton":"Snap przeciągnięty marker na inne warstwy i wierzchołki","pinningButton":"Sworzeń wspólne wierzchołki razem"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klicka för att placera markör","firstVertex":"Klicka för att placera första hörnet","continueLine":"Klicka för att fortsätta rita","finishLine":"Klicka på en existerande punkt för att slutföra","finishPoly":"Klicka på den första punkten för att slutföra","finishRect":"Klicka för att slutföra","startCircle":"Klicka för att placera cirkelns centrum","finishCircle":"Klicka för att slutföra cirkeln","placeCircleMarker":"Klicka för att placera cirkelmarkör"},"actions":{"finish":"Slutför","cancel":"Avbryt","removeLastVertex":"Ta bort sista hörnet"},"buttonTitles":{"drawMarkerButton":"Rita Markör","drawPolyButton":"Rita Polygoner","drawLineButton":"Rita Linje","drawCircleButton":"Rita Cirkel","drawRectButton":"Rita Rektangel","editButton":"Redigera Lager","dragButton":"Dra Lager","cutButton":"Klipp i Lager","deleteButton":"Ta bort Lager","drawCircleMarkerButton":"Rita Cirkelmarkör","snappingButton":"Snäpp dra markören till andra lager och hörn","pinningButton":"Fäst delade hörn tillsammans"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Κάντε κλικ για να τοποθετήσετε Δείκτη","firstVertex":"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο","continueLine":"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε","finishLine":"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί","finishPoly":"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε","finishRect":"Κάντε κλικ για να τελειώσετε","startCircle":"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου","finishCircle":"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο","placeCircleMarker":"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},"actions":{"finish":"Τέλος","cancel":"Ακύρωση","removeLastVertex":"Κατάργηση τελευταίου σημείου"},"buttonTitles":{"drawMarkerButton":"Σχεδίαση Δείκτη","drawPolyButton":"Σχεδίαση Πολυγώνου","drawLineButton":"Σχεδίαση Γραμμής","drawCircleButton":"Σχεδίαση Κύκλου","drawRectButton":"Σχεδίαση Ορθογωνίου","editButton":"Επεξεργασία Επιπέδων","dragButton":"Μεταφορά Επιπέδων","cutButton":"Αποκοπή Επιπέδων","deleteButton":"Κατάργηση Επιπέδων","drawCircleMarkerButton":"Σχεδίαση Κυκλικού Δείκτη","snappingButton":"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές","pinningButton":"Περικοπή κοινών κορυφών μαζί"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kattintson a jelölő elhelyezéséhez","firstVertex":"Kattintson az első pont elhelyezéséhez","continueLine":"Kattintson a következő pont elhelyezéséhez","finishLine":"A befejezéshez kattintson egy meglévő pontra","finishPoly":"A befejezéshez kattintson az első pontra","finishRect":"Kattintson a befejezéshez","startCircle":"Kattintson a kör középpontjának elhelyezéséhez","finishCircle":"Kattintson a kör befejezéséhez","placeCircleMarker":"Kattintson a körjelölő elhelyezéséhez"},"actions":{"finish":"Befejezés","cancel":"Mégse","removeLastVertex":"Utolsó pont eltávolítása"},"buttonTitles":{"drawMarkerButton":"Jelölő rajzolása","drawPolyButton":"Poligon rajzolása","drawLineButton":"Vonal rajzolása","drawCircleButton":"Kör rajzolása","drawRectButton":"Négyzet rajzolása","editButton":"Elemek szerkesztése","dragButton":"Elemek mozgatása","cutButton":"Elemek vágása","deleteButton":"Elemek törlése","drawCircleMarkerButton":"Kör jelölő rajzolása","snappingButton":"Kapcsolja a jelöltőt másik elemhez vagy ponthoz","pinningButton":"Közös pontok összekötése"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Tryk for at placere en markør","firstVertex":"Tryk for at placere det første punkt","continueLine":"Tryk for at fortsætte linjen","finishLine":"Tryk på et eksisterende punkt for at afslutte","finishPoly":"Tryk på det første punkt for at afslutte","finishRect":"Tryk for at afslutte","startCircle":"Tryk for at placere cirklens center","finishCircle":"Tryk for at afslutte cirklen","placeCircleMarker":"Tryk for at placere en cirkelmarkør"},"actions":{"finish":"Afslut","cancel":"Afbryd","removeLastVertex":"Fjern sidste punkt"},"buttonTitles":{"drawMarkerButton":"Placer markør","drawPolyButton":"Tegn polygon","drawLineButton":"Tegn linje","drawCircleButton":"Tegn cirkel","drawRectButton":"Tegn firkant","editButton":"Rediger","dragButton":"Træk","cutButton":"Klip","deleteButton":"Fjern","drawCircleMarkerButton":"Tegn cirkelmarkør","snappingButton":"Fastgør trukket markør til andre elementer","pinningButton":"Sammenlæg delte elementer"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klikk for å plassere punkt","firstVertex":"Klikk for å plassere første punkt","continueLine":"Klikk for å tegne videre","finishLine":"Klikk på et eksisterende punkt for å fullføre","finishPoly":"Klikk første punkt for å fullføre","finishRect":"Klikk for å fullføre","startCircle":"Klikk for å sette sirkel midtpunkt","finishCircle":"Klikk for å fullføre sirkel","placeCircleMarker":"Klikk for å plassere sirkel"},"actions":{"finish":"Fullfør","cancel":"Kanseller","removeLastVertex":"Fjern forrige punkt"},"buttonTitles":{"drawMarkerButton":"Tegn Punkt","drawPolyButton":"Tegn Flate","drawLineButton":"Tegn Linje","drawCircleButton":"Tegn Sirkel","drawRectButton":"Tegn rektangel","editButton":"Rediger Objekter","dragButton":"Dra Objekter","cutButton":"Kutt Objekter","deleteButton":"Fjern Objekter","drawCircleMarkerButton":"Tegn sirkel-punkt","snappingButton":"Fest dratt punkt til andre objekter og punkt","pinningButton":"Pin delte punkt sammen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"کلیک برای جانمایی نشان","firstVertex":"کلیک برای رسم اولین رأس","continueLine":"کلیک برای ادامه رسم","finishLine":"کلیک روی هر نشان موجود برای پایان","finishPoly":"کلیک روی اولین نشان برای پایان","finishRect":"کلیک برای پایان","startCircle":"کلیک برای رسم مرکز دایره","finishCircle":"کلیک برای پایان رسم دایره","placeCircleMarker":"کلیک برای رسم نشان دایره"},"actions":{"finish":"پایان","cancel":"لفو","removeLastVertex":"حذف آخرین رأس"},"buttonTitles":{"drawMarkerButton":"درج نشان","drawPolyButton":"رسم چندضلعی","drawLineButton":"رسم خط","drawCircleButton":"رسم دایره","drawRectButton":"رسم چهارضلعی","editButton":"ویرایش لایه‌ها","dragButton":"جابجایی لایه‌ها","cutButton":"برش لایه‌ها","deleteButton":"حذف لایه‌ها","drawCircleMarkerButton":"رسم نشان دایره","snappingButton":"نشانگر را به لایه‌ها و رئوس دیگر بکشید","pinningButton":"رئوس مشترک را با هم پین کنید"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Натисніть, щоб нанести маркер","firstVertex":"Натисніть, щоб нанести першу вершину","continueLine":"Натисніть, щоб продовжити малювати","finishLine":"Натисніть будь-який існуючий маркер для завершення","finishPoly":"Виберіть перший маркер, щоб завершити","finishRect":"Натисніть, щоб завершити","startCircle":"Натисніть, щоб додати центр кола","finishCircle":"Натисніть, щоб завершити коло","placeCircleMarker":"Натисніть, щоб нанести круговий маркер"},"actions":{"finish":"Завершити","cancel":"Відмінити","removeLastVertex":"Видалити попередню вершину"},"buttonTitles":{"drawMarkerButton":"Малювати маркер","drawPolyButton":"Малювати полігон","drawLineButton":"Малювати криву","drawCircleButton":"Малювати коло","drawRectButton":"Малювати прямокутник","editButton":"Редагувати шари","dragButton":"Перенести шари","cutButton":"Вирізати шари","deleteButton":"Видалити шари","drawCircleMarkerButton":"Малювати круговий маркер","snappingButton":"Прив’язати перетягнутий маркер до інших шарів та вершин","pinningButton":"Зв\'язати спільні вершини разом"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"İşaretçi yerleştirmek için tıklayın","firstVertex":"İlk tepe noktasını yerleştirmek için tıklayın","continueLine":"Çizime devam etmek için tıklayın","finishLine":"Bitirmek için mevcut herhangi bir işaretçiyi tıklayın","finishPoly":"Bitirmek için ilk işaretçiyi tıklayın","finishRect":"Bitirmek için tıklayın","startCircle":"Daire merkezine yerleştirmek için tıklayın","finishCircle":"Daireyi bitirmek için tıklayın","placeCircleMarker":"Daire işaretçisi yerleştirmek için tıklayın"},"actions":{"finish":"Bitir","cancel":"İptal","removeLastVertex":"Son köşeyi kaldır"},"buttonTitles":{"drawMarkerButton":"Çizim İşaretçisi","drawPolyButton":"Çokgenler çiz","drawLineButton":"Çoklu çizgi çiz","drawCircleButton":"Çember çiz","drawRectButton":"Dikdörtgen çiz","editButton":"Katmanları düzenle","dragButton":"Katmanları sürükle","cutButton":"Katmanları kes","deleteButton":"Katmanları kaldır","drawCircleMarkerButton":"Daire işaretçisi çiz","snappingButton":"Sürüklenen işaretçiyi diğer katmanlara ve köşelere yapıştır","pinningButton":"Paylaşılan köşeleri birbirine sabitle"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknutím vytvoříte značku","firstVertex":"Kliknutím vytvoříte první objekt","continueLine":"Kliknutím pokračujte v kreslení","finishLine":"Kliknutí na libovolnou existující značku pro dokončení","finishPoly":"Vyberte první bod pro dokončení","finishRect":"Klikněte pro dokončení","startCircle":"Kliknutím přidejte střed kruhu","finishCircle":"Нажмите, чтобы задать радиус","placeCircleMarker":"Kliknutím nastavte poloměr"},"actions":{"finish":"Dokončit","cancel":"Zrušit","removeLastVertex":"Zrušit poslední akci"},"buttonTitles":{"drawMarkerButton":"Přidat značku","drawPolyButton":"Nakreslit polygon","drawLineButton":"Nakreslit křivku","drawCircleButton":"Nakreslit kruh","drawRectButton":"Nakreslit obdélník","editButton":"Upravit vrstvu","dragButton":"Přeneste vrstvu","cutButton":"Vyjmout vrstvu","deleteButton":"Smazat vrstvu","drawCircleMarkerButton":"Přidat kruhovou značku","snappingButton":"Navázat tažnou značku k dalším vrstvám a vrcholům","pinningButton":"Spojit společné body dohromady"}}')},function(t,e,r){var i=r(144),n=r(145);t.exports=function(t,e){return null!=t&&n(t,e,i)}},function(t,e,r){"use strict";var i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var n=i(r(42)),a=i(r(150)),o=i(r(151)),s=r(10);function l(t,e){var r,i=!1;for(r=0;r<t.coordinates.length;r++)if(m(t.coordinates[r],e.coordinates)){i=!0;break}return i}function h(t,e){for(var r=0,i=e.coordinates;r<i.length;r++){for(var n=i[r],a=!1,o=0,s=t.coordinates;o<s.length;o++)if(m(n,s[o])){a=!0;break}if(!a)return!1}return!0}function u(t,e){for(var r=!1,i=0,n=e.coordinates;i<n.length;i++){var a=n[i];if(o["default"](a,t,{ignoreEndVertices:!0})&&(r=!0),!o["default"](a,t))return!1}return!!r}function c(t,e){for(var r=0,i=e.coordinates;r<i.length;r++){var n=i[r];if(!a["default"](n,t,{ignoreBoundary:!0}))return!1}return!0}function p(t,e){for(var r=!1,i=0,n=e.coordinates;i<n.length;i++){var a=n[i];if(o["default"]({type:"Point",coordinates:a},t,{ignoreEndVertices:!0})&&(r=!0),!o["default"]({type:"Point",coordinates:a},t,{ignoreEndVertices:!1}))return!1}return r}function f(t,e){var r=!1,i=0;if(!g(n["default"](t),n["default"](e)))return!1;for(;i<e.coordinates.length-1;i++){var o=_(e.coordinates[i],e.coordinates[i+1]);if(a["default"]({type:"Point",coordinates:o},t,{ignoreBoundary:!0})){r=!0;break}}return r}function d(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!g(n["default"](t),n["default"](e)))return!1;for(var r=0,i=s.getGeom(e).coordinates;r<i.length;r++)for(var o=0,l=i[r];o<l.length;o++){var h=l[o];if(!a["default"](h,t))return!1}return!0}function g(t,e){return!(t[0]>e[0])&&!(t[2]<e[2])&&!(t[1]>e[1])&&!(t[3]<e[3])}function m(t,e){return t[0]===e[0]&&t[1]===e[1]}function _(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}e["default"]=function(t,e){var r=s.getGeom(t),i=s.getGeom(e),n=s.getType(t),g=s.getType(e),_=s.getCoords(t),y=s.getCoords(e);switch(n){case"Point":switch(g){case"Point":return m(_,y);default:throw new Error("feature2 "+g+" geometry not supported")}case"MultiPoint":switch(g){case"Point":return l(r,i);case"MultiPoint":return h(r,i);default:throw new Error("feature2 "+g+" geometry not supported")}case"LineString":switch(g){case"Point":return o["default"](i,r,{ignoreEndVertices:!0});case"LineString":return p(r,i);case"MultiPoint":return u(r,i);default:throw new Error("feature2 "+g+" geometry not supported")}case"Polygon":switch(g){case"Point":return a["default"](i,r,{ignoreBoundary:!0});case"LineString":return f(r,i);case"Polygon":return d(r,i);case"MultiPoint":return c(r,i);default:throw new Error("feature2 "+g+" geometry not supported")}default:throw new Error("feature1 "+n+" geometry not supported")}},e.isPointInMultiPoint=l,e.isMultiPointInMultiPoint=h,e.isMultiPointOnLine=u,e.isMultiPointInPoly=c,e.isLineOnLine=p,e.isLineInPoly=f,e.isPolyInPoly=d,e.doBBoxOverlap=g,e.compareCoords=m,e.getMidpoint=_},function(t,e,r){t.exports=r(155)},function(t,e){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,i=arguments[1],n=0;n<r;n++)if(t.call(i,e[n],n,e))return n;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,i=arguments[1],n=0;n<r;n++){var a=e[n];if(t.call(i,a,n,e))return a}},"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var r=arguments[e];if(null!=r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})})),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),i=r.length>>>0;if(0===i)return!1;for(var n,a,o=0|e,s=Math.max(o>=0?o:i-Math.abs(o),0);s<i;){if((n=r[s])===(a=t)||"number"==typeof n&&"number"==typeof a&&isNaN(n)&&isNaN(a))return!0;s++}return!1}})},function(t,e,r){var i=r(71),n=r(31),a=r(102),o=r(104),s=r(2),l=r(38),h=r(37);t.exports=function t(e,r,u,c,p){e!==r&&a(r,(function(a,l){if(p||(p=new i),s(a))o(e,r,l,u,t,c,p);else{var f=c?c(h(e,l),a,l+"",e,r,p):void 0;void 0===f&&(f=a),n(e,l,f)}}),l)}},function(t,e,r){var i=r(11),n=r(77),a=r(78),o=r(79),s=r(80),l=r(81);function h(t){var e=this.__data__=new i(t);this.size=e.size}h.prototype.clear=n,h.prototype["delete"]=a,h.prototype.get=o,h.prototype.has=s,h.prototype.set=l,t.exports=h},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,r){var i=r(12),n=Array.prototype.splice;t.exports=function(t){var e=this.__data__,r=i(e,t);return!(r<0)&&(r==e.length-1?e.pop():n.call(e,r,1),--this.size,!0)}},function(t,e,r){var i=r(12);t.exports=function(t){var e=this.__data__,r=i(e,t);return r<0?void 0:e[r][1]}},function(t,e,r){var i=r(12);t.exports=function(t){return i(this.__data__,t)>-1}},function(t,e,r){var i=r(12);t.exports=function(t,e){var r=this.__data__,n=i(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}},function(t,e,r){var i=r(11);t.exports=function(){this.__data__=new i,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,r=e["delete"](t);return this.size=e.size,r}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,r){var i=r(11),n=r(28),a=r(30);t.exports=function(t,e){var r=this.__data__;if(r instanceof i){var o=r.__data__;if(!n||o.length<199)return o.push([t,e]),this.size=++r.size,this;r=this.__data__=new a(o)}return r.set(t,e),this.size=r.size,this}},function(t,e,r){var i=r(18),n=r(86),a=r(2),o=r(88),s=/^\[object .+?Constructor\]$/,l=Function.prototype,h=Object.prototype,u=l.toString,c=h.hasOwnProperty,p=RegExp("^"+u.call(c).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!a(t)||n(t))&&(i(t)?p:s).test(o(t))}},function(t,e){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(i){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){var i=r(19),n=Object.prototype,a=n.hasOwnProperty,o=n.toString,s=i?i.toStringTag:void 0;t.exports=function(t){var e=a.call(t,s),r=t[s];try{t[s]=void 0;var i=!0}catch(l){}var n=o.call(t);return i&&(e?t[s]=r:delete t[s]),n}},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,r){var i,n=r(87),a=(i=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function(t){return!!a&&a in t}},function(t,e,r){var i=r(4)["__core-js_shared__"];t.exports=i},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(e){}try{return t+""}catch(e){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,r){var i=r(91),n=r(11),a=r(28);t.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||n),string:new i}}},function(t,e,r){var i=r(92),n=r(93),a=r(94),o=r(95),s=r(96);function l(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}l.prototype.clear=i,l.prototype["delete"]=n,l.prototype.get=a,l.prototype.has=o,l.prototype.set=s,t.exports=l},function(t,e,r){var i=r(14);t.exports=function(){this.__data__=i?i(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,r){var i=r(14),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(i){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return n.call(e,t)?e[t]:void 0}},function(t,e,r){var i=r(14),n=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:n.call(e,t)}},function(t,e,r){var i=r(14);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,r){var i=r(15);t.exports=function(t){var e=i(this,t)["delete"](t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,r){var i=r(15);t.exports=function(t){return i(this,t).get(t)}},function(t,e,r){var i=r(15);t.exports=function(t){return i(this,t).has(t)}},function(t,e,r){var i=r(15);t.exports=function(t,e){var r=i(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}},function(t,e,r){var i=r(103)();t.exports=i},function(t,e){t.exports=function(t){return function(e,r,i){for(var n=-1,a=Object(e),o=i(e),s=o.length;s--;){var l=o[t?s:++n];if(!1===r(a[l],l,a))break}return e}}},function(t,e,r){var i=r(31),n=r(105),a=r(106),o=r(109),s=r(110),l=r(22),h=r(6),u=r(114),c=r(35),p=r(18),f=r(2),d=r(116),g=r(36),m=r(37),_=r(120);t.exports=function(t,e,r,y,v,b,L){var k=m(t,r),M=m(e,r),w=L.get(M);if(w)i(t,r,w);else{var x=b?b(k,M,r+"",t,e,L):void 0,P=void 0===x;if(P){var C=h(M),E=!C&&c(M),S=!C&&!E&&g(M);x=M,C||E||S?h(k)?x=k:u(k)?x=o(k):E?(P=!1,x=n(M,!0)):S?(P=!1,x=a(M,!0)):x=[]:d(M)||l(M)?(x=k,l(k)?x=_(k):f(k)&&!p(k)||(x=s(M))):P=!1}P&&(L.set(M,x),v(x,M,y,b,L),L["delete"](M)),i(t,r,x)}}},function(t,e,r){(function(t){var i=r(4),n=e&&!e.nodeType&&e,a=n&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===n?i.Buffer:void 0,s=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var r=t.length,i=s?s(r):new t.constructor(r);return t.copy(i),i}}).call(this,r(21)(t))},function(t,e,r){var i=r(107);t.exports=function(t,e){var r=e?i(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}},function(t,e,r){var i=r(108);t.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},function(t,e,r){var i=r(4).Uint8Array;t.exports=i},function(t,e){t.exports=function(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e}},function(t,e,r){var i=r(111),n=r(33),a=r(34);t.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:i(n(t))}},function(t,e,r){var i=r(2),n=Object.create,a=function(){function t(){}return function(e){if(!i(e))return{};if(n)return n(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();t.exports=a},function(t,e){t.exports=function(t,e){return function(r){return t(e(r))}}},function(t,e,r){var i=r(9),n=r(5);t.exports=function(t){return n(t)&&"[object Arguments]"==i(t)}},function(t,e,r){var i=r(23),n=r(5);t.exports=function(t){return n(t)&&i(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,r){var i=r(9),n=r(33),a=r(5),o=Function.prototype,s=Object.prototype,l=o.toString,h=s.hasOwnProperty,u=l.call(Object);t.exports=function(t){if(!a(t)||"[object Object]"!=i(t))return!1;var e=n(t);if(null===e)return!0;var r=h.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==u}},function(t,e,r){var i=r(9),n=r(24),a=r(5),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,t.exports=function(t){return a(t)&&n(t.length)&&!!o[i(t)]}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,r){(function(t){var i=r(29),n=e&&!e.nodeType&&e,a=n&&"object"==typeof t&&t&&!t.nodeType&&t,o=a&&a.exports===n&&i.process,s=function(){try{var t=a&&a.require&&a.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(e){}}();t.exports=s}).call(this,r(21)(t))},function(t,e,r){var i=r(121),n=r(38);t.exports=function(t){return i(t,n(t))}},function(t,e,r){var i=r(122),n=r(20);t.exports=function(t,e,r,a){var o=!r;r||(r={});for(var s=-1,l=e.length;++s<l;){var h=e[s],u=a?a(r[h],t[h],h,r,t):void 0;void 0===u&&(u=t[h]),o?n(r,h,u):i(r,h,u)}return r}},function(t,e,r){var i=r(20),n=r(13),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){var o=t[e];a.call(t,e)&&n(o,r)&&(void 0!==r||e in t)||i(t,e,r)}},function(t,e,r){var i=r(124),n=r(22),a=r(6),o=r(35),s=r(25),l=r(36),h=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r=a(t),u=!r&&n(t),c=!r&&!u&&o(t),p=!r&&!u&&!c&&l(t),f=r||u||c||p,d=f?i(t.length,String):[],g=d.length;for(var m in t)!e&&!h.call(t,m)||f&&("length"==m||c&&("offset"==m||"parent"==m)||p&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g))||d.push(m);return d}},function(t,e){t.exports=function(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}},function(t,e,r){var i=r(2),n=r(34),a=r(126),o=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return a(t);var e=n(t),r=[];for(var s in t)("constructor"!=s||!e&&o.call(t,s))&&r.push(s);return r}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},function(t,e,r){var i=r(128),n=r(135);t.exports=function(t){return i((function(e,r){var i=-1,a=r.length,o=a>1?r[a-1]:void 0,s=a>2?r[2]:void 0;for(o=t.length>3&&"function"==typeof o?(a--,o):void 0,s&&n(r[0],r[1],s)&&(o=a<3?void 0:o,a=1),e=Object(e);++i<a;){var l=r[i];l&&t(e,l,i,o)}return e}))}},function(t,e,r){var i=r(39),n=r(129),a=r(131);t.exports=function(t,e){return a(n(t,e,i),t+"")}},function(t,e,r){var i=r(130),n=Math.max;t.exports=function(t,e,r){return e=n(void 0===e?t.length-1:e,0),function(){for(var a=arguments,o=-1,s=n(a.length-e,0),l=Array(s);++o<s;)l[o]=a[e+o];o=-1;for(var h=Array(e+1);++o<e;)h[o]=a[o];return h[e]=r(l),i(t,this,h)}}},function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},function(t,e,r){var i=r(132),n=r(134)(i);t.exports=n},function(t,e,r){var i=r(133),n=r(32),a=r(39),o=n?function(t,e){return n(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;t.exports=o},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var r=Date.now;t.exports=function(t){var e=0,i=0;return function(){var n=r(),a=16-(n-i);if(i=n,a>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,r){var i=r(13),n=r(23),a=r(25),o=r(2);t.exports=function(t,e,r){if(!o(r))return!1;var s=typeof e;return!!("number"==s?n(r)&&a(e,r.length):"string"==s&&e in r)&&i(r[e],t)}},function(t,e,r){var i=r(40),n=r(41);t.exports=function(t,e){for(var r=0,a=(e=i(e,t)).length;null!=t&&r<a;)t=t[n(e[r++])];return r&&r==a?t:void 0}},function(t,e,r){var i=r(6),n=r(26),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;t.exports=function(t,e){if(i(t))return!1;var r=typeof t;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!n(t))||o.test(t)||!a.test(t)||null!=e&&t in Object(e)}},function(t,e,r){var i=r(139),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,a=/\\(\\)?/g,o=i((function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(n,(function(t,r,i,n){e.push(i?n.replace(a,"$1"):r||t)})),e}));t.exports=o},function(t,e,r){var i=r(140);t.exports=function(t){var e=i(t,(function(t){return 500===r.size&&r.clear(),t})),r=e.cache;return e}},function(t,e,r){var i=r(30);function n(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError("Expected a function");var r=function(){var i=arguments,n=e?e.apply(this,i):i[0],a=r.cache;if(a.has(n))return a.get(n);var o=t.apply(this,i);return r.cache=a.set(n,o)||a,o};return r.cache=new(n.Cache||i),r}n.Cache=i,t.exports=n},function(t,e,r){var i=r(142);t.exports=function(t){return null==t?"":i(t)}},function(t,e,r){var i=r(19),n=r(143),a=r(6),o=r(26),s=i?i.prototype:void 0,l=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(a(e))return n(e,t)+"";if(o(e))return l?l.call(e):"";var r=e+"";return"0"==r&&1/e==-1/0?"-0":r}},function(t,e){t.exports=function(t,e){for(var r=-1,i=null==t?0:t.length,n=Array(i);++r<i;)n[r]=e(t[r],r,t);return n}},function(t,e){var r=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&r.call(t,e)}},function(t,e,r){var i=r(40),n=r(22),a=r(6),o=r(25),s=r(24),l=r(41);t.exports=function(t,e,r){for(var h=-1,u=(e=i(e,t)).length,c=!1;++h<u;){var p=l(e[h]);if(!(c=null!=t&&r(t,p)))break;t=t[p]}return c||++h!=u?c:!!(u=null==t?0:t.length)&&s(u)&&o(p,u)&&(a(t)||n(t))}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(7),n=r(10),a=r(16);e["default"]=function(t){if(!t)throw new Error("geojson is required");var e=[];return a.flattenEach(t,(function(t){!function(t,e){var r=[],a=t.geometry;if(null!==a){switch(a.type){case"Polygon":r=n.getCoords(a);break;case"LineString":r=[n.getCoords(a)]}r.forEach((function(r){(function(t,e){var r=[];return t.reduce((function(t,n){var a,o,s,l,h,u,c=i.lineString([t,n],e);return c.bbox=(o=n,s=(a=t)[0],l=a[1],h=o[0],u=o[1],[s<h?s:h,l<u?l:u,s>h?s:h,l>u?l:u]),r.push(c),n})),r})(r,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}}(t,e)})),i.featureCollection(e)}},function(t,e,r){var i=r(148),n=r(7),a=r(16),o=r(42)["default"],s=a.featureEach,l=(a.coordEach,n.polygon,n.featureCollection);function h(t){var e=i(t);return e.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:o(t),i.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:o(t),e.push(t)})):s(t,(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox?t.bbox:o(t),e.push(t)})),i.prototype.load.call(this,e)},e.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox?t.bbox:o(t),i.prototype.remove.call(this,t,e)},e.clear=function(){return i.prototype.clear.call(this)},e.search=function(t){var e=i.prototype.search.call(this,this.toBBox(t));return l(e)},e.collides=function(t){return i.prototype.collides.call(this,this.toBBox(t))},e.all=function(){var t=i.prototype.all.call(this);return l(t)},e.toJSON=function(){return i.prototype.toJSON.call(this)},e.fromJSON=function(t){return i.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=o(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=o(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},e}t.exports=h,t.exports["default"]=h},function(t,e,r){"use strict";t.exports=n,t.exports["default"]=n;var i=r(149);function n(t,e){if(!(this instanceof n))return new n(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function a(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function o(t,e){s(t,0,t.children.length,e,t)}function s(t,e,r,i,n){n||(n=g(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,o=e;o<r;o++)a=t.children[o],l(n,t.leaf?i(a):a);return n}function l(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function h(t,e){return t.minX-e.minX}function u(t,e){return t.minY-e.minY}function c(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function p(t){return t.maxX-t.minX+(t.maxY-t.minY)}function f(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function d(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function g(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function m(t,e,r,n,a){for(var o,s=[e,r];s.length;)(r=s.pop())-(e=s.pop())<=n||(o=e+Math.ceil((r-e)/n/2)*n,i(t,o,e,r,a),s.push(e,o,o,r))}n.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!d(t,e))return r;for(var n,a,o,s,l=[];e;){for(n=0,a=e.children.length;n<a;n++)o=e.children[n],d(t,s=e.leaf?i(o):o)&&(e.leaf?r.push(o):f(t,s)?this._all(o,r):l.push(o));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!d(t,e))return!1;for(var i,n,a,o,s=[];e;){for(i=0,n=e.children.length;i<n;i++)if(a=e.children[i],d(t,o=e.leaf?r(a):a)){if(e.leaf||f(t,o))return!0;s.push(a)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=g([]),this},remove:function(t,e){if(!t)return this;for(var r,i,n,o,s=this.data,l=this.toBBox(t),h=[],u=[];s||h.length;){if(s||(s=h.pop(),i=h[h.length-1],r=u.pop(),o=!0),s.leaf&&-1!==(n=a(t,s.children,e)))return s.children.splice(n,1),h.push(s),this._condense(h),this;o||s.leaf||!f(s,l)?i?(r++,s=i.children[r],o=!1):s=null:(h.push(s),u.push(r),r=0,i=s,s=s.children[0])}return this},toBBox:function(t){return t},compareMinX:h,compareMinY:u,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var n,a=r-e+1,s=this._maxEntries;if(a<=s)return o(n=g(t.slice(e,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,i-1))),(n=g([])).leaf=!1,n.height=i;var l,h,u,c,p=Math.ceil(a/s),f=p*Math.ceil(Math.sqrt(s));for(m(t,e,r,f,this.compareMinX),l=e;l<=r;l+=f)for(m(t,l,u=Math.min(l+f-1,r),p,this.compareMinY),h=l;h<=u;h+=p)c=Math.min(h+p-1,u),n.children.push(this._build(t,h,c,i-1));return o(n,this.toBBox),n},_chooseSubtree:function(t,e,r,i){for(var n,a,o,s,l,h,u,p,f,d;i.push(e),!e.leaf&&i.length-1!==r;){for(u=p=1/0,n=0,a=e.children.length;n<a;n++)l=c(o=e.children[n]),f=t,d=o,(h=(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-l)<p?(p=h,u=l<u?l:u,s=o):h===p&&l<u&&(u=l,s=o);e=s||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,n=r?t:i(t),a=[],o=this._chooseSubtree(n,this.data,e,a);for(o.children.push(t),l(o,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var r=t[e],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var a=this._chooseSplitIndex(r,n,i),s=g(r.children.splice(a,r.children.length-a));s.height=r.height,s.leaf=r.leaf,o(r,this.toBBox),o(s,this.toBBox),e?t[e-1].children.push(s):this._splitRoot(r,s)},_splitRoot:function(t,e){this.data=g([t,e]),this.data.height=t.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,n,a,o,l,h,u,p,f,d,g,m,_,y;for(h=u=1/0,i=e;i<=r-e;i++)n=s(t,0,i,this.toBBox),a=s(t,i,r,this.toBBox),f=n,d=a,g=void 0,m=void 0,_=void 0,y=void 0,g=Math.max(f.minX,d.minX),m=Math.max(f.minY,d.minY),_=Math.min(f.maxX,d.maxX),y=Math.min(f.maxY,d.maxY),o=Math.max(0,_-g)*Math.max(0,y-m),l=c(n)+c(a),o<h?(h=o,p=i,u=l<u?l:u):o===h&&l<u&&(u=l,p=i);return p},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:h,n=t.leaf?this.compareMinY:u;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,n)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var n,a,o=this.toBBox,h=s(t,0,e,o),u=s(t,r-e,r,o),c=p(h)+p(u);for(n=e;n<r-e;n++)a=t.children[n],l(h,t.leaf?o(a):a),c+=p(h);for(n=r-e-1;n>=e;n--)a=t.children[n],l(u,t.leaf?o(a):a),c+=p(u);return c},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)l(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():o(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}},function(t,e,r){t.exports=function(){"use strict";function t(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function e(t,e){return t<e?-1:t>e?1:0}return function(r,i,n,a,o){!function e(r,i,n,a,o){for(;a>n;){if(a-n>600){var s=a-n+1,l=i-n+1,h=Math.log(s),u=.5*Math.exp(2*h/3),c=.5*Math.sqrt(h*u*(s-u)/s)*(l-s/2<0?-1:1),p=Math.max(n,Math.floor(i-l*u/s+c)),f=Math.min(a,Math.floor(i+(s-l)*u/s+c));e(r,i,p,f,o)}var d=r[i],g=n,m=a;for(t(r,n,i),o(r[a],d)>0&&t(r,n,a);g<m;){for(t(r,g,m),g++,m--;o(r[g],d)<0;)g++;for(;o(r[m],d)>0;)m--}0===o(r[n],d)?t(r,n,m):(m++,t(r,m,a)),m<=i&&(n=m+1),i<=m&&(a=m-1)}}(r,i,n||0,a||r.length-1,o||e)}}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(10);function n(t,e,r){var i=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var n=0,a=e.length-1;n<e.length;a=n++){var o=e[n][0],s=e[n][1],l=e[a][0],h=e[a][1];if(t[1]*(o-l)+s*(l-t[0])+h*(t[0]-o)==0&&(o-t[0])*(l-t[0])<=0&&(s-t[1])*(h-t[1])<=0)return!r;s>t[1]!=h>t[1]&&t[0]<(l-o)*(t[1]-s)/(h-s)+o&&(i=!i)}return i}e["default"]=function(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var a=i.getCoord(t),o=i.getGeom(e),s=o.type,l=e.bbox,h=o.coordinates;if(l&&!1===function(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}(a,l))return!1;"Polygon"===s&&(h=[h]);for(var u=!1,c=0;c<h.length&&!u;c++)if(n(a,h[c][0],r.ignoreBoundary)){for(var p=!1,f=1;f<h[c].length&&!p;)n(a,h[c][f],!r.ignoreBoundary)&&(p=!0),f++;p||(u=!0)}return u}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(10);function n(t,e,r,i){var n=r[0],a=r[1],o=t[0],s=t[1],l=e[0],h=e[1],u=l-o,c=h-s;return 0==(r[0]-o)*c-(r[1]-s)*u&&(i?"start"===i?Math.abs(u)>=Math.abs(c)?u>0?o<n&&n<=l:l<=n&&n<o:c>0?s<a&&a<=h:h<=a&&a<s:"end"===i?Math.abs(u)>=Math.abs(c)?u>0?o<=n&&n<l:l<n&&n<=o:c>0?s<=a&&a<h:h<a&&a<=s:"both"===i&&(Math.abs(u)>=Math.abs(c)?u>0?o<n&&n<l:l<n&&n<o:c>0?s<a&&a<h:h<a&&a<s):Math.abs(u)>=Math.abs(c)?u>0?o<=n&&n<=l:l<=n&&n<=o:c>0?s<=a&&a<=h:h<=a&&a<=s)}e["default"]=function(t,e,r){void 0===r&&(r={});for(var a=i.getCoord(t),o=i.getCoords(e),s=0;s<o.length-1;s++){var l=!1;if(r.ignoreEndVertices&&(0===s&&(l="start"),s===o.length-2&&(l="end"),0===s&&s+1===o.length-1&&(l="both")),n(o[s],o[s+1],a,l))return!0}return!1}},function(t,e){var r,i,n=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var l,h=[],u=!1,c=-1;function p(){u&&l&&(u=!1,l.length?h=l.concat(h):c=-1,h.length&&f())}function f(){if(!u){var t=s(p);u=!0;for(var e=h.length;e;){for(l=h,h=[];++c<e;)l&&l[c].run();c=-1,e=h.length}l=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new d(t,e)),1!==h.length||u||s(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=g,n.addListener=g,n.once=g,n.off=g,n.removeListener=g,n.removeAllListeners=g,n.emit=g,n.prependListener=g,n.prependOnceListener=g,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e,r){},function(t,e,r){},function(t,e,r){"use strict";r.r(e),r(69);var i=r(43),n=r(3),a=r.n(n),o=r(44),s=r(45),l=r(46),h=r(47),u=r(48),c=r(49),p=r(50),f=r(51),d=r(52),g=r(53),m=r(54),_={en:o,de:s,it:l,id:h,ro:u,ru:c,es:p,nl:f,fr:d,pt_br:r(55),zh:g,zh_tw:m,pl:r(56),sv:r(57),el:r(58),hu:r(59),da:r(60),no:r(61),fa:r(62),ua:r(63),tr:r(64),cz:r(65)};function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function v(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b={_globalEditModeEnabled:!1,enableGlobalEditMode:function(t){this._globalEditModeEnabled=!0,this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),L.PM.Utils.findLayers(this.map).forEach((function(e){e.pm.enable(t)})),this.throttledReInitEdit||(this.throttledReInitEdit=L.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayers=[],this.map.on("layeradd",this._layerAdded,this),this.map.on("layeradd",this.throttledReInitEdit,this),this._fireGlobalEditModeToggled(!0)},disableGlobalEditMode:function(){this._globalEditModeEnabled=!1,L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.disable()})),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",this.globalEditModeEnabled()),this._fireGlobalEditModeToggled(!1)},globalEditEnabled:function(){return this.globalEditModeEnabled()},globalEditModeEnabled:function(){return this._globalEditModeEnabled},toggleGlobalEditMode:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.globalOptions;this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode:function(){var t=this,e=this._addedLayers;this._addedLayers=[],e.forEach((function(e){e.pm&&!e._pmTempLayer&&t.globalEditModeEnabled()&&e.pm.enable(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){v(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},t.globalOptions))}))},_layerAdded:function(t){var e=t.layer;this._addedLayers.push(e)}},k={_globalDragModeEnabled:!1,enableGlobalDragMode:function(){var t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!0,t.forEach((function(t){t.pm.enableLayerDrag()})),this.throttledReInitDrag||(this.throttledReInitDrag=L.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!0)},disableGlobalDragMode:function(){var t=L.PM.Utils.findLayers(this.map);this._globalDragModeEnabled=!1,t.forEach((function(t){t.pm.disableLayerDrag()})),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this.globalDragModeEnabled()),this._fireGlobalDragModeToggled(!1)},globalDragModeEnabled:function(){return!!this._globalDragModeEnabled},toggleGlobalDragMode:function(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode:function(t){var e=t.layer;e.pm&&!e._pmTempLayer&&this.globalDragModeEnabled()&&(this.disableGlobalDragMode(),this.enableGlobalDragMode())}},M={_globalRemovalModeEnabled:!1,enableGlobalRemovalMode:function(){var t=this;this._globalRemovalModeEnabled=!0,this.map.eachLayer((function(e){t._isRelevantForRemoval(e)&&(e.pm.disable(),e.on("click",t.removeLayer,t))})),this.throttledReInitRemoval||(this.throttledReInitRemoval=L.Util.throttle(this.reinitGlobalRemovalMode,100,this)),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!0)},disableGlobalRemovalMode:function(){var t=this;this._globalRemovalModeEnabled=!1,this.map.eachLayer((function(e){e.off("click",t.removeLayer,t)})),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this.globalRemovalModeEnabled()),this._fireGlobalRemovalModeToggled(!1)},globalRemovalEnabled:function(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled:function(){return!!this._globalRemovalModeEnabled},toggleGlobalRemovalMode:function(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},reinitGlobalRemovalMode:function(t){var e=t.layer;this._isRelevantForRemoval(e)&&this.globalRemovalModeEnabled()&&(this.disableGlobalRemovalMode(),this.enableGlobalRemovalMode())},removeLayer:function(t){var e=t.target;this._isRelevantForRemoval(e)&&!e.pm.dragging()&&(e.removeFrom(this.map.pm._getContainingLayer()),e.remove(),e instanceof L.LayerGroup?(this._fireRemoveLayerGroup(e),this._fireRemoveLayerGroup(this.map,e)):(e.pm._fireRemove(e),e.pm._fireRemove(this.map,e)))},_isRelevantForRemoval:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRemoval}},w={_globalRotateModeEnabled:!1,enableGlobalRotateMode:function(){var t=this;this._globalRotateModeEnabled=!0,L.PM.Utils.findLayers(this.map).filter((function(t){return t instanceof L.Polyline})).forEach((function(e){t._isRelevantForRotate(e)&&e.pm.enableRotate()})),this.throttledReInitRotate||(this.throttledReInitRotate=L.Util.throttle(this._reinitGlobalRotateMode,100,this)),this.map.on("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},disableGlobalRotateMode:function(){this._globalRotateModeEnabled=!1,L.PM.Utils.findLayers(this.map).filter((function(t){return t instanceof L.Polyline})).forEach((function(t){t.pm.disableRotate()})),this.map.off("layeradd",this.throttledReInitRotate,this),this.Toolbar.toggleButton("rotateMode",this.globalRotateModeEnabled()),this._fireGlobalRotateModeToggled()},globalRotateModeEnabled:function(){return!!this._globalRotateModeEnabled},toggleGlobalRotateMode:function(){this.globalRotateModeEnabled()?this.disableGlobalRotateMode():this.enableGlobalRotateMode()},_reinitGlobalRotateMode:function(t){var e=t.layer;this._isRelevantForRotate(e)&&this.globalRotateModeEnabled()&&(this.disableGlobalRotateMode(),this.enableGlobalRotateMode())},_isRelevantForRotate:function(t){return t.pm&&!(t instanceof L.LayerGroup)&&(!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore)&&!t._pmTempLayer&&t.pm.options.allowRotation}};function x(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?x(Object(r),!0).forEach((function(e){C(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):x(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function C(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var E={_fireDrawStart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer},t,e)},_fireDrawEnd:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:drawend",{shape:this._shape},t,e)},_fireCreate:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Draw",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._map,"pm:create",{shape:this._shape,marker:t,layer:t},e,r)},_fireCenterPlaced:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Draw",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r="Draw"===t?this._layer:void 0,i="Draw"!==t?this._layer:void 0;this.__fire(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:r,layer:i,latlng:this._layer.getLatLng()},t,e)},_fireCut:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Draw",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(t,"pm:cut",{shape:this._shape,layer:e,originalLayer:r},i,n)},_fireEdit:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(t,"pm:edit",{layer:this._layer,shape:this.getShape()},e,r)},_fireEnable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()},t,e)},_fireDisable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()},t,e)},_fireUpdate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()},t,e)},_fireMarkerDragStart:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},r,i)},_fireMarkerDrag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e},r,i)},_fireMarkerDragEnd:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Edit",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:e,intersectionReset:r},i,n)},_fireDragStart:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()},t,e)},_fireDrag:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:drag",P(P({},t),{},{shape:this.getShape()}),e,r)},_fireDragEnd:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Edit",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()},t,e)},_fireRemove:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:remove",{layer:e,shape:this.getShape()},r,i)},_fireVertexAdded:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Edit",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._layer,"pm:vertexadded",{layer:this._layer,workingLayer:this._layer,marker:t,indexPath:e,latlng:r,shape:this.getShape()},i,n)},_fireVertexRemoved:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:vertexremoved",{layer:this._layer,marker:t,indexPath:e,shape:this.getShape()},r,i)},_fireVertexClick:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:vertexclick",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},r,i)},_fireIntersect:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Edit",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this._layer,"pm:intersect",{layer:this._layer,intersection:t,shape:this.getShape()},e,r)},_fireLayerReset:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._layer,"pm:layerreset",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()},r,i)},_fireSnapDrag:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:snapdrag",e,r,i)},_fireSnap:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:snap",e,r,i)},_fireUnsnap:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Snapping",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:unsnap",e,r,i)},_fireRotationEnable:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Rotation",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:rotateenable",{layer:this._layer,helpLayer:this._rotatePoly},r,i)},_fireRotationDisable:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Rotation",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(t,"pm:rotatedisable",{layer:this._layer},e,r)},_fireRotationStart:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Rotation",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:rotatestart",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,originLatLngs:e},r,i)},_fireRotation:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Rotation",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(t,"pm:rotate",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:this._startAngle,angle:this._rotationLayer.pm.getAngle(),angleDiff:e,oldLatLngs:r,newLatLngs:this._rotationLayer.getLatLngs()},i,n)},_fireRotationEnd:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Rotation",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(t,"pm:rotateend",{layer:this._rotationLayer,helpLayer:this._layer,startAngle:e,angle:this._rotationLayer.pm.getAngle(),originLatLngs:r,newLatLngs:this._rotationLayer.getLatLngs()},i,n)},_fireActionClick:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Toolbar",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this._map,"pm:actionclick",{text:t.text,action:t,btnName:e,button:r},i,n)},_fireButtonClick:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Toolbar",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(this._map,"pm:buttonclick",{btnName:t,button:e},r,i)},_fireLangChange:function(t,e,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Global",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};this.__fire(this.map,"pm:langchange",{oldLang:t,activeLang:e,fallback:r,translations:i},n,a)},_fireGlobalDragModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map},e,r)},_fireGlobalEditModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map},e,r)},_fireGlobalRemovalModeToggled:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Global",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.__fire(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map},e,r)},_fireGlobalCutModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map},t,e)},_fireGlobalDrawModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map},t,e)},_fireGlobalRotateModeToggled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Global",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.__fire(this.map,"pm:globalrotatemodetoggled",{enabled:this.globalRotateModeEnabled(),map:this.map},t,e)},_fireRemoveLayerGroup:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Edit",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};this.__fire(t,"pm:remove",{layer:e,shape:void 0},r,i)},_fireKeyeventEvent:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Global",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.__fire(this.map,"pm:keyevent",{event:t,eventType:e,focusOn:r},i,n)},__fire:function(t,e,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};r=a()(r,n,{source:i}),L.PM.Utils._fireEvent(t,e,r)}},S={_lastEvents:{keydown:void 0,keyup:void 0,current:void 0},_initKeyListener:function(t){this.map=t,L.DomEvent.on(document,"keydown keyup",this._onKeyListener,this)},_onKeyListener:function(t){var e="document";this.map.getContainer().contains(t.target)&&(e="map");var r={event:t,eventType:t.type,focusOn:e};this._lastEvents[t.type]=r,this._lastEvents.current=r,this.map.pm._fireKeyeventEvent(t,t.type,e)},getLastKeyEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"current";return this._lastEvents[t]},isShiftKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.shiftKey},isAltKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.altKey},isCtrlKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.ctrlKey},isMetaKeyPressed:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.metaKey},getPressedKey:function(){var t;return null===(t=this._lastEvents.current)||void 0===t?void 0:t.event.key}},O=L.Class.extend({includes:[b,k,M,w,E],initialize:function(t){this.map=t,this.Draw=new L.PM.Draw(t),this.Toolbar=new L.PM.Toolbar(t),this.Keyboard=S,this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"],panes:{vertexPane:"markerPane",layerPane:"overlayPane",markerPane:"markerPane"}},this.Keyboard._initKeyListener(t)},setLang:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",e=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",i=L.PM.activeLang;e&&(_[t]=a()(_[r],e)),L.PM.activeLang=t,this.map.pm.Toolbar.reinit(),this._fireLangChange(i,t,r,_[t])},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Polygon",e=arguments.length>1?arguments[1]:void 0;"Poly"===t&&(t="Polygon"),this.Draw.enable(t,e)},disableDraw:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Polygon";"Poly"===t&&(t="Polygon"),this.Draw.disable(t)},setPathOptions:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.ignoreShapes||[],n=r.merge||!1;this.map.pm.Draw.shapes.forEach((function(r){-1===i.indexOf(r)&&e.map.pm.Draw[r].setPathOptions(t,n)}))},getGlobalOptions:function(){return this.globalOptions},setGlobalOptions:function(t){var e=this,r=a()(this.globalOptions,t),i=!1;this.map.pm.Draw.CircleMarker.enabled()&&this.map.pm.Draw.CircleMarker.options.editable!==r.editable&&(this.map.pm.Draw.CircleMarker.disable(),i=!0),this.map.pm.Draw.shapes.forEach((function(t){e.map.pm.Draw[t].setOptions(r)})),i&&this.map.pm.Draw.CircleMarker.enable(),L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.setOptions(r)})),this.applyGlobalOptions(),this.globalOptions=r},applyGlobalOptions:function(){L.PM.Utils.findLayers(this.map).forEach((function(t){t.pm.enabled()&&t.pm.applyOptions()}))},globalDrawModeEnabled:function(){return!!this.Draw.getActiveShape()},globalCutModeEnabled:function(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode:function(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode:function(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode:function(){return this.Draw.Cut.disable()},getGeomanLayers:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=L.PM.Utils.findLayers(this.map);if(!t)return e;var r=L.featureGroup();return r._pmTempLayer=!0,e.forEach((function(t){r.addLayer(t)})),r},getGeomanDrawLayers:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=L.PM.Utils.findLayers(this.map).filter((function(t){return!0===t._drawnByGeoman}));if(!t)return e;var r=L.featureGroup();return r._pmTempLayer=!0,e.forEach((function(t){r.addLayer(t)})),r},_getContainingLayer:function(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof L.LayerGroup?this.globalOptions.layerGroup:this.map}}),B=r(0),R=r.n(B),D=r(66),T=r.n(D);function j(t){var e=L.PM.activeLang;return T()(_,e)||(e="en"),R()(_[e],t)}function I(t){return!function t(e){return e.filter((function(t){return![null,"",void 0].includes(t)})).reduce((function(e,r){return e.concat(Array.isArray(r)?t(r):r)}),[])}(t).length}function G(t){return t.reduce((function(t,e){return 0!==e.length&&t.push(Array.isArray(e)?G(e):e),t}),[])}function A(t,e,r){for(var i,n,a,o=6378137,s=6356752.3142,l=1/298.257223563,h=t.lng,u=t.lat,c=r,p=Math.PI,f=e*p/180,d=Math.sin(f),g=Math.cos(f),m=(1-l)*Math.tan(u*p/180),_=1/Math.sqrt(1+m*m),y=m*_,v=Math.atan2(m,g),b=_*d,k=1-b*b,M=k*(o*o-s*s)/(s*s),w=1+M/16384*(4096+M*(M*(320-175*M)-768)),x=M/1024*(256+M*(M*(74-47*M)-128)),P=c/(s*w),C=2*Math.PI;Math.abs(P-C)>1e-12;)i=Math.cos(2*v+P),C=P,P=c/(s*w)+x*(n=Math.sin(P))*(i+x/4*((a=Math.cos(P))*(2*i*i-1)-x/6*i*(4*n*n-3)*(4*i*i-3)));var E=y*n-_*a*g,S=Math.atan2(y*a+_*n*g,(1-l)*Math.sqrt(b*b+E*E)),O=l/16*k*(4+l*(4-3*k)),B=h+180*(Math.atan2(n*d,_*a-y*n*g)-(1-O)*l*b*(P+O*n*(i+O*a*(2*i*i-1))))/p,R=180*S/p;return L.latLng(B,R)}function N(t,e,r,i){for(var n,a,o=[],s=0;s<r;s+=1)n=A(t,360*s/r+i,e),a=L.latLng(n.lng,n.lat),o.push(a);return o}function z(t,e,r,i){return function(t,e,r){e=(e+360)%360;var i=Math.PI/180,n=180/Math.PI,a=6378137,o=t.lng*i,s=t.lat*i,l=e*i,h=Math.sin(s),u=Math.cos(s),c=Math.cos(r/a),p=Math.sin(r/a),f=Math.asin(h*c+u*p*Math.cos(l)),d=o+Math.atan2(Math.sin(l)*p*u,c-h*Math.sin(f));return d=(d*=n)>180?d-360:d<-180?d+360:d,L.latLng([f*n,d])}(e,function(t,e,r){var i=t.latLngToContainerPoint(e),n=t.latLngToContainerPoint(r),a=180*Math.atan2(n.y-i.y,n.x-i.x)/Math.PI+90;return a+(a<0?360:0)}(t,e,r),i)}function F(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.getLatLngs();return t instanceof L.Polygon?L.polygon(e).getLatLngs():L.polyline(e).getLatLngs()}function V(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function U(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?V(Object(r),!0).forEach((function(e){Y(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Y(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var X=L.Control.extend({includes:[E],options:{position:"topleft"},initialize:function(t){this._button=U(U({},this.options),t)},onAdd:function(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:"custom"===this._button.tool?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(t){t&&t.preventDefault(),this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t})},_makeButton:function(t){var e=this,r=this.options.position.indexOf("right")>-1?"pos-right":"",i=L.DomUtil.create("div","button-container  ".concat(r),this._container),n=L.DomUtil.create("a","leaflet-buttons-control-button",i);n.setAttribute("role","button"),n.setAttribute("tabindex","0"),n.href="#";var a=L.DomUtil.create("div","leaflet-pm-actions-container ".concat(r),i),o=t.actions,s={cancel:{text:j("actions.cancel"),onClick:function(){this._triggerClick()}},finishMode:{text:j("actions.finish"),onClick:function(){this._triggerClick()}},removeLastVertex:{text:j("actions.removeLastVertex"),onClick:function(){this._map.pm.Draw[t.jsClass]._removeLastVertex()}},finish:{text:j("actions.finish"),onClick:function(e){this._map.pm.Draw[t.jsClass]._finishShape(e)}}};o.forEach((function(i){var n,o="string"==typeof i?i:i.name;if(s[o])n=s[o];else{if(!i.text)return;n=i}var l=L.DomUtil.create("a","leaflet-pm-action ".concat(r," action-").concat(o),a);l.setAttribute("role","button"),l.setAttribute("tabindex","0"),l.href="#",l.innerHTML=n.text,!t.disabled&&n.onClick&&(L.DomEvent.addListener(l,"click",(function(r){r.preventDefault();var i="",a=e._map.pm.Toolbar.buttons;for(var o in a)if(a[o]._button===t){i=o;break}e._fireActionClick(n,i,t)}),e),L.DomEvent.addListener(l,"click",n.onClick,e)),L.DomEvent.disableClickPropagation(l)})),t.toggleStatus&&L.DomUtil.addClass(i,"active");var l=L.DomUtil.create("div","control-icon",n);return t.title&&l.setAttribute("title",t.title),t.iconUrl&&l.setAttribute("src",t.iconUrl),t.className&&L.DomUtil.addClass(l,t.className),t.disabled||(L.DomEvent.addListener(n,"click",(function(){e._button.disableOtherButtons&&e._map.pm.Toolbar.triggerClickOnToggledButtons(e);var r="",i=e._map.pm.Toolbar.buttons;for(var n in i)if(i[n]._button===t){r=n;break}e._fireButtonClick(r,t)})),L.DomEvent.addListener(n,"click",this._triggerClick,this)),t.disabled&&(L.DomUtil.addClass(n,"pm-disabled"),L.DomUtil.addClass(l,"pm-disabled")),L.DomEvent.disableClickPropagation(n),i},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus&&!1!==this._button.cssToggle?(L.DomUtil.addClass(this.buttonsDomNode,"active"),L.DomUtil.addClass(this._container,"activeChild")):(L.DomUtil.removeClass(this.buttonsDomNode,"active"),L.DomUtil.removeClass(this._container,"activeChild")))},_clicked:function(){this._button.doToggle&&this.toggle()}});function q(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function K(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?q(Object(r),!0).forEach((function(e){H(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):q(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function H(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t){return(J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}L.Control.PMButton=X;var W=L.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,rotateMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize:function(t){this.init(t)},reinit:function(){var t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer:function(t){var e="".concat(t,"Container");return this[e]||(this[e]=L.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-".concat(t," leaflet-bar leaflet-control"))),this[e]},getButtons:function(){return this.buttons},addControls:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options;"undefined"!=typeof t.editPolygon&&(t.editMode=t.editPolygon),"undefined"!=typeof t.deleteLayer&&(t.removalMode=t.deleteLayer),L.Util.setOptions(this,t),this.applyIconStyle(),this._showHideButtons(),this.isVisible=!0},applyIconStyle:function(){var t=this.getButtons(),e={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete"}};for(var r in t){var i=t[r];L.Util.setOptions(i,{className:e.geomanIcons[r]})}},removeControls:function(){var t=this.getButtons();for(var e in t)t[e].remove();this.isVisible=!1},toggleControls:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(t)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){var e=["snappingOption"];for(var r in this.buttons)!e.includes(r)&&this.buttons[r]!==t&&this.buttons[r].toggled()&&this.buttons[r]._triggerClick()},toggleButton:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return"editPolygon"===t&&(t="editMode"),"deleteLayer"===t&&(t="removalMode"),r&&this.triggerClickOnToggledButtons(this.buttons[t]),!!this.buttons[t]&&this.buttons[t].toggle(e)},_defineButtons:function(){var t=this,e={className:"control-icon leaflet-pm-icon-marker",title:j("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},r={title:j("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={className:"control-icon leaflet-pm-icon-polyline",title:j("buttonTitles.drawLineButton"),jsClass:"Line",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},n={title:j("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:j("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},o={title:j("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:j("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:j("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},h={title:j("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:function(){},afterClick:function(e,r){t.map.pm.Draw[r.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},u={title:j("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},c={title:j("buttonTitles.rotateButton"),className:"control-icon leaflet-pm-icon-rotate",onClick:function(){},afterClick:function(){t.map.pm.toggleGlobalRotateMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]};this._addButton("drawMarker",new L.Control.PMButton(e)),this._addButton("drawPolyline",new L.Control.PMButton(i)),this._addButton("drawRectangle",new L.Control.PMButton(o)),this._addButton("drawPolygon",new L.Control.PMButton(r)),this._addButton("drawCircle",new L.Control.PMButton(n)),this._addButton("drawCircleMarker",new L.Control.PMButton(a)),this._addButton("editMode",new L.Control.PMButton(s)),this._addButton("dragMode",new L.Control.PMButton(l)),this._addButton("cutPolygon",new L.Control.PMButton(h)),this._addButton("removalMode",new L.Control.PMButton(u)),this._addButton("rotateMode",new L.Control.PMButton(c))},_showHideButtons:function(){this.removeControls();var t=this.getButtons(),e=[];for(var r in!1===this.options.drawControls&&(e=e.concat(Object.keys(t).filter((function(e){return!t[e]._button.tool})))),!1===this.options.editControls&&(e=e.concat(Object.keys(t).filter((function(e){return"edit"===t[e]._button.tool})))),!1===this.options.optionsControls&&(e=e.concat(Object.keys(t).filter((function(e){return"options"===t[e]._button.tool})))),!1===this.options.customControls&&(e=e.concat(Object.keys(t).filter((function(e){return"custom"===t[e]._button.tool})))),t)if(this.options[r]&&-1===e.indexOf(r)){var i=t[r]._button.tool;i||(i="draw"),t[r].setPosition(this._getBtnPosition(i)),t[r].addTo(this.map)}},_getBtnPosition:function(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition:function(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions:function(){return this.options.positions},copyDrawControl:function(t,e){if(!e)throw new TypeError("Button has no name");"object"!==J(e)&&(e={name:e});var r=this._btnNameMapping(t);if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");var i=this.map.pm.Draw.createNewDrawInstance(e.name,r);return e=K(K({},this.buttons[r]._button),e),{drawInstance:i,control:this.createCustomControl(e)}},createCustomControl:function(t){if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");t.onClick||(t.onClick=function(){}),t.afterClick||(t.afterClick=function(){}),!1!==t.toggle&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),t.block&&"draw"!==t.block||(t.block=""),t.className?-1===t.className.indexOf("control-icon")&&(t.className="control-icon ".concat(t.className)):t.className="control-icon";var e={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:!0,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled};!1!==this.options[t.name]&&(this.options[t.name]=!0);var r=this._addButton(t.name,new L.Control.PMButton(e));return this.changeControlOrder(),r},changeControlOrder:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=this._shapeMapping(),r=[];t.forEach((function(t){e[t]?r.push(e[t]):r.push(t)}));var i=this.getButtons(),n={};r.forEach((function(t){i[t]&&(n[t]=i[t])}));var a=Object.keys(i).filter((function(t){return!i[t]._button.tool}));a.forEach((function(t){-1===r.indexOf(t)&&(n[t]=i[t])}));var o=Object.keys(i).filter((function(t){return"edit"===i[t]._button.tool}));o.forEach((function(t){-1===r.indexOf(t)&&(n[t]=i[t])}));var s=Object.keys(i).filter((function(t){return"options"===i[t]._button.tool}));s.forEach((function(t){-1===r.indexOf(t)&&(n[t]=i[t])}));var l=Object.keys(i).filter((function(t){return"custom"===i[t]._button.tool}));l.forEach((function(t){-1===r.indexOf(t)&&(n[t]=i[t])})),Object.keys(i).forEach((function(t){-1===r.indexOf(t)&&(n[t]=i[t])})),this.map.pm.Toolbar.buttons=n,this._showHideButtons()},getControlOrder:function(){var t=this.getButtons(),e=[];for(var r in t)e.push(r);return e},changeActionsOfControl:function(t,e){var r=this._btnNameMapping(t);if(!r)throw new TypeError("No name passed");if(!e)throw new TypeError("No actions passed");if(!this.buttons[r])throw new TypeError("Button with this name not exists");this.buttons[r]._button.actions=e,this.changeControlOrder()},setButtonDisabled:function(t,e){var r=this._btnNameMapping(t);this.buttons[r]._button.disabled=!!e,this._showHideButtons()},_shapeMapping:function(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode",Rotate:"rotateMode"}},_btnNameMapping:function(t){var e=this._shapeMapping();return e[t]?e[t]:t}});function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function $(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){Q(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Q(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var tt={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach((function(t){Array.isArray(t)?e._assignEvents(t):(t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e))}))},_cleanupSnapping:function(){delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach((function(t){t.remove()}))},_handleThrottleSnapping:function(){this.throttledList&&this._createSnapList()},_handleSnapping:function(t){var e=this,r=t.target;if(r._snapped=!1,this.throttledList||(this.throttledList=L.Util.throttle(this._handleThrottleSnapping,100,this)),this._map.pm.Keyboard.isAltKeyPressed())return!1;if(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0)return!1;var i=this._calcClosestLayer(r.getLatLng(),this._snapList);if(0===Object.keys(i).length)return!1;var n,a=i.layer instanceof L.Marker||i.layer instanceof L.CircleMarker||!this.options.snapSegment;n=a?i.latlng:this._checkPrioritiySnapping(i);var o=this.options.snapDistance,s={marker:r,shape:this._shape,snapLatLng:n,segment:i.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:i.layer,distance:i.distance};if(this._fireSnapDrag(s.marker,s),this._fireSnapDrag(this._layer,s),i.distance<o){r._orgLatLng=r.getLatLng(),r.setLatLng(n),r._snapped=!0,r._snapInfo=s;var l=this._snapLatLng||{},h=n||{};l.lat===h.lat&&l.lng===h.lng||(e._snapLatLng=n,e._fireSnap(r,s),e._fireSnap(e._layer,s))}else this._snapLatLng&&(this._unsnap(s),r._snapped=!1,this._fireUnsnap(s.marker,s),this._fireUnsnap(this._layer,s));return!0},_createSnapList:function(){var t=this,e=[],r=[],i=this._map;i.off("pm:remove",this._handleSnapLayerRemoval,this),i.on("pm:remove",this._handleSnapLayerRemoval,this),i.eachLayer((function(t){if((t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&!0!==t.options.snapIgnore){if(void 0===t.options.snapIgnore&&(!L.PM.optIn&&!0===t.options.pmIgnore||L.PM.optIn&&!1!==t.options.pmIgnore))return;(t instanceof L.Circle||t instanceof L.CircleMarker)&&t.pm&&t.pm._hiddenPolyCircle?e.push(t.pm._hiddenPolyCircle):t instanceof L.ImageOverlay&&(t=L.rectangle(t.getBounds())),e.push(t);var i=L.polyline([],{color:"red",pmIgnore:!0});i._pmTempLayer=!0,r.push(i),(t instanceof L.Circle||t instanceof L.CircleMarker)&&r.push(i)}})),e=(e=(e=e.filter((function(e){return t._layer!==e}))).filter((function(t){return t._latlng||t._latlngs&&!I(t._latlngs)}))).filter((function(t){return!t._pmTempLayer})),this._otherSnapLayers?(this._otherSnapLayers.forEach((function(){var t=L.polyline([],{color:"red",pmIgnore:!0});t._pmTempLayer=!0,r.push(t)})),this._snapList=e.concat(this._otherSnapLayers)):this._snapList=e,this.debugIndicatorLines=r},_handleSnapLayerRemoval:function(t){var e=t.layer,r=this._snapList.findIndex((function(t){return t._leaflet_id===e._leaflet_id}));this._snapList.splice(r,1)},_calcClosestLayer:function(t,e){var r=this,i=[],n={};return e.forEach((function(e,a){if(!e._parentCopy||e._parentCopy!==r._layer){var o=r._calcLayerDistances(t,e);r.debugIndicatorLines[a]&&r.debugIndicatorLines[a].setLatLngs([t,o.latlng]),(void 0===n.distance||o.distance<=n.distance)&&(o.distance<n.distance&&(i=[]),(n=o).layer=e,i.push(n))}})),this._getClosestLayerByPriority(i)},_calcLayerDistances:function(t,e){var r,i,n,a=this,o=this._map,s=e instanceof L.Marker||e instanceof L.CircleMarker,l=e instanceof L.Polygon,h=t,u=s?e.getLatLng():e.getLatLngs();return s?{latlng:$({},u),distance:this._getDistance(o,u,h)}:(function t(e){e.forEach((function(s,u){if(Array.isArray(s))t(s);else if(a.options.snapSegment){var c,p=s;c=l?u+1===e.length?0:u+1:u+1===e.length?void 0:u+1;var f=e[c];if(f){var d=a._getDistanceToSegment(o,h,p,f);(void 0===i||d<i)&&(i=d,n=[p,f])}}else{var g=a._getDistance(o,h,s);(void 0===i||g<i)&&(i=g,r=s)}}))}(u),this.options.snapSegment?{latlng:$({},this._getClosestPointOnSegment(o,t,n[0],n[1])),segment:n,distance:i}:{latlng:r,distance:i})},_getClosestLayerByPriority:function(t){t=t.sort((function(t,e){return t._leaflet_id-e._leaflet_id}));var e=this._map.pm.globalOptions.snappingOrder||[],r=0,i={};return e.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach((function(t){i[t]||(r+=1,i[t]=r)})),t.sort(function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"asc";if(!e||0===Object.keys(e).length)return function(t,e){return t-e};for(var i,n=Object.keys(e),a=n.length,o={};a--;)i=n[a],o[i.toLowerCase()]=e[i];function s(t){return t instanceof L.Marker?"Marker":t instanceof L.Circle?"Circle":t instanceof L.CircleMarker?"CircleMarker":t instanceof L.Rectangle?"Rectangle":t instanceof L.Polygon?"Polygon":t instanceof L.Polyline?"Line":void 0}return function(e,i){var n,a;if("instanceofShape"===t){if(n=s(e.layer).toLowerCase(),a=s(i.layer).toLowerCase(),!n||!a)return 0}else{if(!e.hasOwnProperty(t)||!i.hasOwnProperty(t))return 0;n=e[t].toLowerCase(),a=i[t].toLowerCase()}var l=n in o?o[n]:Number.MAX_SAFE_INTEGER,h=a in o?o[a]:Number.MAX_SAFE_INTEGER,u=0;return l<h?u=-1:l>h&&(u=1),"desc"===r?-1*u:u}}("instanceofShape",i)),t[0]||{}},_checkPrioritiySnapping:function(t){var e=this._map,r=t.segment[0],i=t.segment[1],n=t.latlng,a=this._getDistance(e,r,n),o=this._getDistance(e,i,n),s=a<o?r:i,l=a<o?a:o;if(this.options.snapMiddle){var h=L.PM.Utils.calcMiddleLatLng(e,r,i),u=this._getDistance(e,h,n);u<a&&u<o&&(s=h,l=u)}return $({},l<this.options.snapDistance?s:n)},_unsnap:function(){delete this._snapLatLng},_getClosestPointOnSegment:function(t,e,r,i){var n=t.getMaxZoom();n===1/0&&(n=t.getZoom());var a=t.project(e,n),o=t.project(r,n),s=t.project(i,n),l=L.LineUtil.closestPointOnSegment(a,o,s);return t.unproject(l,n)},_getDistanceToSegment:function(t,e,r,i){var n=t.latLngToLayerPoint(e),a=t.latLngToLayerPoint(r),o=t.latLngToLayerPoint(i);return L.LineUtil.pointToSegmentDistance(n,a,o)},_getDistance:function(t,e,r){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(r))}},et=L.Class.extend({includes:[tt,E],options:{snappable:!0,snapDistance:20,snapMiddle:!1,allowSelfIntersection:!0,tooltips:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},pathOptions:null,cursorMarker:!0,finishOn:null,markerStyle:{draggable:!0,icon:L.icon()},hideMiddleMarkers:!1,minRadiusCircle:null,maxRadiusCircle:null,minRadiusCircleMarker:null,maxRadiusCircleMarker:null,editable:!1,markerEditable:!0,continueDrawing:!1,snapSegment:!0,requireSnapToFinish:!1},setOptions:function(t){L.Util.setOptions(this,t)},getOptions:function(){return this.options},initialize:function(t){var e=this,r=new L.Icon.Default;r.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=r,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut"],this.shapes.forEach((function(t){e[t]=new L.PM.Draw[t](e._map)})),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.options.pathOptions=e?a()(this.options.pathOptions,t):t},getShapes:function(){return this.shapes},getShape:function(){return this._shape},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var t=this;this.shapes.forEach((function(e){t[e].disable()}))},addControls:function(){var t=this;this.shapes.forEach((function(e){t[e].addButton()}))},getActiveShape:function(){var t,e=this;return this.shapes.forEach((function(r){e[r]._enabled&&(t=r)})),t},_setGlobalDrawMode:function(){"Cut"===this._shape?this._fireGlobalCutModeToggled():this._fireGlobalDrawModeToggled();var t=L.PM.Utils.findLayers(this._map);this._enabled?t.forEach((function(t){L.PM.Utils.disablePopup(t)})):t.forEach((function(t){L.PM.Utils.enablePopup(t)}))},createNewDrawInstance:function(t,e){var r=this._getShapeFromBtnName(e);if(this[t])throw new TypeError("Draw Type already exists");if(!L.PM.Draw[r])throw new TypeError("There is no class L.PM.Draw.".concat(r));return this[t]=new L.PM.Draw[r](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t]},_getShapeFromBtnName:function(t){var e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal",rotateMode:"Rotate"};return e[t]?e[t]:this[t]?this[t]._shape:t},_finishLayer:function(t){t.pm&&(t.pm.setOptions(this.options),t.pm._shape=this._shape,t.pm._map=this._map),this._addDrawnLayerProp(t)},_addDrawnLayerProp:function(t){t._drawnByGeoman=!0},_setPane:function(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},_isFirstLayer:function(){return 0===(this._map||this._layer._map).pm.getGeomanLayers().length}});et.Marker=et.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){var e=this;L.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=L.marker([0,0],this.options.markerStyle),this._setPane(this._hintMarker,"markerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.placeMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()})),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var t=this;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer((function(e){t.isRelevantMarker(e)&&e.pm.disable()})),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker:function(t){return t instanceof L.Marker&&t.pm&&!t._pmTempLayer},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_createMarker:function(t){if(t.latlng&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),r=new L.Marker(e,this.options.markerStyle);this._setPane(r,"markerPane"),this._finishLayer(r),r.pm||(r.options.draggable=!1),r.addTo(this._map.pm._getContainingLayer()),r.pm&&this.options.markerEditable?r.pm.enable():r.dragging&&r.dragging.disable(),this._fireCreate(r),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}}});var rt=r(8),it=r.n(rt);function nt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function at(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?nt(Object(r),!0).forEach((function(e){ot(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):nt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ot(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function st(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function lt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?st(Object(r),!0).forEach((function(e){ht(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):st(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ht(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}et.Line=et.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.polyline([],this.options.templineStyle),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=L.marker(this._map.getCenter(),{interactive:!1,zIndexOffset:100,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&"snap"!==this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._layer.getLatLngs();if(t.length>0){var e=t[t.length-1];this._hintline.setLatLngs([e,this._hintMarker.getLatLng()])}},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this.options.allowSelfIntersection||this._handleSelfIntersection(!0,t.latlng)},hasSelfIntersection:function(){return it()(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersection:function(t,e){var r=L.polyline(this._layer.getLatLngs());t&&(e||(e=this._hintMarker.getLatLng()),r.addLatLng(e));var i=it()(r.toGeoJSON(15));this._doesSelfIntersect=i.features.length>0,this._doesSelfIntersect?this._hintline.setStyle({color:"#f00000ff"}):this._hintline.isEmpty()||this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(t){if(this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,t.latlng),!this._doesSelfIntersect)){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();if(e.equals(this._layer.getLatLngs()[0]))this._finishShape(t);else{this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e);var r=this._createMarker(e);this._setTooltipText(),this._hintline.setLatLngs([e,e]),this._fireVertexAdded(r,void 0,e,"Draw"),"snap"===this.options.finishOn&&this._hintMarker._snapped&&this._finishShape(t)}}},_removeLastVertex:function(){var t=this._layer.getLatLngs(),e=t.pop();if(t.length<1)this.disable();else{var r=this._layerGroup.getLayers().filter((function(t){return t instanceof L.Marker})).filter((function(t){return!L.DomUtil.hasClass(t._icon,"cursor-marker")})).find((function(t){return t.getLatLng()===e}));this._layerGroup.removeLayer(r),this._layer.setLatLngs(t),this._syncHintLine(),this._setTooltipText()}},_finishShape:function(){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!1),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var t=this._layer.getLatLngs();if(!(t.length<=1)){var e=L.polyline(t,this.options.pathOptions);this._setPane(e,"layerPane"),this._finishLayer(e),e.addTo(this._map.pm._getContainingLayer()),this._fireCreate(e),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()}}},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),e.on("click",this._finishShape,this),e},_setTooltipText:function(){var t="";t=j(this._layer.getLatLngs().flat().length<=1?"tooltips.continueLine":"tooltips.finishLine"),this._hintMarker.setTooltipContent(t)}}),et.Polygon=et.Line.extend({initialize:function(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},_createMarker:function(t){var e=new L.Marker(t,{draggable:!1,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this._layerGroup.addLayer(e),1===this._layer.getLatLngs().flat().length?(e.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(e)-1,this.options.snappable&&this._cleanupSnapping()):e.on("click",(function(){return 1})),e},_setTooltipText:function(){var t="";t=j(this._layer.getLatLngs().flat().length<=2?"tooltips.continueLine":"tooltips.finishPoly"),this._hintMarker.setTooltipContent(t)},_finishShape:function(t){if((this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect))&&(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())){var e=this._layer.getLatLngs();if(!(e.length<=2)){var r=L.polygon(e,this.options.pathOptions);this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),this._fireCreate(r),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()}}}}),et.Rectangle=et.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(L.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.rectangle([[0,0],[0,0]],this.options.pathOptions),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._startMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:-100,opacity:this.options.cursorMarker?1:0}),this._setPane(this._startMarker,"vertexPane"),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=L.marker([0,0],{zIndexOffset:150,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.firstVertex"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){L.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var e=0;e<2;e+=1){var r=L.marker([0,0],{icon:L.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});this._setPane(r,"vertexPane"),r._pmTempLayer=!0,this._layerGroup.addLayer(r),this._styleMarkers.push(r)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();L.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach((function(t){L.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)})),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(j("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}},_syncRectangleSize:function(){var t=this,e=this._startMarker.getLatLng(),r=this._hintMarker.getLatLng(),i=L.PM.Utils._getRotatedRectangle(e,r,this.options.rectangleAngle||0,this._map);if(this._layer.setLatLngs(i),this.options.cursorMarker&&this._styleMarkers){var n=[];i.forEach((function(e){e.equals(t._startMarker.getLatLng())||e.equals(t._hintMarker.getLatLng())||n.push(e)})),n.forEach((function(e,r){t._styleMarkers[r].setLatLng(e)}))}},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),r=this._startMarker.getLatLng();if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){var i=L.rectangle([r,e],this.options.pathOptions);if(this.options.rectangleAngle){var n=L.PM.Utils._getRotatedRectangle(r,e,this.options.rectangleAngle||0,this._map);i.setLatLngs(n),i.pm&&i.pm._setAngle(this.options.rectangleAngle||0)}this._setPane(i,"layerPane"),this._finishLayer(i),i.addTo(this._map.pm._getContainingLayer()),this._fireCreate(i),this.disable(),this.options.continueDrawing&&this.enable()}}}),et.Circle=et.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){L.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circle([0,0],this.options.templineStyle),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=L.marker([0,0],{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t,e=this._centerMarker.getLatLng(),r=this._hintMarker.getLatLng();t=this._map.options.crs===L.CRS.Simple?this._map.distance(e,r):e.distanceTo(r),this.options.minRadiusCircle&&t<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&t>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(t)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._handleHintMarkerSnapping()},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(j("tooltips.finishCircle")),this._fireCenterPlaced())},_finishShape:function(t){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e,r=this._centerMarker.getLatLng(),i=this._hintMarker.getLatLng();e=this._map.options.crs===L.CRS.Simple?this._map.distance(r,i):r.distanceTo(i),this.options.minRadiusCircle&&e<this.options.minRadiusCircle?e=this.options.minRadiusCircle:this.options.maxRadiusCircle&&e>this.options.maxRadiusCircle&&(e=this.options.maxRadiusCircle);var n=at(at({},this.options.pathOptions),{},{radius:e}),a=L.circle(r,n);this._setPane(a,"layerPane"),this._finishLayer(a),a.addTo(this._map.pm._getContainingLayer()),a.pm&&a.pm._updateHiddenPolyCircle(),this._fireCreate(a),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),r=t.distanceTo(e);return this.options.minRadiusCircle&&r<this.options.minRadiusCircle?e=z(this._map,t,e,this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle&&(e=z(this._map,t,e,this.options.maxRadiusCircle)),e},_handleHintMarkerSnapping:function(){if(this._hintMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),r=t.distanceTo(e);(this.options.minRadiusCircle&&r<this.options.minRadiusCircle||this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}}),et.CircleMarker=et.Marker.extend({initialize:function(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1},enable:function(t){var e=this;L.Util.setOptions(this,t),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this.options.editable?(this._layerGroup=new L.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=L.circleMarker([0,0],this.options.templineStyle),this._setPane(this._layer,"layerPane"),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=L.marker([0,0],{icon:L.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._setPane(this._centerMarker,"vertexPane"),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=L.marker([0,0],{zIndexOffset:110,icon:L.divIcon({className:"marker-icon cursor-marker"})}),this._setPane(this._hintMarker,"vertexPane"),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&L.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.startCircle"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=L.polyline([],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this),this._map._container.style.cursor="crosshair"):(this._map.on("click",this._createMarker,this),this._hintMarker=L.circleMarker([0,0],this.options.templineStyle),this._setPane(this._hintMarker,"layerPane"),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(j("tooltips.placeCircleMarker"),{permanent:!0,offset:L.point(0,10),direction:"bottom",opacity:.8}).openTooltip()),this._map.on("mousemove",this._syncHintMarker,this),!this.options.editable&&this.options.markerEditable&&this._map.eachLayer((function(t){e.isRelevantMarker(t)&&t.pm.enable()})),this._layer.bringToBack(),this._fireDrawStart(),this._setGlobalDrawMode()},disable:function(){var t=this;this._enabled&&(this._enabled=!1,this.options.editable?(this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._map.eachLayer((function(e){t.isRelevantMarker(e)&&e.pm.disable()})),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),this._fireDrawEnd(),this._setGlobalDrawMode())},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();this._centerMarker.setLatLng(e),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(j("tooltips.finishCircle")),this._fireCenterPlaced())},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(r)},_syncHintMarker:function(t){if(this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable){var e=t;e.target=this._hintMarker,this._handleSnapping(e)}this._handleHintMarkerSnapping()},isRelevantMarker:function(t){return t instanceof L.CircleMarker&&!(t instanceof L.Circle)&&t.pm&&!t._pmTempLayer},_createMarker:function(t){if((!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer())&&t.latlng&&!this._layerIsDragging){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng(),r=L.circleMarker(e,this.options.pathOptions);this._setPane(r,"layerPane"),this._finishLayer(r),r.addTo(this._map.pm._getContainingLayer()),r.pm&&this.options.markerEditable&&r.pm.enable(),this._fireCreate(r),this._cleanupSnapping(),this.options.continueDrawing||this.disable()}},_finishShape:function(t){if(!this.options.requireSnapToFinish||this._hintMarker._snapped||this._isFirstLayer()){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._centerMarker.getLatLng(),r=this._hintMarker.getLatLng(),i=this._map.project(e).distanceTo(this._map.project(r));this.options.editable&&(this.options.minRadiusCircleMarker&&i<this.options.minRadiusCircleMarker?i=this.options.minRadiusCircleMarker:this.options.maxRadiusCircleMarker&&i>this.options.maxRadiusCircleMarker&&(i=this.options.maxRadiusCircleMarker));var n=lt(lt({},this.options.pathOptions),{},{radius:i}),a=L.circleMarker(e,n);this._setPane(a,"layerPane"),this._finishLayer(a),a.addTo(this._map.pm._getContainingLayer()),a.pm&&a.pm._updateHiddenPolyCircle(),this._fireCreate(a),this.disable(),this.options.continueDrawing&&this.enable()}},_getNewDestinationOfHintMarker:function(){var t=this._hintMarker.getLatLng();if(this.options.editable){var e=this._centerMarker.getLatLng(),r=this._map.project(e).distanceTo(this._map.project(t));this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker?t=z(this._map,e,t,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker&&(t=z(this._map,e,t,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker)))}return t},_handleHintMarkerSnapping:function(){if(this.options.editable){if(this._hintMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));(this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)}this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}},_pxRadiusToMeter:function(t){var e=this._centerMarker.getLatLng(),r=this._map.project(e),i=L.point(r.x+t,r.y);return this._map.unproject(i).distanceTo(e)}});var ut=r(1),ct=r.n(ut);function pt(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function ft(t,e){return t<e?-1:t>e?1:0}var dt=function(t,e,r,i,n){!function t(e,r,i,n,a){for(;n>i;){if(n-i>600){var o=n-i+1,s=r-i+1,l=Math.log(o),h=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*h*(o-h)/o)*(s-o/2<0?-1:1),c=Math.max(i,Math.floor(r-s*h/o+u)),p=Math.min(n,Math.floor(r+(o-s)*h/o+u));t(e,r,c,p,a)}var f=e[r],d=i,g=n;for(pt(e,i,r),a(e[n],f)>0&&pt(e,i,n);d<g;){for(pt(e,d,g),d++,g--;a(e[d],f)<0;)d++;for(;a(e[g],f)>0;)g--}0===a(e[i],f)?pt(e,i,g):(g++,pt(e,g,n)),g<=r&&(i=g+1),r<=g&&(n=g-1)}}(t,e,r||0,i||t.length-1,n||ft)};function gt(t,e){if(!(this instanceof gt))return new gt(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function mt(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function _t(t,e){yt(t,0,t.children.length,e,t)}function yt(t,e,r,i,n){n||(n=Pt(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,o=e;o<r;o++)a=t.children[o],vt(n,t.leaf?i(a):a);return n}function vt(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function bt(t,e){return t.minX-e.minX}function Lt(t,e){return t.minY-e.minY}function kt(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Mt(t){return t.maxX-t.minX+(t.maxY-t.minY)}function wt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function xt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Pt(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ct(t,e,r,i,n){for(var a,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(a=e+Math.ceil((r-e)/i/2)*i,dt(t,a,e,r,n),o.push(e,a,a,r))}gt.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!xt(t,e))return r;for(var n,a,o,s,l=[];e;){for(n=0,a=e.children.length;n<a;n++)o=e.children[n],xt(t,s=e.leaf?i(o):o)&&(e.leaf?r.push(o):wt(t,s)?this._all(o,r):l.push(o));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!xt(t,e))return!1;for(var i,n,a,o,s=[];e;){for(i=0,n=e.children.length;i<n;i++)if(a=e.children[i],xt(t,o=e.leaf?r(a):a)){if(e.leaf||wt(t,o))return!0;s.push(a)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Pt([]),this},remove:function(t,e){if(!t)return this;for(var r,i,n,a,o=this.data,s=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],r=h.pop(),a=!0),o.leaf&&-1!==(n=mt(t,o.children,e)))return o.children.splice(n,1),l.push(o),this._condense(l),this;a||o.leaf||!wt(o,s)?i?(r++,o=i.children[r],a=!1):o=null:(l.push(o),h.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:bt,compareMinY:Lt,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var n,a=r-e+1,o=this._maxEntries;if(a<=o)return _t(n=Pt(t.slice(e,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,i-1))),(n=Pt([])).leaf=!1,n.height=i;var s,l,h,u,c=Math.ceil(a/o),p=c*Math.ceil(Math.sqrt(o));for(Ct(t,e,r,p,this.compareMinX),s=e;s<=r;s+=p)for(Ct(t,s,h=Math.min(s+p-1,r),c,this.compareMinY),l=s;l<=h;l+=c)u=Math.min(l+c-1,h),n.children.push(this._build(t,l,u,i-1));return _t(n,this.toBBox),n},_chooseSubtree:function(t,e,r,i){for(var n,a,o,s,l,h,u,c,p,f;i.push(e),!e.leaf&&i.length-1!==r;){for(u=c=1/0,n=0,a=e.children.length;n<a;n++)l=kt(o=e.children[n]),p=t,f=o,(h=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l)<c?(c=h,u=l<u?l:u,s=o):h===c&&l<u&&(u=l,s=o);e=s||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,n=r?t:i(t),a=[],o=this._chooseSubtree(n,this.data,e,a);for(o.children.push(t),vt(o,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var r=t[e],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var a=this._chooseSplitIndex(r,n,i),o=Pt(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,_t(r,this.toBBox),_t(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=Pt([t,e]),this.data.height=t.height+1,this.data.leaf=!1,_t(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,n,a,o,s,l,h,u,c,p,f,d,g,m;for(l=h=1/0,i=e;i<=r-e;i++)n=yt(t,0,i,this.toBBox),a=yt(t,i,r,this.toBBox),c=n,p=a,f=void 0,d=void 0,g=void 0,m=void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),m=Math.min(c.maxY,p.maxY),o=Math.max(0,g-f)*Math.max(0,m-d),s=kt(n)+kt(a),o<l?(l=o,u=i,h=s<h?s:h):o===l&&s<h&&(h=s,u=i);return u},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:bt,n=t.leaf?this.compareMinY:Lt;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,n)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var n,a,o=this.toBBox,s=yt(t,0,e,o),l=yt(t,r-e,r,o),h=Mt(s)+Mt(l);for(n=e;n<r-e;n++)a=t.children[n],vt(s,t.leaf?o(a):a),h+=Mt(s);for(n=r-e-1;n>=e;n--)a=t.children[n],vt(l,t.leaf?o(a):a),h+=Mt(l);return h},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)vt(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():_t(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Et=gt;function St(t,e,r){if(!Tt(r=r||{}))throw new Error("options is invalid");var i=r.bbox,n=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&jt(i),n&&It(n);var a={type:"Feature"};return n&&(a.id=n),i&&(a.bbox=i),a.properties=e||{},a.geometry=t,a}function Ot(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Dt(t[0])||!Dt(t[1]))throw new Error("coordinates must contain numbers");return St({type:"Point",coordinates:t},e,r)}function Bt(t,e,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Dt(t[0][1])||!Dt(t[0][1]))throw new Error("coordinates must contain numbers");return St({type:"LineString",coordinates:t},e,r)}function Rt(t,e){if(!Tt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&jt(r),i&&It(i);var n={type:"FeatureCollection"};return i&&(n.id=i),r&&(n.bbox=r),n.features=t,n}function Dt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Tt(t){return!!t&&t.constructor===Object}function jt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Dt(t))throw new Error("bbox must only contain numbers")}))}function It(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Gt(t,e,r){if(null!==t)for(var i,n,a,o,s,l,h,u,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,m=d?t.features.length:1,_=0;_<m;_++){s=(u=!!(h=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var y=0;y<s;y++){var v=0,b=0;if(null!==(o=u?h.geometries[y]:h)){l=o.coordinates;var L=o.type;switch(c=!r||"Polygon"!==L&&"MultiPolygon"!==L?0:1,L){case null:break;case"Point":if(!1===e(l,p,_,v,b))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],p,_,v,b))return!1;p++,"MultiPoint"===L&&v++}"LineString"===L&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(n=0;n<l[i].length-c;n++){if(!1===e(l[i][n],p,_,v,b))return!1;p++}"MultiLineString"===L&&v++,"Polygon"===L&&b++}"Polygon"===L&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===L&&(b=0),n=0;n<l[i].length;n++){for(a=0;a<l[i][n].length-c;a++){if(!1===e(l[i][n][a],p,_,v,b))return!1;p++}b++}v++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===Gt(o.geometries[i],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function At(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function Nt(t,e){var r,i,n,a,o,s,l,h,u,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(r=0;r<g;r++){for(s=f?t.features[r].geometry:d?t.geometry:t,h=f?t.features[r].properties:d?t.properties:{},u=f?t.features[r].bbox:d?t.bbox:void 0,c=f?t.features[r].id:d?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(a=l?s.geometries[n]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,p,h,u,c))return!1;break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===e(a.geometries[i],p,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,h,u,c))return!1;p++}}function zt(t,e){Nt(t,(function(t,r,i,n,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(St(t,i,{bbox:n,id:a}),r,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var h=t.coordinates[l];if(!1===e(St({type:o,coordinates:h},i),r,l))return!1}}))}function Ft(t){var e=[t[0],t[1]],r=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,r,e]]}}}function Vt(t){var e=[1/0,1/0,-1/0,-1/0];return Gt(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}var Ut=function(t){var e=Et(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Ft(e)).bbox=e}else t.bbox=t.bbox?t.bbox:Vt(t);return Et.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var r=Ft(t);r.bbox=t,e.push(r)})):At(t,(function(t){t.bbox=t.bbox?t.bbox:Vt(t),e.push(t)})),Et.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Ft(e)).bbox=e}return Et.prototype.remove.call(this,t)},e.clear=function(){return Et.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:Et.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return Et.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:Et.prototype.all.call(this)}},e.toJSON=function(){return Et.prototype.toJSON.call(this)},e.fromJSON=function(t){return Et.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:Vt(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e},Yt={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function Xt(t,e){if(void 0===t||null===t)throw new Error("radians is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=Yt[e||"kilometers"];if(!r)throw new Error(e+" units is invalid");return t*r}function qt(t){if(null===t||void 0===t)throw new Error("degrees is required");return t%360*Math.PI/180}function Kt(t){return!!t&&t.constructor===Object}function Ht(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}var Jt=function(t,e,r){if(!Kt(r=r||{}))throw new Error("options is invalid");var i=r.units,n=Ht(t),a=Ht(e),o=qt(a[1]-n[1]),s=qt(a[0]-n[0]),l=qt(n[1]),h=qt(a[1]),u=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(s/2),2)*Math.cos(l)*Math.cos(h);return Xt(2*Math.atan2(Math.sqrt(u),Math.sqrt(1-u)),i)},Wt=function(t){var e=t[0],r=t[1],i=t[2],n=t[3];if(Jt(t.slice(0,2),[i,r])>=Jt(t.slice(0,2),[e,n])){var a=(r+n)/2;return[e,a-(i-e)/2,i,a+(i-e)/2]}var o=(e+i)/2;return[o-(n-r)/2,r,o+(n-r)/2,n]},Zt=function(t){var e=[1/0,1/0,-1/0,-1/0];return Gt(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e};function $t(t){return!!t&&t.constructor===Object}function Qt(t,e,r){if(null!==t)for(var i,n,a,o,s,l,h,u,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,m=d?t.features.length:1,_=0;_<m;_++){s=(u=!!(h=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var y=0;y<s;y++){var v=0,b=0;if(null!==(o=u?h.geometries[y]:h)){l=o.coordinates;var L=o.type;switch(c=!r||"Polygon"!==L&&"MultiPolygon"!==L?0:1,L){case null:break;case"Point":if(!1===e(l,p,_,v,b))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],p,_,v,b))return!1;p++,"MultiPoint"===L&&v++}"LineString"===L&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(n=0;n<l[i].length-c;n++){if(!1===e(l[i][n],p,_,v,b))return!1;p++}"MultiLineString"===L&&v++,"Polygon"===L&&b++}"Polygon"===L&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===L&&(b=0),n=0;n<l[i].length;n++){for(a=0;a<l[i][n].length-c;a++){if(!1===e(l[i][n][a],p,_,v,b))return!1;p++}b++}v++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===Qt(o.geometries[i],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}var te=function(t,e){if(!$t(e=e||{}))throw new Error("options is invalid");var r=e.precision,i=e.coordinates,n=e.mutate;if(r=void 0===r||null===r||isNaN(r)?6:r,i=void 0===i||null===i||isNaN(i)?3:i,!t)throw new Error("<geojson> is required");if("number"!=typeof r)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==n&&void 0!==n||(t=JSON.parse(JSON.stringify(t)));var a=Math.pow(10,r);return Qt(t,(function(t){!function(t,e,r){t.length>r&&t.splice(r,t.length);for(var i=0;i<t.length;i++)t[i]=Math.round(t[i]*e)/e}(t,a,i)})),t};function ee(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function re(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function ie(t,e){if(!t)throw new Error((e||"geojson")+" is required");if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error((e||"geojson")+" is invalid")}var ne=function(t){if(!t)throw new Error("geojson is required");var e=[];return zt(t,(function(t){!function(t,e){var r=[],i=t.geometry;switch(i.type){case"Polygon":r=re(i);break;case"LineString":r=[re(i)]}r.forEach((function(r){(function(t,e){var r=[];return t.reduce((function(t,i){var n,a,o,s,l,h,u=Bt([t,i],e);return u.bbox=(a=i,o=(n=t)[0],s=n[1],l=a[0],h=a[1],[o<l?o:l,s<h?s:h,o>l?o:l,s>h?s:h]),r.push(u),i})),r})(r,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),Rt(e)};function ae(t,e){var r=re(t),i=re(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=r[0][0],a=r[0][1],o=r[1][0],s=r[1][1],l=i[0][0],h=i[0][1],u=i[1][0],c=i[1][1],p=(c-h)*(o-n)-(u-l)*(s-a),f=(u-l)*(a-h)-(c-h)*(n-l),d=(o-n)*(a-h)-(s-a)*(n-l);if(0===p)return null;var g=f/p,m=d/p;return g>=0&&g<=1&&m>=0&&m<=1?Ot([n+g*(o-n),a+g*(s-a)]):null}var oe=function(t,e){var r={},i=[];if("LineString"===t.type&&(t=St(t)),"LineString"===e.type&&(e=St(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var n=ae(t,e);return n&&i.push(n),Rt(i)}var a=Ut();return a.load(ne(e)),At(ne(t),(function(t){At(a.search(t),(function(e){var n=ae(t,e);if(n){var a=re(n).join(",");r[a]||(r[a]=!0,i.push(n))}}))})),Rt(i)};function se(t){if(null===t||void 0===t)throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function le(t){if(null===t||void 0===t)throw new Error("degrees is required");return t%360*Math.PI/180}function he(t){return!!t&&t.constructor===Object}function ue(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function ce(t,e,r){if(!he(r=r||{}))throw new Error("options is invalid");if(!0===r.final)return function(t,e){var r=ce(e,t);return(r+180)%360}(t,e);var i=ue(t),n=ue(e),a=le(i[0]),o=le(n[0]),s=le(i[1]),l=le(n[1]),h=Math.sin(o-a)*Math.cos(l),u=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-a);return se(Math.atan2(h,u))}var pe=ce,fe={meters:6371008.8,metres:6371008.8,millimeters:6371008800,millimetres:6371008800,centimeters:637100880,centimetres:637100880,kilometers:6371.0088,kilometres:6371.0088,miles:3958.761333810546,nauticalmiles:6371008.8/1852,inches:6371008.8*39.37,yards:6371008.8/1.0936,feet:20902260.511392,radians:1,degrees:6371008.8/111325};function de(t,e,r){if(!be(r=r||{}))throw new Error("options is invalid");var i=r.bbox,n=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Le(i),n&&ke(n);var a={type:"Feature"};return n&&(a.id=n),i&&(a.bbox=i),a.properties=e||{},a.geometry=t,a}function ge(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!ve(t[0])||!ve(t[1]))throw new Error("coordinates must contain numbers");return de({type:"Point",coordinates:t},e,r)}function me(t,e){if(void 0===t||null===t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=fe[e||"kilometers"];if(!r)throw new Error(e+" units is invalid");return t/r}function _e(t){if(null===t||void 0===t)throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function ye(t){if(null===t||void 0===t)throw new Error("degrees is required");return t%360*Math.PI/180}function ve(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function be(t){return!!t&&t.constructor===Object}function Le(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!ve(t))throw new Error("bbox must only contain numbers")}))}function ke(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}var Me=function(t,e,r,i){if(!be(i=i||{}))throw new Error("options is invalid");var n=i.units,a=i.properties,o=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&t.length>=2&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t),s=ye(o[0]),l=ye(o[1]),h=ye(r),u=me(e,n),c=Math.asin(Math.sin(l)*Math.cos(u)+Math.cos(l)*Math.sin(u)*Math.cos(h));return ge([_e(s+Math.atan2(Math.sin(h)*Math.sin(u)*Math.cos(l),Math.cos(u)-Math.sin(l)*Math.sin(c))),_e(c)],a)};function we(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function xe(t,e){return t<e?-1:t>e?1:0}var Pe=function(t,e,r,i,n){!function t(e,r,i,n,a){for(;n>i;){if(n-i>600){var o=n-i+1,s=r-i+1,l=Math.log(o),h=.5*Math.exp(2*l/3),u=.5*Math.sqrt(l*h*(o-h)/o)*(s-o/2<0?-1:1),c=Math.max(i,Math.floor(r-s*h/o+u)),p=Math.min(n,Math.floor(r+(o-s)*h/o+u));t(e,r,c,p,a)}var f=e[r],d=i,g=n;for(we(e,i,r),a(e[n],f)>0&&we(e,i,n);d<g;){for(we(e,d,g),d++,g--;a(e[d],f)<0;)d++;for(;a(e[g],f)>0;)g--}0===a(e[i],f)?we(e,i,g):(g++,we(e,g,n)),g<=r&&(i=g+1),r<=g&&(n=g-1)}}(t,e,r||0,i||t.length-1,n||xe)};function Ce(t,e){if(!(this instanceof Ce))return new Ce(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Ee(t,e,r){if(!r)return e.indexOf(t);for(var i=0;i<e.length;i++)if(r(t,e[i]))return i;return-1}function Se(t,e){Oe(t,0,t.children.length,e,t)}function Oe(t,e,r,i,n){n||(n=Ae(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var a,o=e;o<r;o++)a=t.children[o],Be(n,t.leaf?i(a):a);return n}function Be(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Re(t,e){return t.minX-e.minX}function De(t,e){return t.minY-e.minY}function Te(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function je(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Ie(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Ge(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Ae(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Ne(t,e,r,i,n){for(var a,o=[e,r];o.length;)(r=o.pop())-(e=o.pop())<=i||(a=e+Math.ceil((r-e)/i/2)*i,Pe(t,a,e,r,n),o.push(e,a,a,r))}Ce.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],i=this.toBBox;if(!Ge(t,e))return r;for(var n,a,o,s,l=[];e;){for(n=0,a=e.children.length;n<a;n++)o=e.children[n],Ge(t,s=e.leaf?i(o):o)&&(e.leaf?r.push(o):Ie(t,s)?this._all(o,r):l.push(o));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(!Ge(t,e))return!1;for(var i,n,a,o,s=[];e;){for(i=0,n=e.children.length;i<n;i++)if(a=e.children[i],Ge(t,o=e.leaf?r(a):a)){if(e.leaf||Ie(t,o))return!0;s.push(a)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var n=this.data;this.data=i,i=n}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Ae([]),this},remove:function(t,e){if(!t)return this;for(var r,i,n,a,o=this.data,s=this.toBBox(t),l=[],h=[];o||l.length;){if(o||(o=l.pop(),i=l[l.length-1],r=h.pop(),a=!0),o.leaf&&-1!==(n=Ee(t,o.children,e)))return o.children.splice(n,1),l.push(o),this._condense(l),this;a||o.leaf||!Ie(o,s)?i?(r++,o=i.children[r],a=!1):o=null:(l.push(o),h.push(r),r=0,i=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:Re,compareMinY:De,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,i){var n,a=r-e+1,o=this._maxEntries;if(a<=o)return Se(n=Ae(t.slice(e,r+1)),this.toBBox),n;i||(i=Math.ceil(Math.log(a)/Math.log(o)),o=Math.ceil(a/Math.pow(o,i-1))),(n=Ae([])).leaf=!1,n.height=i;var s,l,h,u,c=Math.ceil(a/o),p=c*Math.ceil(Math.sqrt(o));for(Ne(t,e,r,p,this.compareMinX),s=e;s<=r;s+=p)for(Ne(t,s,h=Math.min(s+p-1,r),c,this.compareMinY),l=s;l<=h;l+=c)u=Math.min(l+c-1,h),n.children.push(this._build(t,l,u,i-1));return Se(n,this.toBBox),n},_chooseSubtree:function(t,e,r,i){for(var n,a,o,s,l,h,u,c,p,f;i.push(e),!e.leaf&&i.length-1!==r;){for(u=c=1/0,n=0,a=e.children.length;n<a;n++)l=Te(o=e.children[n]),p=t,f=o,(h=(Math.max(f.maxX,p.maxX)-Math.min(f.minX,p.minX))*(Math.max(f.maxY,p.maxY)-Math.min(f.minY,p.minY))-l)<c?(c=h,u=l<u?l:u,s=o):h===c&&l<u&&(u=l,s=o);e=s||e.children[0]}return e},_insert:function(t,e,r){var i=this.toBBox,n=r?t:i(t),a=[],o=this._chooseSubtree(n,this.data,e,a);for(o.children.push(t),Be(o,n);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(n,a,e)},_split:function(t,e){var r=t[e],i=r.children.length,n=this._minEntries;this._chooseSplitAxis(r,n,i);var a=this._chooseSplitIndex(r,n,i),o=Ae(r.children.splice(a,r.children.length-a));o.height=r.height,o.leaf=r.leaf,Se(r,this.toBBox),Se(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(r,o)},_splitRoot:function(t,e){this.data=Ae([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Se(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){var i,n,a,o,s,l,h,u,c,p,f,d,g,m;for(l=h=1/0,i=e;i<=r-e;i++)n=Oe(t,0,i,this.toBBox),a=Oe(t,i,r,this.toBBox),c=n,p=a,f=void 0,d=void 0,g=void 0,m=void 0,f=Math.max(c.minX,p.minX),d=Math.max(c.minY,p.minY),g=Math.min(c.maxX,p.maxX),m=Math.min(c.maxY,p.maxY),o=Math.max(0,g-f)*Math.max(0,m-d),s=Te(n)+Te(a),o<l?(l=o,u=i,h=s<h?s:h):o===l&&s<h&&(h=s,u=i);return u},_chooseSplitAxis:function(t,e,r){var i=t.leaf?this.compareMinX:Re,n=t.leaf?this.compareMinY:De;this._allDistMargin(t,e,r,i)<this._allDistMargin(t,e,r,n)&&t.children.sort(i)},_allDistMargin:function(t,e,r,i){t.children.sort(i);var n,a,o=this.toBBox,s=Oe(t,0,e,o),l=Oe(t,r-e,r,o),h=je(s)+je(l);for(n=e;n<r-e;n++)a=t.children[n],Be(s,t.leaf?o(a):a),h+=je(s);for(n=r-e-1;n>=e;n--)a=t.children[n],Be(l,t.leaf?o(a):a),h+=je(l);return h},_adjustParentBBoxes:function(t,e,r){for(var i=r;i>=0;i--)Be(e[i],t)},_condense:function(t){for(var e,r=t.length-1;r>=0;r--)0===t[r].children.length?r>0?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():Se(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var ze=Ce;function Fe(t,e,r){if(!qe(r=r||{}))throw new Error("options is invalid");var i=r.bbox,n=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");i&&Ke(i),n&&He(n);var a={type:"Feature"};return n&&(a.id=n),i&&(a.bbox=i),a.properties=e||{},a.geometry=t,a}function Ve(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Xe(t[0])||!Xe(t[1]))throw new Error("coordinates must contain numbers");return Fe({type:"Point",coordinates:t},e,r)}function Ue(t,e,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(!Xe(t[0][1])||!Xe(t[0][1]))throw new Error("coordinates must contain numbers");return Fe({type:"LineString",coordinates:t},e,r)}function Ye(t,e){if(!qe(e=e||{}))throw new Error("options is invalid");var r=e.bbox,i=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&Ke(r),i&&He(i);var n={type:"FeatureCollection"};return i&&(n.id=i),r&&(n.bbox=r),n.features=t,n}function Xe(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function qe(t){return!!t&&t.constructor===Object}function Ke(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach((function(t){if(!Xe(t))throw new Error("bbox must only contain numbers")}))}function He(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof t))throw new Error("id must be a number or a string")}function Je(t,e,r){if(null!==t)for(var i,n,a,o,s,l,h,u,c=0,p=0,f=t.type,d="FeatureCollection"===f,g="Feature"===f,m=d?t.features.length:1,_=0;_<m;_++){s=(u=!!(h=d?t.features[_].geometry:g?t.geometry:t)&&"GeometryCollection"===h.type)?h.geometries.length:1;for(var y=0;y<s;y++){var v=0,b=0;if(null!==(o=u?h.geometries[y]:h)){l=o.coordinates;var L=o.type;switch(c=!r||"Polygon"!==L&&"MultiPolygon"!==L?0:1,L){case null:break;case"Point":if(!1===e(l,p,_,v,b))return!1;p++,v++;break;case"LineString":case"MultiPoint":for(i=0;i<l.length;i++){if(!1===e(l[i],p,_,v,b))return!1;p++,"MultiPoint"===L&&v++}"LineString"===L&&v++;break;case"Polygon":case"MultiLineString":for(i=0;i<l.length;i++){for(n=0;n<l[i].length-c;n++){if(!1===e(l[i][n],p,_,v,b))return!1;p++}"MultiLineString"===L&&v++,"Polygon"===L&&b++}"Polygon"===L&&v++;break;case"MultiPolygon":for(i=0;i<l.length;i++){for("MultiPolygon"===L&&(b=0),n=0;n<l[i].length;n++){for(a=0;a<l[i][n].length-c;a++){if(!1===e(l[i][n][a],p,_,v,b))return!1;p++}b++}v++}break;case"GeometryCollection":for(i=0;i<o.geometries.length;i++)if(!1===Je(o.geometries[i],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function We(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function Ze(t,e){var r,i,n,a,o,s,l,h,u,c,p=0,f="FeatureCollection"===t.type,d="Feature"===t.type,g=f?t.features.length:1;for(r=0;r<g;r++){for(s=f?t.features[r].geometry:d?t.geometry:t,h=f?t.features[r].properties:d?t.properties:{},u=f?t.features[r].bbox:d?t.bbox:void 0,c=f?t.features[r].id:d?t.id:void 0,o=(l=!!s&&"GeometryCollection"===s.type)?s.geometries.length:1,n=0;n<o;n++)if(null!==(a=l?s.geometries[n]:s))switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(a,p,h,u,c))return!1;break;case"GeometryCollection":for(i=0;i<a.geometries.length;i++)if(!1===e(a.geometries[i],p,h,u,c))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,p,h,u,c))return!1;p++}}function $e(t,e){Ze(t,(function(t,r,i,n,a){var o,s=null===t?null:t.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return!1!==e(Fe(t,i,{bbox:n,id:a}),r,0)&&void 0}switch(s){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var l=0;l<t.coordinates.length;l++){var h=t.coordinates[l];if(!1===e(Fe({type:o,coordinates:h},i),r,l))return!1}}))}function Qe(t){var e=[t[0],t[1]],r=[t[0],t[3]],i=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],i,r,e]]}}}function tr(t){var e=[1/0,1/0,-1/0,-1/0];return Je(t,(function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])})),e}var er=function(t){var e=ze(t);return e.insert=function(t){if(Array.isArray(t)){var e=t;(t=Qe(e)).bbox=e}else t.bbox=t.bbox?t.bbox:tr(t);return ze.prototype.insert.call(this,t)},e.load=function(t){var e=[];return Array.isArray(t)?t.forEach((function(t){var r=Qe(t);r.bbox=t,e.push(r)})):We(t,(function(t){t.bbox=t.bbox?t.bbox:tr(t),e.push(t)})),ze.prototype.load.call(this,e)},e.remove=function(t){if(Array.isArray(t)){var e=t;(t=Qe(e)).bbox=e}return ze.prototype.remove.call(this,t)},e.clear=function(){return ze.prototype.clear.call(this)},e.search=function(t){return{type:"FeatureCollection",features:ze.prototype.search.call(this,this.toBBox(t))}},e.collides=function(t){return ze.prototype.collides.call(this,this.toBBox(t))},e.all=function(){return{type:"FeatureCollection",features:ze.prototype.all.call(this)}},e.toJSON=function(){return ze.prototype.toJSON.call(this)},e.fromJSON=function(t){return ze.prototype.fromJSON.call(this,t)},e.toBBox=function(t){var e;return{minX:(e=t.bbox?t.bbox:Array.isArray(t)&&4===t.length?t:tr(t))[0],minY:e[1],maxX:e[2],maxY:e[3]}},e};function rr(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}var ir=function(t){if(!t)throw new Error("geojson is required");var e=[];return $e(t,(function(t){!function(t,e){var r=[],i=t.geometry;switch(i.type){case"Polygon":r=rr(i);break;case"LineString":r=[rr(i)]}r.forEach((function(r){(function(t,e){var r=[];return t.reduce((function(t,i){var n,a,o,s,l,h,u=Ue([t,i],e);return u.bbox=(a=i,o=(n=t)[0],s=n[1],l=a[0],h=a[1],[o<l?o:l,s<h?s:h,o>l?o:l,s>h?s:h]),r.push(u),i})),r})(r,t.properties).forEach((function(t){t.id=e.length,e.push(t)}))}))}(t,e)})),Ye(e)};function nr(t,e){var r=rr(t),i=rr(e);if(2!==r.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==i.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var n=r[0][0],a=r[0][1],o=r[1][0],s=r[1][1],l=i[0][0],h=i[0][1],u=i[1][0],c=i[1][1],p=(c-h)*(o-n)-(u-l)*(s-a),f=(u-l)*(a-h)-(c-h)*(n-l),d=(o-n)*(a-h)-(s-a)*(n-l);if(0===p)return null;var g=f/p,m=d/p;return g>=0&&g<=1&&m>=0&&m<=1?Ve([n+g*(o-n),a+g*(s-a)]):null}var ar=function(t,e){var r={},i=[];if("LineString"===t.type&&(t=Fe(t)),"LineString"===e.type&&(e=Fe(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length){var n=nr(t,e);return n&&i.push(n),Ye(i)}var a=er();return a.load(ir(e)),We(ir(t),(function(t){We(a.search(t),(function(e){var n=nr(t,e);if(n){var a=rr(n).join(",");r[a]||(r[a]=!0,i.push(n))}}))})),Ye(i)},or=function(t,e,r){if(!qe(r=r||{}))throw new Error("options is invalid");var i=t.geometry?t.geometry.type:t.type;if("LineString"!==i&&"MultiLineString"!==i)throw new Error("lines must be LineString or MultiLineString");var n=Ve([1/0,1/0],{dist:1/0}),a=0;return $e(t,(function(t){for(var i=rr(t),o=0;o<i.length-1;o++){var s=Ve(i[o]);s.properties.dist=Jt(e,s,r);var l=Ve(i[o+1]);l.properties.dist=Jt(e,l,r);var h=Jt(s,l,r),u=Math.max(s.properties.dist,l.properties.dist),c=pe(s,l),p=Me(e,u,c+90,r),f=Me(e,u,c-90,r),d=ar(Ue([p.geometry.coordinates,f.geometry.coordinates]),Ue([s.geometry.coordinates,l.geometry.coordinates])),g=null;d.features.length>0&&((g=d.features[0]).properties.dist=Jt(e,g,r),g.properties.location=a+Jt(s,g,r)),s.properties.dist<n.properties.dist&&((n=s).properties.index=o,n.properties.location=a),l.properties.dist<n.properties.dist&&((n=l).properties.index=o+1,n.properties.location=a+h),g&&g.properties.dist<n.properties.dist&&((n=g).properties.index=o),a+=h}})),n};function sr(t,e){var r=[],i=Ut();return zt(e,(function(e){if(r.forEach((function(t,e){t.id=e})),r.length){var n=i.search(e);if(n.features.length){var a=hr(e,n);r=r.filter((function(t){return t.id!==a.id})),i.remove(a),At(lr(a,e),(function(t){r.push(t),i.insert(t)}))}}else(r=lr(t,e).features).forEach((function(t){t.bbox||(t.bbox=Wt(Zt(t)))})),i.load(Rt(r))})),Rt(r)}function lr(t,e){var r=[],i=re(t)[0],n=re(t)[t.geometry.coordinates.length-1];if(ur(i,ee(e))||ur(n,ee(e)))return Rt([t]);var a=Ut(),o=ne(t);a.load(o);var s=a.search(e);if(!s.features.length)return Rt([t]);var l=hr(e,s),h=function(t,e,r){var i=r;return At(t,(function(t,n){i=0===n&&void 0===r?t:e(i,t,n)})),i}(o,(function(t,i,n){var a=re(i)[1],o=ee(e);return n===l.id?(t.push(o),r.push(Bt(t)),ur(o,a)?[o]:[o,a]):(t.push(a),t)}),[i]);return h.length>1&&r.push(Bt(h)),Rt(r)}function hr(t,e){if(!e.features.length)throw new Error("lines must contain features");if(1===e.features.length)return e.features[0];var r,i=1/0;return At(e,(function(e){var n=or(e,t).properties.dist;n<i&&(r=e,i=n)})),r}function ur(t,e){return t[0]===e[0]&&t[1]===e[1]}var cr=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var r=ie(t),i=ie(e);if("LineString"!==r)throw new Error("line must be LineString");if("FeatureCollection"===i)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===i)throw new Error("splitter cannot be a GeometryCollection");var n=te(e,{precision:7});switch(i){case"Point":return lr(t,n);case"MultiPoint":return sr(t,n);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return sr(t,oe(t,n))}},pr=r(67),fr=r.n(pr),dr=r(27),gr=r.n(dr);function mr(t){var e={type:"Feature"};return e.geometry=t,e}function _r(t){return"Feature"===t.type?t.geometry:t}function yr(t){return t.geometry.coordinates}function vr(t){return mr({type:"Polygon",coordinates:t})}function br(t){return mr({type:"MultiPolygon",coordinates:t})}function Lr(t){t instanceof L.Polyline&&(t=t.toGeoJSON(15));var e=yr(t),r=function t(e){return Array.isArray(e)?1+t(e[0]):-1}(e),i=[];return r>1?e.forEach((function(t){i.push(function(t){return mr({type:"LineString",coordinates:t})}(t))})):i.push(t),i}function kr(t){var e=[];return t.eachLayer((function(t){e.push(yr(t.toGeoJSON(15)))})),function(t){return mr({type:"MultiLineString",coordinates:t})}(e)}function Mr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(l){n=!0,a=l}finally{try{i||null==s["return"]||s["return"]()}finally{if(n)throw a}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return wr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}et.Cut=et.Polygon.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape:function(){var t=this;if(this._editedLayers=[],this.options.allowSelfIntersection||(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),!this._doesSelfIntersect)){var e=this._layer.getLatLngs(),r=L.polygon(e,this.options.pathOptions);r._latlngInfos=this._layer._latlngInfo,this.cut(r),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach((function(e){var r=e.layer,i=e.originalLayer;t._fireCut(i,r,i),t._fireCut(t._map,r,i),i.pm._fireEdit()})),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable()}},cut:function(t){var e=this,r=this._map._layers,i=t._latlngInfos||[];Object.keys(r).map((function(t){return r[t]})).filter((function(t){return t.pm})).filter((function(t){return!t._pmTempLayer})).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore})).filter((function(t){return t instanceof L.Polyline})).filter((function(e){return e!==t})).filter((function(t){return t.pm.options.allowCutting})).filter((function(t){return!(e.options.layersToCut&&L.Util.isArray(e.options.layersToCut)&&e.options.layersToCut.length>0)||e.options.layersToCut.indexOf(t)>-1})).filter((function(t){return!e._layerGroup.hasLayer(t)})).filter((function(e){try{var r=!!ct()(t.toGeoJSON(15),e.toGeoJSON(15)).features.length>0;return r||e instanceof L.Polyline&&!(e instanceof L.Polygon)?r:(i=t.toGeoJSON(15),n=e.toGeoJSON(15),a=_r(i),o=_r(n),!(0===(s=gr.a.intersection(a.coordinates,o.coordinates)).length||!(1===s.length?vr(s[0]):br(s))))}catch(l){return e instanceof L.Polygon&&console.error("You can't cut polygons with self-intersections"),!1}var i,n,a,o,s})).forEach((function(r){var n;if(r instanceof L.Polygon){var a=(n=L.polygon(r.getLatLngs())).getLatLngs();i.forEach((function(t){if(t&&t.snapInfo){var r=t.latlng,i=e._calcClosestLayer(r,[n]);if(i&&i.segment&&i.distance<e.options.snapDistance){var o=i.segment;if(o&&2===o.length){var s=L.PM.Utils._getIndexFromSegment(a,o),l=s.indexPath,h=s.parentPath,u=s.newIndex;(l.length>1?R()(a,h):a).splice(u,0,r)}}}}))}else n=r;var o=e._cutLayer(t,n),s=L.geoJSON(o,r.options);if(1===s.getLayers().length){var l=s.getLayers();s=Mr(l,1)[0]}e._setPane(s,"layerPane");var h=s.addTo(e._map.pm._getContainingLayer());if(h.pm.enable(r.pm.options),h.pm.disable(),r._pmTempLayer=!0,t._pmTempLayer=!0,r.remove(),r.removeFrom(e._map.pm._getContainingLayer()),t.remove(),t.removeFrom(e._map.pm._getContainingLayer()),h.getLayers&&0===h.getLayers().length&&e._map.pm.removeLayer({target:h}),h instanceof L.LayerGroup?(h.eachLayer((function(t){e._addDrawnLayerProp(t)})),e._addDrawnLayerProp(h)):e._addDrawnLayerProp(h),e.options.layersToCut&&L.Util.isArray(e.options.layersToCut)&&e.options.layersToCut.length>0){var u=e.options.layersToCut.indexOf(r);u>-1&&e.options.layersToCut.splice(u,1)}e._editedLayers.push({layer:h,originalLayer:r})}))},_cutLayer:function(t,e){var r,i,n,a,o,s,l=L.geoJSON();if(e instanceof L.Polygon)i=e.toGeoJSON(15),n=t.toGeoJSON(15),a=_r(i),o=_r(n),r=0===(s=gr.a.difference(a.coordinates,o.coordinates)).length?null:1===s.length?vr(s[0]):br(s);else{var h=Lr(e);h.forEach((function(e){var r=cr(e,t.toGeoJSON(15));(r&&r.features.length>0?L.geoJSON(r):L.geoJSON(e)).getLayers().forEach((function(e){fr()(t.toGeoJSON(15),e.toGeoJSON(15))||e.addTo(l)}))})),r=h.length>1?kr(l):l.toGeoJSON(15)}return r}});var xr={enableLayerDrag:function(){var t;this.options.draggable&&(this.disable(),this._layerDragEnabled=!0,this._map||(this._map=this._layer._map),(this._layer instanceof L.Marker||this._layer instanceof L.ImageOverlay)&&L.DomEvent.on(this._getDOMElem(),"dragstart",this._stopDOMImageDrag),this._layer.dragging&&this._layer.dragging.disable(),this._tempDragCoord=null,(null===(t=this._layer._map)||void 0===t?void 0:t.options.preferCanvas)?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0,this._layer.on("mousedown",this._dragMixinOnMouseDown,this))},disableLayerDrag:function(){var t;this._layerDragEnabled=!1,(null===(t=this._layer._map)||void 0===t?void 0:t.options.preferCanvas)?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._safeToCacheDragState=!1,this._layer.dragging&&this._layer.dragging.disable(),this._layer.off("mousedown",this._dragMixinOnMouseDown,this)},dragging:function(){return this._dragging},layerDragEnabled:function(){return!!this._layerDragEnabled},_dragMixinOnMouseDown:function(t){if(!(t.originalEvent.button>0)){this._overwriteEventIfItComesFromMarker(t);var e=t._fromLayerSync,r=this._syncLayers("_dragMixinOnMouseDown",t);this._layer instanceof L.Marker&&(!this.options.snappable||e||r?this._disableSnapping():this._initSnappableMarkers()),this._layer instanceof L.CircleMarker&&!(this._layer instanceof L.Circle)&&(!this.options.snappable||e||r?this._layer.pm.options.editable?this._layer.pm._disableSnapping():this._layer.pm._disableSnappingDrag():this._layer.pm.options.editable||this._initSnappableMarkersDrag()),this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,this._layer._map.on("mouseup",this._dragMixinOnMouseUp,this),this._layer._map.on("mousemove",this._dragMixinOnMouseMove,this)}},_dragMixinOnMouseMove:function(t){this._overwriteEventIfItComesFromMarker(t);var e=this._getDOMElem();this._syncLayers("_dragMixinOnMouseMove",t),this._dragging||(this._dragging=!0,L.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer instanceof L.Marker||this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._fireDragStart()),this._onLayerDrag(t),this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle()},_dragMixinOnMouseUp:function(t){var e=this,r=this._getDOMElem();return this._syncLayers("_dragMixinOnMouseUp",t),this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,this._layer._map.off("mousemove",this._dragMixinOnMouseMove,this),this._layer._map.off("mouseup",this._dragMixinOnMouseUp,this),!!this._dragging&&(this._layer instanceof L.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),window.setTimeout((function(){e._dragging=!1,L.DomUtil.removeClass(r,"leaflet-pm-dragging"),e._fireDragEnd(),e._fireEdit(),e._layerEdited=!0}),10),!0)},_onLayerDrag:function(t){var e=t.latlng,r=e.lat-this._tempDragCoord.lat,i=e.lng-this._tempDragCoord.lng,n=function t(e){return e.map((function(e){return Array.isArray(e)?t(e):{lat:e.lat+r,lng:e.lng+i}}))};if(this._layer instanceof L.Circle||this._layer instanceof L.CircleMarker&&this._layer.options.editable){var a=n([this._layer.getLatLng()]);this._layer.setLatLng(a[0])}else if(this._layer instanceof L.CircleMarker||this._layer instanceof L.Marker){var o=this._layer.getLatLng();this._layer._snapped&&(o=this._layer._orgLatLng);var s=n([o]);this._layer.setLatLng(s[0])}else if(this._layer instanceof L.ImageOverlay){var l=n([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]);this._layer.setBounds(l)}else{var h=n(this._layer.getLatLngs());this._layer.setLatLngs(h)}this._tempDragCoord=e,t.layer=this._layer,this._fireDrag(t)},addDraggingClass:function(){var t=this._getDOMElem();t&&L.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass:function(){var t=this._getDOMElem();t&&L.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem:function(){var t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image?t=this._layer._image:this._layer._icon&&(t=this._layer._icon),t},_overwriteEventIfItComesFromMarker:function(t){t.target.getLatLng&&(!t.target._radius||t.target._radius<=10)&&(t.containerPoint=this._map.mouseEventToContainerPoint(t.originalEvent),t.latlng=this._map.containerPointToLatLng(t.containerPoint))},_syncLayers:function(t,e){var r=this;if(this.enabled())return!1;if(!e._fromLayerSync&&this._layer===e.target&&this.options.syncLayersOnDrag){e._fromLayerSync=!0;var i=[];if(L.Util.isArray(this.options.syncLayersOnDrag))i=this.options.syncLayersOnDrag,this.options.syncLayersOnDrag.forEach((function(t){t instanceof L.LayerGroup&&(i=i.concat(t.pm.getLayers(!0)))}));else if(!0===this.options.syncLayersOnDrag&&this._parentLayerGroup)for(var n in this._parentLayerGroup){var a=this._parentLayerGroup[n];a.pm&&(i=a.pm.getLayers(!0))}return L.Util.isArray(i)&&i.length>0&&(i=i.filter((function(t){return!!t.pm})).filter((function(t){return!!t.pm.options.draggable}))).forEach((function(i){i!==r._layer&&i.pm[t]&&(i._snapped=!1,i.pm[t](e))})),i.length>0}return!1},_stopDOMImageDrag:function(t){return t.preventDefault(),!1}};function Pr(t,e){e instanceof L.Layer&&(e=e.getLatLng());var r=t.getMaxZoom();return r===1/0&&(r=t.getZoom()),t.project(e,r)}function Cr(t,e){var r=t.getMaxZoom();return r===1/0&&(r=t.getZoom()),t.unproject(e,r)}var Er={_onRotateStart:function(t){this._preventRenderingMarkers(!0),this._rotationOriginLatLng=this._getRotationCenter().clone(),this._rotationOriginPoint=Pr(this._map,this._rotationOriginLatLng),this._rotationStartPoint=Pr(this._map,t.target.getLatLng()),this._initialRotateLatLng=F(this._layer),this._startAngle=this.getAngle();var e=F(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._fireRotationStart(this._rotationLayer,e),this._fireRotationStart(this._map,e)},_onRotate:function(t){var e=Pr(this._map,t.target.getLatLng()),r=this._rotationStartPoint,i=this._rotationOriginPoint,n=Math.atan2(e.y-i.y,e.x-i.x)-Math.atan2(r.y-i.y,r.x-i.x);this._layer.setLatLngs(this._rotateLayer(n,this._initialRotateLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var a=this;!function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(i>-1&&r.push(i),L.Util.isArray(e[0]))e.forEach((function(e,i){return t(e,r.slice(),i)}));else{var n=R()(a._markers,r);e.forEach((function(t,e){n[e].setLatLng(t)}))}}(this._layer.getLatLngs());var o=F(this._rotationLayer);this._rotationLayer.setLatLngs(this._rotateLayer(n,this._rotationLayer.pm._rotateOrgLatLng,this._rotationOriginLatLng,L.PM.Matrix.init(),this._map));var s=180*n/Math.PI,l=(s=s<0?s+360:s)+this._startAngle;this._setAngle(l),this._rotationLayer.pm._setAngle(l),this._fireRotation(this._rotationLayer,s,o),this._fireRotation(this._map,s,o)},_onRotateEnd:function(){var t=this._startAngle;delete this._rotationOriginLatLng,delete this._rotationOriginPoint,delete this._rotationStartPoint,delete this._initialRotateLatLng,delete this._startAngle;var e=F(this._rotationLayer,this._rotationLayer.pm._rotateOrgLatLng);this._rotationLayer.pm._rotateOrgLatLng=F(this._rotationLayer),this._fireRotationEnd(this._rotationLayer,t,e),this._fireRotationEnd(this._map,t,e),this._rotationLayer.pm._fireEdit(this._rotationLayer,"Rotation"),this._preventRenderingMarkers(!1)},_rotateLayer:function(t,e,r,i,n){var a=Pr(n,r);return this._matrix=i.clone().rotate(t,a).flip(),function t(e,r,i){var n=i.getMaxZoom();if(n===1/0&&(n=i.getZoom()),L.Util.isArray(e)){var a=[];return e.forEach((function(e){a.push(t(e,r,i))})),a}return e instanceof L.LatLng?function(t,e,r,i){return r.unproject(e.transform(r.project(t,i)),i)}(e,r,i,n):null}(e,this._matrix,n)},_setAngle:function(t){t=t<0?t+360:t,this._angle=t%360},_getRotationCenter:function(){var t=L.polygon(this._layer.getLatLngs(),{stroke:!1,fill:!1,pmIgnore:!0}).addTo(this._layer._map),e=t.getCenter();return t.removeFrom(this._layer._map),e},enableRotate:function(){this.options.allowRotation?(this._rotatePoly=L.polygon(this._layer.getLatLngs(),{fill:!1,stroke:!1,pmIgnore:!1,snapIgnore:!0}).addTo(this._layer._map),this._rotatePoly.pm._setAngle(this.getAngle()),this._rotatePoly.pm.setOptions(this._layer._map.pm.getGlobalOptions()),this._rotatePoly.pm.setOptions({rotate:!0,snappable:!1,hideMiddleMarkers:!0}),this._rotatePoly.pm._rotationLayer=this._layer,this._rotatePoly.pm.enable(),this._rotateOrgLatLng=F(this._layer),this._rotateEnabled=!0,this._fireRotationEnable(this._layer),this._fireRotationEnable(this._layer._map)):this.disableRotate()},disableRotate:function(){this.rotateEnabled()&&(this._rotatePoly.pm.disable(),this._rotatePoly.remove(),this._rotatePoly.pm.setOptions({rotate:!1}),this._rotatePoly=void 0,this._rotateOrgLatLng=void 0,this._rotateEnabled=!1,this._fireRotationDisable(this._layer),this._fireRotationDisable(this._layer._map))},rotateEnabled:function(){return this._rotateEnabled},rotateLayer:function(t){var e=t*(Math.PI/180);this._layer.setLatLngs(this._rotateLayer(e,this._layer.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._layer._map)),this._rotateOrgLatLng=L.polygon(this._layer.getLatLngs()).getLatLngs(),this._setAngle(this.getAngle()+t),this.rotateEnabled()&&this._rotatePoly&&this._rotatePoly.pm.enabled()&&(this._rotatePoly.setLatLngs(this._rotateLayer(e,this._rotatePoly.getLatLngs(),this._getRotationCenter(),L.PM.Matrix.init(),this._rotatePoly._map)),this._rotatePoly.pm._initMarkers())},rotateLayerToAngle:function(t){var e=t-this.getAngle();this.rotateLayer(e)},getAngle:function(){return this._angle||0}},Sr=L.Class.extend({includes:[xr,tt,Er,E],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,preventMarkerRemoval:!1,removeLayerBelowMinVertexCount:!0,limitMarkersToCount:-1,hideMiddleMarkers:!1,snapSegment:!0,syncLayersOnDrag:!1,draggable:!0,allowEditing:!0,allowRemoval:!0,allowCutting:!0,allowRotation:!0,addVertexOn:"click",removeVertexOn:"contextmenu",removeVertexValidation:void 0,addVertexValidation:void 0,moveVertexValidation:void 0},setOptions:function(t){L.Util.setOptions(this,t)},getOptions:function(){return this.options},applyOptions:function(){},isPolygon:function(){return this._layer instanceof L.Polygon},getShape:function(){return this._shape},_setPane:function(t,e){"layerPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.layerPane||"overlayPane":"vertexPane"===e?t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.vertexPane||"markerPane":"markerPane"===e&&(t.options.pane=this._map.pm.globalOptions.panes&&this._map.pm.globalOptions.panes.markerPane||"markerPane")},remove:function(){(this._map||this._layer._map).pm.removeLayer({target:this._layer})},_vertexValidation:function(t,e){var r=e.target,i={layer:this._layer,marker:r,event:e},n="";return"move"===t?n="moveVertexValidation":"add"===t?n="addVertexValidation":"remove"===t&&(n="removeVertexValidation"),this.options[n]&&"function"==typeof this.options[n]&&!this.options[n](i)?("move"===t&&(r._cancelDragEventChain=r.getLatLng()),!1):(r._cancelDragEventChain=null,!0)},_vertexValidationDrag:function(t){return!t._cancelDragEventChain||(t._latlng=t._cancelDragEventChain,t.update(),!1)},_vertexValidationDragEnd:function(t){return!t._cancelDragEventChain||(t._cancelDragEventChain=null,!1)}});function Or(t){return function(t){if(Array.isArray(t))return Br(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Br(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Br(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}Sr.LayerGroup=L.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.getLayers(),this._getMap(),this._layers.forEach((function(t){return e._initLayer(t)})),this._layerGroup.on("layeradd",L.Util.throttle((function(t){if(!t.layer._pmTempLayer){e._layers=e.getLayers();var r=e._layers.filter((function(t){return!t.pm._parentLayerGroup||!(e._layerGroup._leaflet_id in t.pm._parentLayerGroup)}));r.forEach((function(t){e._initLayer(t)})),r.length>0&&e._getMap()&&e._getMap().pm.globalEditModeEnabled()&&e.enabled()&&e.enable(e.getOptions())}}),100,this),this),this._layerGroup.on("layerremove",(function(t){e._removeLayerFromGroup(t.target)}),this),this._layerGroup.on("layerremove",L.Util.throttle((function(t){t.target._pmTempLayer||(e._layers=e.getLayers())}),100,this),this)},enable:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((function(r){r instanceof L.LayerGroup?-1===e.indexOf(r._leaflet_id)&&(e.push(r._leaflet_id),r.pm.enable(t,e)):r.pm.enable(t)}))},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(this._layers=this.getLayers()),this._layers.forEach((function(e){e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.disable(t)):e.pm.disable()}))},enabled:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];0===t.length&&(this._layers=this.getLayers());var e=this._layers.find((function(e){return e instanceof L.LayerGroup?-1===t.indexOf(e._leaflet_id)&&(t.push(e._leaflet_id),e.pm.enabled(t)):e.pm.enabled()}));return!!e},toggleEdit:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this._options=t,this._layers.forEach((function(r){r instanceof L.LayerGroup?-1===e.indexOf(r._leaflet_id)&&(e.push(r._leaflet_id),r.pm.toggleEdit(t,e)):r.pm.toggleEdit(t)}))},_initLayer:function(t){var e=L.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup:function(t){if(t.pm&&t.pm._layerGroup){var e=L.Util.stamp(this._layerGroup);delete t.pm._layerGroup[e]}},dragging:function(){if(this._layers=this.getLayers(),this._layers){var t=this._layers.find((function(t){return t.pm.dragging()}));return!!t}return!1},getOptions:function(){return this.options},_getMap:function(){var t;return this._map||(null===(t=this._layers.find((function(t){return!!t._map})))||void 0===t?void 0:t._map)||null},getLayers:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=[];return t?this._layerGroup.getLayers().forEach((function(t){n.push(t),t instanceof L.LayerGroup&&-1===i.indexOf(t._leaflet_id)&&(i.push(t._leaflet_id),n=n.concat(t.pm.getLayers(!0,!0,!0,i)))})):n=this._layerGroup.getLayers(),r&&(n=n.filter((function(t){return!(t instanceof L.LayerGroup)}))),e&&(n=(n=(n=n.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore}))),n},setOptions:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];0===e.length&&(this._layers=this.getLayers()),this.options=t,this._layers.forEach((function(r){r.pm&&(r instanceof L.LayerGroup?-1===e.indexOf(r._leaflet_id)&&(e.push(r._leaflet_id),r.pm.setOptions(t,e)):r.pm.setOptions(t))}))}}),Sr.Marker=Sr.extend({_shape:"Marker",initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this.options.allowEditing?this.enabled()||(this.applyOptions(),this._enabled=!0,this._fireEnable()):this.disable()},disable:function(){this._enabled=!1,this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this.enabled()&&(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable())},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker:function(t){var e=t.target;e.remove(),this._fireRemove(e),this._fireRemove(this._map,e)},_onDragEnd:function(){this._fireEdit(),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}});var Rr={filterMarkerGroup:function(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),this.options.limitMarkersToCount>-1&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.applyLimitFilters,this))},_removeMarkerLimitEvents:function(){this._map.off("mousemove",this.applyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache:function(){var t=[].concat(Or(this._markerGroup.getLayers()),Or(this.markerCache));this.markerCache=t.filter((function(t,e,r){return r.indexOf(t)===e}))},renderLimits:function(t){var e=this;this.markerCache.forEach((function(r){t.includes(r)?e._markerGroup.addLayer(r):e._markerGroup.removeLayer(r)}))},applyLimitFilters:function(t){var e=t.latlng,r=void 0===e?{lat:0,lng:0}:e;if(!this._preventRenderMarkers){var i=Or(this._filterClosestMarkers(r));this.renderLimits(i)}},_filterClosestMarkers:function(t){var e=Or(this.markerCache),r=this.options.limitMarkersToCount;return e.sort((function(e,r){return e._latlng.distanceTo(t)-r._latlng.distanceTo(t)})),e.filter((function(t,e){return!(r>-1)||e<r}))},_preventRenderMarkers:!1,_preventRenderingMarkers:function(t){this._preventRenderMarkers=!!t}};function Dr(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var r=[],i=!0,n=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(r.push(o.value),!e||r.length!==e);i=!0);}catch(l){n=!0,a=l}finally{try{i||null==s["return"]||s["return"]()}finally{if(n)throw a}}return r}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Tr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tr(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Tr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}Sr.Line=Sr.extend({includes:[Rr],_shape:"Line",initialize:function(t){this._layer=t,this._enabled=!1},enable:function(t){L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()&&this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:("#f00000ff"!==this._layer.options.color?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),this._fireEnable()):this.disable())},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._markerGroup.clearLayers(),t.pm._markerGroup.removeFrom(this._map),this._layer.off("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);var e=t._path?t._path:this._layer._renderer._container;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this.hasSelfIntersection()&&L.DomUtil.removeClass(e,"leaflet-pm-invalid"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),!0},enabled:function(){return this._enabled},toggleEdit:function(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_onLayerRemove:function(t){this.disable(t.target)},_initMarkers:function(){var t=this,e=this._map,r=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,this._markers=function e(r){if(Array.isArray(r[0]))return r.map(e,t);var i=r.map(t._createMarker,t);return!0!==t.options.hideMiddleMarkers&&r.map((function(e,n){var a=t.isPolygon()?(n+1)%r.length:n+1;return t._createMiddleMarker(i[n],i[a])})),i}(r),this.filterMarkerGroup(),e.addLayer(this._markerGroup)},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._pmTempLayer=!0,this.options.rotate?(e.on("dragstart",this._onRotateStart,this),e.on("drag",this._onRotate,this),e.on("dragend",this._onRotateEnd,this)):(e.on("click",this._onVertexClick,this),e.on("dragstart",this._onMarkerDragStart,this),e.on("move",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||e.on(this.options.removeVertexOn,this._removeMarker,this)),this._markerGroup.addLayer(e),e},_createMiddleMarker:function(t,e){if(!t||!e)return!1;var r=L.PM.Utils.calcMiddleLatLng(this._map,t.getLatLng(),e.getLatLng()),i=this._createMarker(r),n=L.divIcon({className:"marker-icon marker-icon-middle"});return i.setIcon(n),i.leftM=t,i.rightM=e,t._middleMarkerNext=i,e._middleMarkerPrev=i,i.on(this.options.addVertexOn,this._onMiddleMarkerClick,this),i.on("movestart",this._onMiddleMarkerMoveStart,this),i},_onMiddleMarkerClick:function(t){var e=t.target;if(this._vertexValidation("add",t)){var r=L.divIcon({className:"marker-icon"});e.setIcon(r),this._addMarker(e,e.leftM,e.rightM)}},_onMiddleMarkerMoveStart:function(t){var e=t.target;e.on("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidation("add",t)?(e._dragging=!0,this._addMarker(e,e.leftM,e.rightM)):e.on("move",this._onMiddleMarkerMovePrevent,this)},_onMiddleMarkerMovePrevent:function(t){var e=t.target;this._vertexValidationDrag(e)},_onMiddleMarkerMoveEnd:function(t){var e=t.target;if(e.off("move",this._onMiddleMarkerMovePrevent,this),e.off("moveend",this._onMiddleMarkerMoveEnd,this),this._vertexValidationDragEnd(e)){var r=L.divIcon({className:"marker-icon"});e.setIcon(r),setTimeout((function(){delete e._dragging}),100)}},_addMarker:function(t,e,r){t.off("movestart",this._onMiddleMarkerMoveStart,this),t.off(this.options.addVertexOn,this._onMiddleMarkerClick,this);var i=t.getLatLng(),n=this._layer._latlngs;delete t.leftM,delete t.rightM;var a=this.findDeepMarkerIndex(this._markers,e),o=a.indexPath,s=a.index,l=a.parentPath,h=o.length>1?R()(n,l):n,u=o.length>1?R()(this._markers,l):this._markers;h.splice(s+1,0,i),u.splice(s+1,0,t),this._layer.setLatLngs(n),!0!==this.options.hideMiddleMarkers&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,r)),this._fireEdit(),this._layerEdited=!0,this._fireVertexAdded(t,this.findDeepMarkerIndex(this._markers,t).indexPath,i),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection:function(){return it()(this._layer.toGeoJSON(15)).features.length>0},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this._layer;if(this.hasSelfIntersection()){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed)return;t?this._flashLayer():(e.setStyle({color:"#f00000ff"}),this.isRed=!0),this._fireIntersect(it()(this._layer.toGeoJSON(15)))}else e.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1)},_flashLayer:function(){var t=this;this.cachedColor||(this.cachedColor=this._layer.options.color),this._layer.setStyle({color:"#f00000ff"}),this.isRed=!0,window.setTimeout((function(){t._layer.setStyle({color:t.cachedColor}),t.isRed=!1}),200)},_updateDisabledMarkerStyle:function(t,e){var r=this;t.forEach((function(t){if(Array.isArray(t))return r._updateDisabledMarkerStyle(t,e);t._icon&&(e&&!r._checkMarkerAllowedToDrag(t)?L.DomUtil.addClass(t._icon,"vertexmarker-disabled"):L.DomUtil.removeClass(t._icon,"vertexmarker-disabled"))}))},_removeMarker:function(t){var e=t.target;if(this._vertexValidation("remove",t)){if(!this.options.allowSelfIntersection){var r=this._layer.getLatLngs();this._coordsBeforeEdit=JSON.parse(JSON.stringify(r))}var i=this._layer.getLatLngs(),n=this.findDeepMarkerIndex(this._markers,e),a=n.indexPath,o=n.index,s=n.parentPath;if(a){var l=a.length>1?R()(i,s):i,h=a.length>1?R()(this._markers,s):this._markers;if(this.options.removeLayerBelowMinVertexCount||!(l.length<=2||this.isPolygon()&&l.length<=3)){l.splice(o,1),this._layer.setLatLngs(i),this.isPolygon()&&l.length<=2&&l.splice(0,l.length);var u=!1;if(l.length<=1&&(l.splice(0,l.length),this._layer.setLatLngs(i),this.disable(),this.enable(this.options),u=!0),I(i)&&this._layer.remove(),i=G(i),this._layer.setLatLngs(i),this._markers=G(this._markers),!u&&(h=a.length>1?R()(this._markers,s):this._markers,e._middleMarkerPrev&&this._markerGroup.removeLayer(e._middleMarkerPrev),e._middleMarkerNext&&this._markerGroup.removeLayer(e._middleMarkerNext),this._markerGroup.removeLayer(e),h)){var c,p;if(this.isPolygon()?(c=(o+1)%h.length,p=(o+(h.length-1))%h.length):(p=o-1<0?void 0:o-1,c=o+1>=h.length?void 0:o+1),c!==p){var f=h[p],d=h[c];!0!==this.options.hideMiddleMarkers&&this._createMiddleMarker(f,d)}h.splice(o,1)}this._fireEdit(),this._layerEdited=!0,this._fireVertexRemoved(e,a)}else this._flashLayer()}}},findDeepMarkerIndex:function(t,e){var r;t.some(function t(i){return function(n,a){var o=i.concat(a);return n._leaflet_id===e._leaflet_id?(r=o,!0):Array.isArray(n)&&n.some(t(o))}}([]));var i={};return r&&(i={indexPath:r,index:r[r.length-1],parentPath:r.slice(0,r.length-1)}),i},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),r=t.getLatLng(),i=this.findDeepMarkerIndex(this._markers,t),n=i.indexPath,a=i.index,o=i.parentPath;(n.length>1?R()(e,o):e).splice(a,1,r),this._layer.setLatLngs(e)},_getNeighborMarkers:function(t){var e=this.findDeepMarkerIndex(this._markers,t),r=e.indexPath,i=e.index,n=e.parentPath,a=r.length>1?R()(this._markers,n):this._markers,o=(i+1)%a.length;return{prevMarker:a[(i+(a.length-1))%a.length],nextMarker:a[o]}},_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),r=e.prevMarker,i=e.nextMarker,n=L.polyline([r.getLatLng(),t.getLatLng()]),a=L.polyline([t.getLatLng(),i.getLatLng()]),o=ct()(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length,s=ct()(this._layer.toGeoJSON(15),a.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?s+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(o+=1),!(o<=2&&s<=2)},_onMarkerDragStart:function(t){var e=t.target;if(this.cachedColor||(this.cachedColor=this._layer.options.color),this._vertexValidation("move",t)){var r=this.findDeepMarkerIndex(this._markers,e).indexPath;this._fireMarkerDragStart(t,r),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs()),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null}},_onMarkerDrag:function(t){var e=t.target;if(this._vertexValidationDrag(e)){var r=this.findDeepMarkerIndex(this._markers,e),i=r.indexPath,n=r.index,a=r.parentPath;if(i){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&!1===this._markerAllowedToDrag)return this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),void this._handleLayerStyle();this.updatePolygonCoordsFromMarkerDrag(e);var o=i.length>1?R()(this._markers,a):this._markers,s=(n+1)%o.length,l=(n+(o.length-1))%o.length,h=e.getLatLng(),u=o[l].getLatLng(),c=o[s].getLatLng();if(e._middleMarkerNext){var p=L.PM.Utils.calcMiddleLatLng(this._map,h,c);e._middleMarkerNext.setLatLng(p)}if(e._middleMarkerPrev){var f=L.PM.Utils.calcMiddleLatLng(this._map,h,u);e._middleMarkerPrev.setLatLng(f)}this.options.allowSelfIntersection||this._handleLayerStyle(),this._fireMarkerDrag(t,i)}}},_onMarkerDragEnd:function(t){var e=t.target;if(this._vertexValidationDragEnd(e)){var r=this.findDeepMarkerIndex(this._markers,e).indexPath,i=this.hasSelfIntersection();i&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(i=!1);var n=!this.options.allowSelfIntersection&&i;if(this._fireMarkerDragEnd(t,r,n),n)return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),this.options.snappable&&this._initSnappableMarkers(),this._handleLayerStyle(),void this._fireLayerReset(t,r);!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit(),this._layerEdited=!0}},_onVertexClick:function(t){var e=t.target;if(!e._dragging){var r=this.findDeepMarkerIndex(this._markers,e).indexPath;this._fireVertexClick(t,r)}}}),Sr.Polygon=Sr.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),r=e.prevMarker,i=e.nextMarker,n=L.polyline([r.getLatLng(),t.getLatLng()]),a=L.polyline([t.getLatLng(),i.getLatLng()]),o=ct()(this._layer.toGeoJSON(15),n.toGeoJSON(15)).features.length,s=ct()(this._layer.toGeoJSON(15),a.toGeoJSON(15)).features.length;return!(o<=2&&s<=2)}}),Sr.Rectangle=Sr.Polygon.extend({_shape:"Rectangle",_initMarkers:function(){var t=this,e=this._map,r=this._findCorners();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new L.LayerGroup,this._markerGroup._pmTempLayer=!0,e.addLayer(this._markerGroup),this._markers=[],this._markers[0]=r.map(this._createMarker,this);var i=Dr(this._markers,1);this._cornerMarkers=i[0],this._layer.getLatLngs()[0].forEach((function(e,r){var i=t._cornerMarkers.find((function(t){return t._index===r}));i&&i.setLatLng(e)}))},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker:function(t,e){var r=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(r,"vertexPane"),r._origLatLng=t,r._index=e,r._pmTempLayer=!0,this._markerGroup.addLayer(r),r},_addMarkerEvents:function(){var t=this;this._markers[0].forEach((function(e){e.on("dragstart",t._onMarkerDragStart,t),e.on("drag",t._onMarkerDrag,t),e.on("dragend",t._onMarkerDragEnd,t),t.options.preventMarkerRemoval||e.on("contextmenu",t._removeMarker,t)}))},_removeMarker:function(){return null},_onMarkerDragStart:function(t){if(this._vertexValidation("move",t)){var e=t.target,r=this._cornerMarkers;e._oppositeCornerLatLng=r.find((function(t){return t._index===(e._index+2)%4})).getLatLng(),e._snapped=!1,this._fireMarkerDragStart(t)}},_onMarkerDrag:function(t){var e=t.target;this._vertexValidationDrag(e)&&void 0!==e._index&&(this._adjustRectangleForMarkerMove(e),this._fireMarkerDrag(t))},_onMarkerDragEnd:function(t){var e=t.target;this._vertexValidationDragEnd(e)&&(this._cornerMarkers.forEach((function(t){delete t._oppositeCornerLatLng})),this._fireMarkerDragEnd(t),this._fireEdit(),this._layerEdited=!0)},_adjustRectangleForMarkerMove:function(t){L.extend(t._origLatLng,t._latlng);var e=L.PM.Utils._getRotatedRectangle(t.getLatLng(),t._oppositeCornerLatLng,this._angle||0,this._map);this._layer.setLatLngs(e),this._adjustAllMarkers(),this._layer.redraw()},_adjustAllMarkers:function(){var t=this,e=this._layer.getLatLngs()[0];e&&4!==e.length&&e.length>0?(e.forEach((function(e,r){t._cornerMarkers[r].setLatLng(e)})),this._cornerMarkers.slice(e.length).forEach((function(t){t.setLatLng(e[0])}))):e&&e.length?this._cornerMarkers.forEach((function(t){t.setLatLng(e[t._index])})):console.error("The layer has no LatLngs")},_findCorners:function(){this._layer.getBounds();var t=this._layer.getLatLngs()[0];return L.PM.Utils._getRotatedRectangle(t[0],t[2],this._angle||0,this._map)}}),Sr.Circle=Sr.extend({_shape:"Circle",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(t){var e=this;L.Util.setOptions(this,t),this._map=this._layer._map,this.options.allowEditing?(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",(function(t){e.disable(t.target)})),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable()},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;this._centerMarker.off("dragstart",this._onCircleDragStart,this),this._centerMarker.off("drag",this._onCircleDrag,this),this._centerMarker.off("dragend",this._onCircleDragEnd,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this),t.pm._enabled=!1,t.pm._helperLayers.clearLayers();var e=t._path?t._path:this._layer._renderer._container;return L.DomUtil.removeClass(e,"leaflet-pm-draggable"),this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable(),!0},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},_initMarkers:function(){var t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);var e=this._layer.getLatLng(),r=this._layer._radius,i=this._getLatLngOnCircle(e,r);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},applyOptions:function(){this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()},_createHintLine:function(t,e){var r=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([r,i],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"),e.on("drag",this._moveCircle,this),e.on("dragstart",this._onCircleDragStart,this),e.on("drag",this._onCircleDrag,this),e.on("dragend",this._onCircleDragEnd,this),e},_createOuterMarker:function(t){var e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){if(!t.target._cancelDragEventChain){var e=t.latlng;this._layer.setLatLng(e);var r=this._layer._radius,i=this._getLatLngOnCircle(e,r);this._outerMarker._latlng=i,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit")}},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=t.distanceTo(e);this.options.minRadiusCircle&&r<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(r),this._updateHiddenPolyCircle()},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_disableSnapping:function(){var t=this;this._markers.forEach((function(e){e.off("move",t._syncHintLine,t),e.off("move",t._syncCircleRadius,t),e.off("drag",t._handleSnapping,t),e.off("dragend",t._cleanupSnapping,t)})),this._layer.off("pm:dragstart",this._unsnap,this)},_onMarkerDragStart:function(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag:function(t){var e=t.target;this._vertexValidationDrag(e)&&this._fireMarkerDrag(t)},_onMarkerDragEnd:function(t){var e=t.target;this._vertexValidationDragEnd(e)&&(this._fireEdit(),this._layerEdited=!0,this._fireMarkerDragEnd(t))},_onCircleDragStart:function(t){this._vertexValidationDrag(t.target)?(delete this._vertexValidationReset,this._fireDragStart(t)):this._vertexValidationReset=!0},_onCircleDrag:function(t){this._vertexValidationReset||this._fireDrag(t)},_onCircleDragEnd:function(){this._vertexValidationReset?delete this._vertexValidationReset:this._fireDragEnd()},_updateHiddenPolyCircle:function(){this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(this._layer,200).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(this._layer,200),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_getLatLngOnCircle:function(t,e){var r=this._map.project(t),i=L.point(r.x+e,r.y);return this._map.unproject(i)},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=t.distanceTo(e);return this.options.minRadiusCircle&&r<this.options.minRadiusCircle?e=z(this._map,t,e,this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle&&(e=z(this._map,t,e,this.options.maxRadiusCircle)),e},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=t.distanceTo(e);(this.options.minRadiusCircle&&r<this.options.minRadiusCircle||this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),Sr.CircleMarker=Sr.extend({_shape:"CircleMarker",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()&&this.disable(),this.applyOptions(),this._enabled=!0,this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:drag",this._onMarkerDrag,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this),this._updateHiddenPolyCircle(),this._fireEnable()):this.disable())},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer;return!t.pm._dragging&&(t.pm._helperLayers&&t.pm._helperLayers.clearLayers(),this._map||(this._map=this._layer._map),this.options.editable?(this._map.off("move",this._syncMarkers,this),this._outerMarker&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this.enabled()&&(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),t.pm._enabled=!1,!0)},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){!this.options.editable&&this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.editable?(this._initMarkers(),this._map.on("move",this._syncMarkers,this)):this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this.options.editable?(this._initSnappableMarkers(),this._centerMarker.on("drag",this._moveCircle,this),this.options.editable&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._initSnappableMarkersDrag():this.options.editable?this._disableSnapping():this._disableSnappingDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers:function(){var t=this._map;this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new L.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t);var e=this._layer.getLatLng(),r=this._layer._radius,i=this._getLatLngOnCircle(e,r);this._centerMarker=this._createCenterMarker(e),this._outerMarker=this._createOuterMarker(i),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle:function(t,e){var r=this._map.project(t),i=L.point(r.x+e,r.y);return this._map.unproject(i)},_createHintLine:function(t,e){var r=t.getLatLng(),i=e.getLatLng();this._hintline=L.polyline([r,i],this.options.hintlineStyle),this._setPane(this._hintline,"layerPane"),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){var e=this._createMarker(t);return this.options.draggable?L.DomUtil.addClass(e._icon,"leaflet-pm-draggable"):e.dragging.disable(),e},_createOuterMarker:function(t){var e=this._createMarker(t);return e.on("drag",this._resizeCircle,this),e},_createMarker:function(t){var e=new L.Marker(t,{draggable:!0,icon:L.divIcon({className:"marker-icon"})});return this._setPane(e,"vertexPane"),e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_moveCircle:function(){var t=this._centerMarker.getLatLng();this._layer.setLatLng(t);var e=this._layer._radius,r=this._getLatLngOnCircle(t,e);this._outerMarker._latlng=r,this._outerMarker.update(),this._syncHintLine(),this._updateHiddenPolyCircle(),this._fireCenterPlaced("Edit")},_syncMarkers:function(){var t=this._layer.getLatLng(),e=this._layer._radius,r=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(r),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(r),this._updateHiddenPolyCircle()},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker:function(){this.options.editable&&this.disable(),this._layer.remove(),this._fireRemove(this._layer),this._fireRemove(this._map,this._layer)},_onDragStart:function(t){this._map.pm.Draw.CircleMarker._layerIsDragging=!0,this._vertexValidation("move",t)},_onMarkerDragStart:function(t){this._vertexValidation("move",t)&&this._fireMarkerDragStart(t)},_onMarkerDrag:function(t){var e=t.target;e instanceof L.Marker&&!this._vertexValidationDrag(e)||this._fireMarkerDrag(t)},_onMarkerDragEnd:function(t){this._map.pm.Draw.CircleMarker._layerIsDragging=!1;var e=t.target;this._vertexValidationDragEnd(e)&&(this.options.editable&&(this._fireEdit(),this._layerEdited=!0),this._fireMarkerDragEnd(t))},_initSnappableMarkersDrag:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,this.options.snapSegment=void 0===this.options.snapSegment||this.options.snapSegment,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle:function(){var t=this._layer._map||this._map;if(t){var e=t.project(this._layer.getLatLng()),r=L.point(e.x+this._layer.getRadius(),e.y),i=this._layer.getLatLng().distanceTo(t.unproject(r)),n=L.circle(this._layer.getLatLng(),this._layer.options);n.setRadius(i),this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(L.PM.Utils.circleToPolygon(n,200).getLatLngs()):this._hiddenPolyCircle=L.PM.Utils.circleToPolygon(n,200),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)}},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));return this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker?e=z(this._map,t,e,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker&&(e=z(this._map,t,e,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker))),e},_handleOuterMarkerSnapping:function(){if(this._outerMarker._snapped){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));(this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)}this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_pxRadiusToMeter:function(t){var e=this._centerMarker.getLatLng(),r=this._map.project(e),i=L.point(r.x+t,r.y);return this._map.unproject(i).distanceTo(e)}}),Sr.ImageOverlay=Sr.extend({_shape:"ImageOverlay",initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0};L.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.options.allowEditing?(this.enabled()||this.disable(),this.enableLayerDrag(),this._enabled=!0,this._otherSnapLayers=this._findCorners(),this._fireEnable()):this.disable())},disable:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._layer;return!t.pm._dragging&&(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this.enabled()||(this._layerEdited&&this._fireUpdate(),this._layerEdited=!1,this._fireDisable()),this._layer.off("contextmenu",this._removeMarker,this),t.pm._enabled=!1,!0)},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),r(153),r(154);var jr=function(t,e,r,i,n,a){this._matrix=[t,e,r,i,n,a]};jr.init=function(){return new L.PM.Matrix(1,0,0,1,0,0)},jr.prototype={transform:function(t){return this._transform(t.clone())},_transform:function(t){var e=this._matrix,r=t.x,i=t.y;return t.x=e[0]*r+e[1]*i+e[4],t.y=e[2]*r+e[3]*i+e[5],t},untransform:function(t){var e=this._matrix;return new L.Point((t.x/e[0]-e[4])/e[0],(t.y/e[2]-e[5])/e[2])},clone:function(){var t=this._matrix;return new L.PM.Matrix(t[0],t[1],t[2],t[3],t[4],t[5])},translate:function(t){return void 0===t?new L.Point(this._matrix[4],this._matrix[5]):("number"==typeof t?(e=t,r=t):(e=t.x,r=t.y),this._add(1,0,0,1,e,r));var e,r},scale:function(t,e){return void 0===t?new L.Point(this._matrix[0],this._matrix[3]):(e=e||L.point(0,0),"number"==typeof t?(r=t,i=t):(r=t.x,i=t.y),this._add(r,0,0,i,e.x,e.y)._add(1,0,0,1,-e.x,-e.y));var r,i},rotate:function(t,e){var r=Math.cos(t),i=Math.sin(t);return e=e||new L.Point(0,0),this._add(r,i,-i,r,e.x,e.y)._add(1,0,0,1,-e.x,-e.y)},flip:function(){return this._matrix[1]*=-1,this._matrix[2]*=-1,this},_add:function(t,e,r,i,n,a){var o,s=[[],[],[]],l=this._matrix,h=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]],u=[[t,r,n],[e,i,a],[0,0,1]];t&&t instanceof L.PM.Matrix&&(u=[[(l=t._matrix)[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]]);for(var c=0;c<3;c+=1)for(var p=0;p<3;p+=1){o=0;for(var f=0;f<3;f+=1)o+=h[c][f]*u[f][p];s[c][p]=o}return this._matrix=[s[0][0],s[1][0],s[0][1],s[1][1],s[0][2],s[1][2]],this}};var Ir=jr,Gr={calcMiddleLatLng:function(t,e,r){var i=t.project(e),n=t.project(r);return t.unproject(i._add(n)._divideBy(2))},findLayers:function(t){var e=[];return t.eachLayer((function(t){(t instanceof L.Polyline||t instanceof L.Marker||t instanceof L.Circle||t instanceof L.CircleMarker||t instanceof L.ImageOverlay)&&e.push(t)})),e=(e=(e=e.filter((function(t){return!!t.pm}))).filter((function(t){return!t._pmTempLayer}))).filter((function(t){return!L.PM.optIn&&!t.options.pmIgnore||L.PM.optIn&&!1===t.options.pmIgnore}))},circleToPolygon:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:60,r=t.getLatLng(),i=t.getRadius(),n=N(r,i,e,0),a=[],o=0;o<n.length;o+=1){var s=[n[o].lat,n[o].lng];a.push(s)}return L.polygon(a,t.options)},disablePopup:function(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup:function(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent:function(t,e,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];t.fire(e,r,i);var n=this.getAllParentGroups(t),a=n.groups;a.forEach((function(t){t.fire(e,r,i)}))},getAllParentGroups:function(t){var e=[],r=[];return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||(new Date).getTime()-t._pmLastGroupFetch.time>1e3?(function t(i){for(var n in i._eventParents)if(-1===e.indexOf(n)){e.push(n);var a=i._eventParents[n];r.push(a),t(a)}}(t),t._pmLastGroupFetch={time:(new Date).getTime(),groups:r,groupIds:e},{groupIds:e,groups:r}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:N,getTranslation:j,findDeepCoordIndex:function(t,e){var r;t.some(function t(i){return function(n,a){var o=i.concat(a);return n.lat&&n.lat===e.lat&&n.lng===e.lng?(r=o,!0):Array.isArray(n)&&n.some(t(o))}}([]));var i={};return r&&(i={indexPath:r,index:r[r.length-1],parentPath:r.slice(0,r.length-1)}),i},_getIndexFromSegment:function(t,e){if(e&&2===e.length){var r=this.findDeepCoordIndex(t,e[0]),i=this.findDeepCoordIndex(t,e[1]),n=Math.max(r.index,i.index);return 0!==r.index&&0!==i.index||1===n||(n+=1),{indexA:r,indexB:i,newIndex:n,indexPath:r.indexPath,parentPath:r.parentPath}}return null},_getRotatedRectangle:function(t,e,r,i){var n=Pr(i,t),a=Pr(i,e),o=r*Math.PI/180,s=Math.cos(o),l=Math.sin(o),h=(a.x-n.x)*s+(a.y-n.y)*l,u=(a.y-n.y)*s-(a.x-n.x)*l,c=h*s+n.x,p=h*l+n.y,f=-u*l+n.x,d=u*s+n.y;return[Cr(i,n),Cr(i,{x:c,y:p}),Cr(i,a),Cr(i,{x:f,y:d})]}};L.PM=L.PM||{version:i.version,Map:O,Toolbar:W,Draw:et,Edit:Sr,Utils:Gr,Matrix:Ir,activeLang:"en",optIn:!1,initialize:function(t){this.addInitHooks(t)},setOptIn:function(t){this.optIn=!!t},addInitHooks:function(){function t(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Map(this)):this.options.pmIgnore||(this.pm=new L.PM.Map(this))}function e(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.LayerGroup(this))}function r(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Marker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Marker(this))}function i(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.CircleMarker(this))}function n(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Line(this))}function a(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Polygon(this))}function o(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Rectangle(this))}function s(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.Circle(this))}function l(){this.pm=void 0,L.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new L.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new L.PM.Edit.ImageOverlay(this))}L.Map.addInitHook(t),L.LayerGroup.addInitHook(e),L.Marker.addInitHook(r),L.CircleMarker.addInitHook(i),L.Polyline.addInitHook(n),L.Polygon.addInitHook(a),L.Rectangle.addInitHook(o),L.Circle.addInitHook(s),L.ImageOverlay.addInitHook(l)},reInitLayer:function(t){var e=this;t instanceof L.LayerGroup&&t.eachLayer((function(t){e.reInitLayer(t)})),t.pm||L.PM.optIn&&!1!==t.options.pmIgnore||t.options.pmIgnore||(t instanceof L.Map?t.pm=new L.PM.Map(t):t instanceof L.Marker?t.pm=new L.PM.Edit.Marker(t):t instanceof L.Circle?t.pm=new L.PM.Edit.Circle(t):t instanceof L.CircleMarker?t.pm=new L.PM.Edit.CircleMarker(t):t instanceof L.Rectangle?t.pm=new L.PM.Edit.Rectangle(t):t instanceof L.Polygon?t.pm=new L.PM.Edit.Polygon(t):t instanceof L.Polyline?t.pm=new L.PM.Edit.Line(t):t instanceof L.LayerGroup?t.pm=new L.PM.Edit.LayerGroup(t):t instanceof L.ImageOverlay&&(t.pm=new L.PM.Edit.ImageOverlay(t)))}},L.PM.initialize()}])},a94e:function(t,e,r){},b922:function(t,e,r){"use strict";r("4160"),r("caad"),r("fb6a"),r("4ec9"),r("d3b7"),r("ac1f"),r("2532"),r("3ca3"),r("1276"),r("159b"),r("ddb0");var i=r("b85c"),n=r("d4ec"),a=r("bee2"),o=r("e11e"),s=r("0613"),l=r("a005"),h=r("a96b");function u(t){return t?t+"m":""}var c={set:function(t,e){t.bindTooltip(e,{permanent:!0,sticky:!0,className:"tooltip",interactive:!0})},route:function(t){var e=t.layer,r=t.item;this.set(e,h["a"].forge(r.grades)+", "+u(r.length))},pitch:function(t){var e=t.layer,r=t.item;this.set(e,h["a"].forge(r.grades)+", "+u(r.length))}},p=c,f=r("5d57"),d=r("f41f"),g=function(){function t(){Object(n["a"])(this,t),this._layerGroup=new o["FeatureGroup"],this._features=new Map,this._anchors=new Map,this._selected=[],this._tooltipsClosed=!1,this._lastLayerBounds=void 0,this._lastLayerSurfaceSize=1e3,this.registerHighlightWatch()}return Object(a["a"])(t,[{key:"registerHighlightWatch",value:function(){var t=this;s["a"].watch((function(){return d["a"].key}),(function(e){t.refreshStyle(e)}))}},{key:"registerTagsWatch",value:function(){var t=this;this._unwatchTags=s["a"].watch((function(t,e){return e.tags}),(function(e){s["a"].getters.loading||(t.setSelectedKeys(),t.addTagsToView(e))}),{immediate:!0})}},{key:"setSelectedKeys",value:function(){var t;this._selected=[];var e=null===(t=s["a"].state.url)||void 0===t?void 0:t.params;for(var r in e){var n=r.slice(0,-2),a=e[r],o=n+a;if(this._selected.push(o),n===f["b"].Route){var l=s["a"].getters[f["b"].Route+"/find"](a);if(l&&l.pitches){var h,u=Object(i["a"])(l.pitches);try{for(u.s();!(h=u.n()).done;){var c=h.value;this._selected.push(f["b"].Pitch+c)}}catch(p){u.e(p)}finally{u.f()}}}}}},{key:"isSelectedFeature",value:function(t){return this._selected.includes(t)}},{key:"refreshStyle",value:function(t){var e=this;this._features.forEach((function(r,i){t===i?e.setStyle("highlight",r):e.setDefaultStyle(i,r)}))}},{key:"removeLayers",value:function(){var t=this;this._features.forEach((function(e){t._layerGroup.removeLayer(e.layer)})),this._features.clear(),this._anchors.forEach((function(e){t._layerGroup.removeLayer(e)})),this._anchors.clear()}},{key:"hideTag",value:function(t){var e=this._features.get(t);e&&this._layerGroup.removeLayer(e.layer);var r=this._anchors.get(t);r&&this._layerGroup.removeLayer(r)}},{key:"showTag",value:function(t){var e=this._features.get(t.tagged_type+t.tagged_id);e&&this._layerGroup.addLayer(e.layer)}},{key:"hasTag",value:function(t){return this._features.has(t)}},{key:"getTag",value:function(t){var e;return null===(e=this._features.get(t))||void 0===e?void 0:e.tag}},{key:"addTagsToView",value:function(t){var e=this;this.removeLayers(),this._tooltipsClosed=!1,t.forEach((function(t){var r=t.tagged_type&&s["a"].getters[t.tagged_type+"/find"](t.tagged_id);if(r){var i=e.createLayer(t),n={layer:i,item:r,tag:t},a=t.tagged_type+t.tagged_id;e._features.set(a,n),e.registerListeners(a,n),"image"===e._mapType&&p[t.tagged_type]&&p[t.tagged_type](n),e._layerGroup.addLayer(i)}})),this.refreshStyle(),s["a"].getters.imageOpen?this.addAnchors():this.setMapViewpoint()}},{key:"addAnchors",value:function(){var t=this;this._features.forEach((function(e,r){if(e.tag.tagged_type===f["b"].Route||e.tag.tagged_type===f["b"].Pitch){var i=t.createAnchor(e.tag.geometry.coordinates);t._anchors.set(r,i),t._layerGroup.addLayer(i)}}))}},{key:"setMapViewpoint",value:function(){var t;if(0!==this._layerGroup.getLayers().length){var e=this._layerGroup.getBounds(),r=this.calculateSurface(e),i=18;1===this._features.size&&this._features.forEach((function(t){var e=t.item.path,r=10;i=e?r+2*e.split(".").length:r}));var n=Math.abs(this._lastLayerSurfaceSize-r)<1e-4,a=this._lastLayerBounds&&(this._lastLayerBounds.overlaps(e)||(null===(t=this._lastLayerBounds)||void 0===t?void 0:t.equals(e)));n&&a&&this.lastMapBounds?this._map.fitBounds(this.lastMapBounds):(this._lastLayerBounds=e,this._lastLayerSurfaceSize=r,this.lastMapBounds=void 0,this._map.fitBounds(this._lastLayerBounds,{padding:[100,100],maxZoom:i}))}}},{key:"calculateSurface",value:function(t){var e=t.getWest()-t.getEast(),r=t.getNorth()-t.getSouth();return Math.abs(e*r)}},{key:"setDefaultStyle",value:function(t,e){this.isSelectedFeature(t)?this.setStyle("selected",e):this.setStyle("default",e)}},{key:"setStyle",value:function(t,e){var r=e.tag.tagged_type;l["a"][this._mapType][r]&&l["a"][this._mapType][r][t]({layer:e.layer,item:e.item})}},{key:"createLayer",value:function(t){var e;switch(t.geometry.type){case"Point":e=this.createMarker(t.geometry.coordinates);break;case"LineString":e=this.createPolyline(t.geometry.coordinates);break}return e}},{key:"createAnchor",value:function(t){var e=t[0],r=t[t.length-1],i=r[1]>e[1]?r:e;return new o["CircleMarker"]([i[1],i[0]],{radius:5,stroke:!1,fillOpacity:1,fillColor:"white"})}},{key:"createMarker",value:function(t){return new o["Marker"]([t[1],t[0]])}},{key:"toggleAllTooltips",value:function(){var t;this._tooltipsClosed?(t="openTooltip",this._tooltipsClosed=!1):(t="closeTooltip",this._tooltipsClosed=!0),this._features.forEach((function(e){e.layer[t]()}))}},{key:"createPolyline",value:function(t){var e=[];return t.forEach((function(t){e.push([t[1],t[0]])})),new o["Polyline"](e)}},{key:"registerListeners",value:function(t,e){e.layer.on("mouseover",(function(e){d["a"].key=t,e.target.getTooltip()&&e.target.closeTooltip()})).on("mouseout",(function(t){d["a"].key=null,t.target.getTooltip()&&t.target.openTooltip()})).on("click",(function(t){void 0===t.target.getPopup()&&r.e("popup.service").then(r.bind(null,"3b97")).then((function(r){var i=r.default;i.createPopup(e,t.latlng)}))}))}},{key:"map",set:function(t){this.removeLayers(),this._map=t,null===this._map?this._unwatchTags&&this._unwatchTags():(s["a"].getters.imageOpen?(this._mapType="image",this.lastMapBounds=void 0):this._mapType="map",this._layerGroup.addTo(t),this.registerTagsWatch())},get:function(){return this._map}}]),t}(),m=new g;e["a"]=m},cb8b:function(t,e,r){"use strict";r.r(e);r("d81d"),r("b0c0"),r("d3b7"),r("96cf");var i=r("1da1"),n=r("d4ec"),a=r("bee2"),o=r("b922"),s=r("0613"),l=r("842b"),h=r("7a36"),u=r("e11e"),c=(r("a94e"),r("845a"),{map:{area:"Marker",route:"Marker",trail:"Line",image:"Marker"},image:{pitch:"Line",route:"Line"}}),p=function(){function t(){Object(n["a"])(this,t)}return Object(a["a"])(t,[{key:"setMapAndType",value:function(t){return this._map=o["a"].map,this._taggedType=t,s["a"].getters.imageOpen?this._drawingType=c.image[t]||c.map[t]:this._drawingType=c.map[t],this._map}},{key:"loadGeoman",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this._map.pm||u["PM"].reInitLayer(this._map);case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},{key:"createTag",value:function(t,e){var r=this;s["a"].dispatch("auth/authorize").then(Object(i["a"])(regeneratorRuntime.mark((function i(){return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(r.setMapAndType(t)){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,r.loadGeoman();case 4:s["a"].dispatch("snackbar/show","Adding tag for "+((null===e||void 0===e?void 0:e.name)||t)),s["a"].commit("setDrawingMode",!0),r._layer=null,r._item=e,r.registerListenerOnDraw(),r.enableDrawing();case 10:case"end":return i.stop()}}),i)})))).catch((function(t){console.log(t)}))}},{key:"editTag",value:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e,r){var n,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e+r.id,o["a"].hasTag(n)){t.next=4;break}return s["a"].dispatch("snackbar/show","Tag doesn't exist!"),t.abrupt("return");case 4:this._tag=o["a"].getTag(n),s["a"].dispatch("auth/authorize",this._tag).then(Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(o["a"].hideTag(n),a.setMapAndType(e)){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,a.loadGeoman();case 5:a._item=r,s["a"].dispatch("snackbar/show","Editing tag for "+(r.name||e)),s["a"].commit("setDrawingMode",!0),a.createDrawingLayer();case 9:case"end":return t.stop()}}),t)})))).catch((function(){a._tag=null}));case 6:case"end":return t.stop()}}),t,this)})));function e(e,r){return t.apply(this,arguments)}return e}()},{key:"setTagAtCurrentLocation",value:function(t,e){var r=this;s["a"].dispatch("snackbar/show","Tagging '"+e.name+"' at your current location<br/>Depending on your device/browser, this may take some time ...");var i,n=t+e.id;i=o["a"].hasTag(n)?o["a"].getTag(n):{tagged_type:t,tagged_id:e.id},s["a"].dispatch("auth/authorize",i.id?i:null).then((function(){var t=null,e=5,n=h["a"].registerCallback((function(a){var o=!t||t&&a.accuracy<t.accuracy;a.accuracy>10&&o&&s["a"].dispatch("snackbar/show","Low accuracy: "+Math.round(a.accuracy)+"m waiting for better accuracy."),o&&(t=a);var l=Math.round((null===t||void 0===t?void 0:t.accuracy)||1e3);0!==e&&l>10?e--:(h["a"].unregisterCallback(n),l>50?s["a"].dispatch("snackbar/error","Bad location accuracy:"+l+"m, not storing tag, please try again later."):(l>10&&s["a"].dispatch("snackbar/warning","Setting a location with low accuracy: "+l+"m."),t?(i.geometry={type:"Point",coordinates:[t.longitude,t.latitude]},i.accuracy=l):s["a"].dispatch("snackbar/error","No location provided."),r.storeTag(i)))}))}))}},{key:"createDrawingLayer",value:function(){this._layer=this._tag&&o["a"].createLayer(this._tag),this._layer.addTo(this._map),this._layer instanceof u["Marker"]?this._layer.dragging&&this._layer.dragging.enable():this._layer.pm.enable({snappable:!1,pinning:!1})}},{key:"registerListenerOnDraw",value:function(){var t=this;this._map.once("pm:create",(function(e){t._map.pm.disableDraw(t._drawingType),t._layer=e.layer,t._layer.pm.enable({snappable:!1,pinning:!1})})),this._map.once("pm:drawstart",(function(e){var r=e.workingLayer;r.on("pm:vertexadded",(function(e){t._layer=e.workingLayer}))}))}},{key:"enableDrawing",value:function(){this._map.pm.enableDraw(this._drawingType,{snappable:!1})}},{key:"createRequest",value:function(){var t,e;return{id:(null===(t=this._tag)||void 0===t?void 0:t.id)||null,image_id:s["a"].getters.imageOpen||null,geometry:this._layer.toGeoJSON().geometry,tagged_type:this._taggedType,tagged_id:(null===(e=this._item)||void 0===e?void 0:e.id)||null}}},{key:"storeTrailTag",value:function(t){var e=this;l["a"].post("trail",t).then((function(t){var e=t.data;s["a"].commit("trail/add",e),s["a"].commit("area/appendTrail",{id:e.area_id,trailId:e.id}),s["a"].dispatch("snackbar/success","Tag stored")})).catch((function(){e.discardLayer()})).finally((function(){e.afterDrawing()}))}},{key:"storeTag",value:function(t){var e=this;s["a"].dispatch("snackbar/show","Storing tag");var r=t||this.createRequest();if("trail"!==r.tagged_type||null!==r.id){var i=r.id?l["a"].put("tag/"+r.id,r):l["a"].post("tag",r);i.then((function(t){var e=t.data;s["a"].dispatch("snackbar/success","Tag stored"),e&&null==r.id&&(r.id=e),s["a"].getters.imageOpen?s["a"].commit("image/storeImageTag",r):s["a"].commit(r.tagged_type+"/storeMapTag",r)})).catch((function(){e.discardLayer()})).finally((function(){e.afterDrawing()}))}else this.storeTrailTag(r)}},{key:"afterDrawing",value:function(){this._layer&&this._layer.remove(),this._map&&this._map.pm.disableDraw(this._drawingType),s["a"].commit("setDrawingMode",!1),this._drawingType="",this._tag=null,this._layer=null,this._item=null,this._map=null}},{key:"discardLayer",value:function(){this._tag&&o["a"].showTag(this._tag),this.afterDrawing(),s["a"].commit("setDrawingMode",!1),s["a"].dispatch("snackbar/error","Changes discarded!")}}]),t}(),f=new p;e["default"]=f}}]);